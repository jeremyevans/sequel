<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Sequel::Database</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      function popupCode(url) {
        window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
      }
      
      function toggleCode(id) {
        var code = document.getElementById(id)
      
        code.style.display = code.style.display != 'block' ? 'block' : 'none'
        return true
      }
      
      // Make codeblocks hidden by default
      document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Sequel::Database
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/sequel/core_rb.html">lib/sequel/core.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database_rb.html">lib/sequel/database.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/connecting_rb.html">lib/sequel/database/connecting.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/dataset_rb.html">lib/sequel/database/dataset.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/dataset_defaults_rb.html">lib/sequel/database/dataset_defaults.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/features_rb.html">lib/sequel/database/features.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/logging_rb.html">lib/sequel/database/logging.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/misc_rb.html">lib/sequel/database/misc.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/query_rb.html">lib/sequel/database/query.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/schema_methods_rb.html">lib/sequel/database/schema_methods.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/database/transactions_rb.html">lib/sequel/database/transactions.rb</a>
          </li>
          <li>
            <a class='show' href='#' onclick='this.parentNode.parentNode.className += " expanded"; this.parentNode.removeChild(this); return false'>show all</a>
          </li>
        </ol>
        <div class='parent'>
          Superclass:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>A <a href="Database.html">Database</a> object represents a virtual
            connection to a database. The <a href="Database.html">Database</a> class is
            meant to be subclassed by database adapters in order to provide the
            functionality needed for executing queries.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a href="#method-c-adapter_class">adapter_class</a></li>
              <li><a href="#method-c-adapter_scheme">adapter_scheme</a></li>
              <li><a href="#method-c-after_initialize">after_initialize</a></li>
              <li><a href="#method-c-connect">connect</a></li>
              <li><a href="#method-c-extension">extension</a></li>
              <li><a href="#method-c-load_adapter">load_adapter</a></li>
              <li><a href="#method-c-new">new</a></li>
              <li><a href="#method-c-register_extension">register_extension</a></li>
              <li><a href="#method-c-run_after_initialize">run_after_initialize</a></li>
              <li><a href="#method-c-set_shared_adapter_scheme">set_shared_adapter_scheme</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a href="#method-i-3C-3C"><<</a></li>
              <li><a href="#method-i-5B-5D">[]</a></li>
              <li><a href="#method-i-adapter_scheme">adapter_scheme</a></li>
              <li><a href="#method-i-add_column">add_column</a></li>
              <li><a href="#method-i-add_index">add_index</a></li>
              <li><a href="#method-i-add_servers">add_servers</a></li>
              <li><a href="#method-i-after_commit">after_commit</a></li>
              <li><a href="#method-i-after_rollback">after_rollback</a></li>
              <li><a href="#method-i-alter_table">alter_table</a></li>
              <li><a href="#method-i-alter_table_generator">alter_table_generator</a></li>
              <li><a href="#attribute-i-cache_schema">cache_schema</a></li>
              <li><a href="#method-i-call">call</a></li>
              <li><a href="#method-i-cast_type_literal">cast_type_literal</a></li>
              <li><a href="#method-i-create_join_table">create_join_table</a></li>
              <li><a href="#method-i-create_join_table-21">create_join_table!</a></li>
              <li><a href="#method-i-create_join_table-3F">create_join_table?</a></li>
              <li><a href="#method-i-create_or_replace_view">create_or_replace_view</a></li>
              <li><a href="#method-i-create_table">create_table</a></li>
              <li><a href="#method-i-create_table-21">create_table!</a></li>
              <li><a href="#method-i-create_table-3F">create_table?</a></li>
              <li><a href="#method-i-create_table_generator">create_table_generator</a></li>
              <li><a href="#method-i-create_view">create_view</a></li>
              <li><a href="#method-i-database_type">database_type</a></li>
              <li><a href="#method-i-dataset">dataset</a></li>
              <li><a href="#attribute-i-dataset_class">dataset_class</a></li>
              <li><a href="#method-i-dataset_class-3D">dataset_class=</a></li>
              <li><a href="#attribute-i-default_string_column_size">default_string_column_size</a></li>
              <li><a href="#method-i-disconnect">disconnect</a></li>
              <li><a href="#method-i-disconnect_connection">disconnect_connection</a></li>
              <li><a href="#method-i-drop_column">drop_column</a></li>
              <li><a href="#method-i-drop_index">drop_index</a></li>
              <li><a href="#method-i-drop_join_table">drop_join_table</a></li>
              <li><a href="#method-i-drop_table">drop_table</a></li>
              <li><a href="#method-i-drop_table-3F">drop_table?</a></li>
              <li><a href="#method-i-drop_view">drop_view</a></li>
              <li><a href="#method-i-execute_ddl">execute_ddl</a></li>
              <li><a href="#method-i-execute_dui">execute_dui</a></li>
              <li><a href="#method-i-execute_insert">execute_insert</a></li>
              <li><a href="#method-i-extend_datasets">extend_datasets</a></li>
              <li><a href="#method-i-extension">extension</a></li>
              <li><a href="#method-i-fetch">fetch</a></li>
              <li><a href="#method-i-freeze">freeze</a></li>
              <li><a href="#method-i-from">from</a></li>
              <li><a href="#method-i-from_application_timestamp">from_application_timestamp</a></li>
              <li><a href="#method-i-get">get</a></li>
              <li><a href="#method-i-global_index_namespace-3F">global_index_namespace?</a></li>
              <li><a href="#method-i-in_transaction-3F">in_transaction?</a></li>
              <li><a href="#method-i-inspect">inspect</a></li>
              <li><a href="#method-i-literal">literal</a></li>
              <li><a href="#method-i-literal_symbol">literal_symbol</a></li>
              <li><a href="#method-i-literal_symbol_set">literal_symbol_set</a></li>
              <li><a href="#attribute-i-log_connection_info">log_connection_info</a></li>
              <li><a href="#method-i-log_connection_yield">log_connection_yield</a></li>
              <li><a href="#method-i-log_exception">log_exception</a></li>
              <li><a href="#method-i-log_info">log_info</a></li>
              <li><a href="#attribute-i-log_warn_duration">log_warn_duration</a></li>
              <li><a href="#method-i-logger-3D">logger=</a></li>
              <li><a href="#attribute-i-loggers">loggers</a></li>
              <li><a href="#attribute-i-opts">opts</a></li>
              <li><a href="#attribute-i-pool">pool</a></li>
              <li><a href="#method-i-prepared_statement">prepared_statement</a></li>
              <li><a href="#attribute-i-prepared_statements">prepared_statements</a></li>
              <li><a href="#method-i-quote_identifier">quote_identifier</a></li>
              <li><a href="#method-i-remove_servers">remove_servers</a></li>
              <li><a href="#method-i-rename_column">rename_column</a></li>
              <li><a href="#method-i-rename_table">rename_table</a></li>
              <li><a href="#method-i-rollback_checker">rollback_checker</a></li>
              <li><a href="#method-i-run">run</a></li>
              <li><a href="#method-i-schema">schema</a></li>
              <li><a href="#method-i-schema_type_class">schema_type_class</a></li>
              <li><a href="#method-i-select">select</a></li>
              <li><a href="#method-i-serial_primary_key_options">serial_primary_key_options</a></li>
              <li><a href="#method-i-servers">servers</a></li>
              <li><a href="#method-i-set_column_default">set_column_default</a></li>
              <li><a href="#method-i-set_column_type">set_column_type</a></li>
              <li><a href="#method-i-set_prepared_statement">set_prepared_statement</a></li>
              <li><a href="#method-i-sharded-3F">sharded?</a></li>
              <li><a href="#method-i-single_threaded-3F">single_threaded?</a></li>
              <li><a href="#attribute-i-sql_log_level">sql_log_level</a></li>
              <li><a href="#method-i-supports_create_table_if_not_exists-3F">supports_create_table_if_not_exists?</a></li>
              <li><a href="#method-i-supports_deferrable_constraints-3F">supports_deferrable_constraints?</a></li>
              <li><a href="#method-i-supports_deferrable_foreign_key_constraints-3F">supports_deferrable_foreign_key_constraints?</a></li>
              <li><a href="#method-i-supports_drop_table_if_exists-3F">supports_drop_table_if_exists?</a></li>
              <li><a href="#method-i-supports_foreign_key_parsing-3F">supports_foreign_key_parsing?</a></li>
              <li><a href="#method-i-supports_index_parsing-3F">supports_index_parsing?</a></li>
              <li><a href="#method-i-supports_partial_indexes-3F">supports_partial_indexes?</a></li>
              <li><a href="#method-i-supports_prepared_transactions-3F">supports_prepared_transactions?</a></li>
              <li><a href="#method-i-supports_savepoints-3F">supports_savepoints?</a></li>
              <li><a href="#method-i-supports_savepoints_in_prepared_transactions-3F">supports_savepoints_in_prepared_transactions?</a></li>
              <li><a href="#method-i-supports_schema_parsing-3F">supports_schema_parsing?</a></li>
              <li><a href="#method-i-supports_table_listing-3F">supports_table_listing?</a></li>
              <li><a href="#method-i-supports_transaction_isolation_levels-3F">supports_transaction_isolation_levels?</a></li>
              <li><a href="#method-i-supports_transactional_ddl-3F">supports_transactional_ddl?</a></li>
              <li><a href="#method-i-supports_view_listing-3F">supports_view_listing?</a></li>
              <li><a href="#method-i-supports_views_with_check_option-3F">supports_views_with_check_option?</a></li>
              <li><a href="#method-i-supports_views_with_local_check_option-3F">supports_views_with_local_check_option?</a></li>
              <li><a href="#method-i-synchronize">synchronize</a></li>
              <li><a href="#method-i-table_exists-3F">table_exists?</a></li>
              <li><a href="#method-i-test_connection">test_connection</a></li>
              <li><a href="#method-i-timezone">timezone</a></li>
              <li><a href="#attribute-i-timezone">timezone</a></li>
              <li><a href="#method-i-to_application_timestamp">to_application_timestamp</a></li>
              <li><a href="#method-i-transaction">transaction</a></li>
              <li><a href="#attribute-i-transaction_isolation_level">transaction_isolation_level</a></li>
              <li><a href="#method-i-typecast_value">typecast_value</a></li>
              <li><a href="#method-i-uri">uri</a></li>
              <li><a href="#method-i-url">url</a></li>
              <li><a href="#method-i-valid_connection-3F">valid_connection?</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='contents'>
              <h2>Contents</h2>
              <ol>
                <li><a href="#5Buntitled-5D"></a></li>
                <li><a href="#1+-+Methods+that+execute+queries+and-2For+return+results">1 - Methods that execute queries and/or return results</a></li>
                <li><a href="#2+-+Methods+that+modify+the+database+schema">2 - Methods that modify the database schema</a></li>
                <li><a href="#3+-+Methods+that+create+datasets">3 - Methods that create datasets</a></li>
                <li><a href="#4+-+Methods+relating+to+adapters-2C+connecting-2C+disconnecting-2C+and+sharding">4 - Methods relating to adapters, connecting, disconnecting, and sharding</a></li>
                <li><a href="#5+-+Methods+that+set+defaults+for+created+datasets">5 - Methods that set defaults for created datasets</a></li>
                <li><a href="#6+-+Methods+relating+to+logging">6 - Methods relating to logging</a></li>
                <li><a href="#7+-+Miscellaneous+methods">7 - Miscellaneous methods</a></li>
                <li><a href="#8+-+Methods+related+to+database+transactions">8 - Methods related to database transactions</a></li>
                <li><a href="#9+-+Methods+that+describe+what+the+database+supports">9 - Methods that describe what the database supports</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>OPTS</td>
                    <td>=</td>
                    <td class='context-item-value'>Sequel::OPTS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='1+-+Methods+that+execute+queries+and-2For+return+results'>1 - Methods that execute queries and/or return results</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COLUMN_SCHEMA_DATETIME_TYPES</td>
                    <td>=</td>
                    <td class='context-item-value'>[:date, :datetime].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COLUMN_SCHEMA_STRING_TYPES</td>
                    <td>=</td>
                    <td class='context-item-value'>[:string, :blob, :date, :datetime, :time, :enum, :set, :interval].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-cache_schema'>cache_schema</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>Whether the schema should be cached for this database.  True by default for
                      performance, can be set to false to always issue a database query to get
                      the schema.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-prepared_statements'>prepared_statements</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The prepared statement object hash for this database, keyed by name symbol</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-3C-3C'>
                <a name='method-i-3C-3C'></a>
                <div class='synopsis'>
                  <span class='name'><<</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='description'>
                  
                  <p>Runs the supplied <a href="SQL.html">SQL</a> statement string on the
                  database server. Returns self so it can be safely chained:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;UPDATE albums SET artist_id = NULL&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;DROP TABLE artists&quot;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-3C-3C-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-3C-3C-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 24</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-identifier">run</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-call'>
                <a name='method-i-call'></a>
                <div class='synopsis'>
                  <span class='name'>call</span>
                  <span class='arguments'>(ps_name, hash={}, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Call the prepared statement with the given name with the given hash of
                  arguments.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">prepare</span>(:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">sa</span>)&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">call</span>(:<span class="ruby-identifier">sa</span>) <span class="ruby-comment"># SELECT * FROM items WHERE id = 1</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-call-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-call-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 34</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">ps_name</span>, <span class="ruby-identifier">hash</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">prepared_statement</span>(<span class="ruby-identifier">ps_name</span>).<span class="ruby-identifier">call</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-execute_ddl'>
                <a name='method-i-execute_ddl'></a>
                <div class='synopsis'>
                  <span class='name'>execute_ddl</span>
                  <span class='arguments'>(sql, opts=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Method that should be used when submitting any DDL (Data Definition
                  Language) <a href="SQL.html">SQL</a>, such as <code>create_table</code>. 
                  By default, calls <code>execute_dui</code>. This method should not be
                  called directly by user code.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-execute_ddl-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-execute_ddl-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 41</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-execute_dui'>
                <a name='method-i-execute_dui'></a>
                <div class='synopsis'>
                  <span class='name'>execute_dui</span>
                  <span class='arguments'>(sql, opts=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Method that should be used when issuing a DELETE or UPDATE statement.  By
                  default, calls execute. This method should not be called directly by user
                  code.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-execute_dui-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-execute_dui-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 48</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-execute_insert'>
                <a name='method-i-execute_insert'></a>
                <div class='synopsis'>
                  <span class='name'>execute_insert</span>
                  <span class='arguments'>(sql, opts=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Method that should be used when issuing a INSERT statement.  By default,
                  calls execute_dui. This method should not be called directly by user code.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-execute_insert-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-execute_insert-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 55</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">execute_insert</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-get'>
                <a name='method-i-get'></a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a single value from the database, see <a
                  href="Dataset.html#method-i-get">Sequel::Dataset#get</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">get</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># SELECT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">get</span>{<span class="ruby-identifier">server_version</span>.<span class="ruby-identifier">function</span>} <span class="ruby-comment"># SELECT server_version()</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-get-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-get-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 64</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">get</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-run'>
                <a name='method-i-run'></a>
                <div class='synopsis'>
                  <span class='name'>run</span>
                  <span class='arguments'>(sql, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Runs the supplied <a href="SQL.html">SQL</a> statement string on the
                  database server. Returns nil. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:server </td><td>
                  <p>The server to run the <a href="SQL.html">SQL</a> on.</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">run</span>(<span class="ruby-string">&quot;SET some_server_variable = 42&quot;</span>)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-run-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-run-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 73</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">run</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">sql</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">sql</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">PlaceholderLiteralString</span>)&#x000A;  <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-schema'>
                <a name='method-i-schema'></a>
                <div class='synopsis'>
                  <span class='name'>schema</span>
                  <span class='arguments'>(table, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the schema for the given table as an array with all members being
                  arrays of length 2, the first member being the column name, and the second
                  member being a hash of column information. The table argument can also be a
                  dataset, as long as it only has one table. Available options are:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:reload </td><td>
                  <p>Ignore any cached results, and get fresh information from the database.</p>
                  </td></tr><tr><td class='label'>:schema </td><td>
                  <p>An explicit schema to use.  It may also be implicitly provided via the
                  table name.</p>
                  </td></tr></tbody></table>
                  
                  <p>If schema parsing is supported by the database, the column information hash
                  should contain at least the following entries:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:allow_null </td><td>
                  <p>Whether NULL is an allowed value for the column.</p>
                  </td></tr><tr><td class='label'>:db_type </td><td>
                  <p>The database type for the column, as a database specific string.</p>
                  </td></tr><tr><td class='label'>:default </td><td>
                  <p>The database default for the column, as a database specific string, or nil
                  if there is no default value.</p>
                  </td></tr><tr><td class='label'>:primary_key </td><td>
                  <p>Whether the columns is a primary key column.  If this column is not
                  present, it means that primary key information is unavailable, not that the
                  column is not a primary key.</p>
                  </td></tr><tr><td class='label'>:ruby_default </td><td>
                  <p>The database default for the column, as a ruby object.  In many cases,
                  complex database defaults cannot be parsed into ruby objects, in which case
                  nil will be used as the value.</p>
                  </td></tr><tr><td class='label'>:type </td><td>
                  <p>A symbol specifying the type, such as :integer or :string.</p>
                  </td></tr></tbody></table>
                  
                  <p>Example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">schema</span>(:<span class="ruby-identifier">artists</span>)&#x000A;<span class="ruby-comment"># [[:id,</span>&#x000A;<span class="ruby-comment">#   {:type=&gt;:integer,</span>&#x000A;<span class="ruby-comment">#    :primary_key=&gt;true,</span>&#x000A;<span class="ruby-comment">#    :default=&gt;&quot;nextval(&#39;artist_id_seq&#39;::regclass)&quot;,</span>&#x000A;<span class="ruby-comment">#    :ruby_default=&gt;nil,</span>&#x000A;<span class="ruby-comment">#    :db_type=&gt;&quot;integer&quot;,</span>&#x000A;<span class="ruby-comment">#    :allow_null=&gt;false}],</span>&#x000A;<span class="ruby-comment">#  [:name,</span>&#x000A;<span class="ruby-comment">#   {:type=&gt;:string,</span>&#x000A;<span class="ruby-comment">#    :primary_key=&gt;false,</span>&#x000A;<span class="ruby-comment">#    :default=&gt;nil,</span>&#x000A;<span class="ruby-comment">#    :ruby_default=&gt;nil,</span>&#x000A;<span class="ruby-comment">#    :db_type=&gt;&quot;text&quot;,</span>&#x000A;<span class="ruby-comment">#    :allow_null=&gt;false}]]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-schema-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-schema-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 120</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">schema</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;schema parsing is not implemented on this database&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_schema_parsing?</span>&#x000A;&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">dup</span>&#x000A;  <span class="ruby-identifier">tab</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)&#x000A;    <span class="ruby-identifier">o</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">opts</span>&#x000A;    <span class="ruby-identifier">from</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:from</span>]&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can only parse the schema for a dataset with a single from table&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">from</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">from</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:join</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:sql</span>)&#x000A;    <span class="ruby-identifier">table</span>.<span class="ruby-identifier">first_source_table</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">table</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">qualifiers</span> = <span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-identifier">tab</span>)&#x000A;  <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">pop</span>&#x000A;  <span class="ruby-identifier">sch</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">pop</span>&#x000A;  <span class="ruby-identifier">information_schema_schema</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">length</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">identifier</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">qualifiers</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">2</span>&#x000A;    <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">qualifiers</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)&#x000A;    <span class="ruby-identifier">quoted_name</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">tab</span>)&#x000A;    <span class="ruby-identifier">opts</span>[<span class="ruby-value">:dataset</span>] = <span class="ruby-identifier">table</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">quoted_name</span> = <span class="ruby-identifier">schema_utility_dataset</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:schema</span>] = <span class="ruby-identifier">sch</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">sch</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:schema</span>)&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:information_schema_schema</span>] = <span class="ruby-identifier">information_schema_schema</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">information_schema_schema</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:information_schema_schema</span>)&#x000A;&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@schemas</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">quoted_name</span>)} <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:reload</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@schemas</span>[<span class="ruby-identifier">quoted_name</span>]}&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">v</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">schema_parse_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;schema parsing returned no columns, table #{table_name.inspect} probably doesn&#39;t exist&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">empty?</span>&#x000A;&#x000A;  <span class="ruby-identifier">primary_keys</span> = <span class="ruby-value">0</span>&#x000A;  <span class="ruby-identifier">auto_increment_set</span> = <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">_</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">auto_increment_set</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:auto_increment</span>)&#x000A;    <span class="ruby-identifier">primary_keys</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>[<span class="ruby-value">:primary_key</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">_</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">c</span>[<span class="ruby-value">:ruby_default</span>] = <span class="ruby-identifier">column_schema_to_ruby_default</span>(<span class="ruby-identifier">c</span>[<span class="ruby-value">:default</span>], <span class="ruby-identifier">c</span>[<span class="ruby-value">:type</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:ruby_default</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>[<span class="ruby-value">:primary_key</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">auto_increment_set</span>&#x000A;      <span class="ruby-comment"># If adapter didn&#39;t set it, assume that integer primary keys are auto incrementing</span>&#x000A;      <span class="ruby-identifier">c</span>[<span class="ruby-value">:auto_increment</span>] = <span class="ruby-identifier">primary_keys</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">c</span>[<span class="ruby-value">:db_type</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/int/io</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">c</span>[<span class="ruby-value">:max_length</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span>[<span class="ruby-value">:type</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:string</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">max_length</span> = <span class="ruby-identifier">column_schema_max_length</span>(<span class="ruby-identifier">c</span>[<span class="ruby-value">:db_type</span>]))&#x000A;      <span class="ruby-identifier">c</span>[<span class="ruby-value">:max_length</span>] = <span class="ruby-identifier">max_length</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@schemas</span>[<span class="ruby-identifier">quoted_name</span>] = <span class="ruby-identifier">cols</span>} <span class="ruby-keyword">if</span> <span class="ruby-identifier">cache_schema</span>&#x000A;  <span class="ruby-identifier">cols</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-table_exists-3F'>
                <a name='method-i-table_exists-3F'></a>
                <div class='synopsis'>
                  <span class='name'>table_exists?</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if a table with the given name exists.  This requires a query
                  to the database.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">table_exists?</span>(:<span class="ruby-identifier">foo</span>) <span class="ruby-comment"># =&gt; false</span>&#x000A;<span class="ruby-comment"># SELECT NULL FROM foo LIMIT 1</span></pre>
                  
                  <p>Note that since this does a SELECT from the table, it can give false
                  negatives if you don&#39;t have permission to SELECT from the table.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-table_exists-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-table_exists-3F-source'><span class="ruby-comment"># File lib/sequel/database/query.rb, line 190</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">name</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">sch</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">from</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">transaction</span>(<span class="ruby-value">:savepoint=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:only</span>){<span class="ruby-identifier">_table_exists?</span>(<span class="ruby-identifier">ds</span>)}&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">rescue</span> <span class="ruby-constant">DatabaseError</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='2+-+Methods+that+modify+the+database+schema'>2 - Methods that modify the database schema</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COLUMN_DEFINITION_ORDER</td>
                    <td>=</td>
                    <td class='context-item-value'>[:collate, :default, :null, :unique, :primary_key, :auto_increment, :references].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The order of column modifiers to use when defining a column.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COMBINABLE_ALTER_TABLE_OPS</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      [:add_column, :drop_column, :rename_column,
                      :set_column_type, :set_column_default, :set_column_null,
                      :add_constraint, :drop_constraint].freeze
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The alter table operations that are combinable.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-add_column'>
                <a name='method-i-add_column'></a>
                <div class='synopsis'>
                  <span class='name'>add_column</span>
                  <span class='arguments'>(table, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds a column to the specified table. This method expects a column name, a
                  datatype and optionally a hash with additional constraints and options:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">add_column</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">name</span>, <span class="ruby-constant">String</span>, <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">add_column</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">category</span>, <span class="ruby-constant">String</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;ruby&#39;</span></pre>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-add_column-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-add_column-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 24</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">table</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>) {<span class="ruby-identifier">add_column</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-add_index'>
                <a name='method-i-add_index'></a>
                <div class='synopsis'>
                  <span class='name'>add_index</span>
                  <span class='arguments'>(table, columns, options=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds an index to a table for the given columns:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">add_index</span> :<span class="ruby-identifier">posts</span>, :<span class="ruby-identifier">title</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">add_index</span> :<span class="ruby-identifier">posts</span>, [:<span class="ruby-identifier">author</span>, :<span class="ruby-identifier">title</span>], <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span></pre>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:ignore_errors </td><td>
                  <p>Ignore any DatabaseErrors that are raised</p>
                  </td></tr><tr><td class='label'>:name </td><td>
                  <p>Name to use for index instead of default</p>
                  </td></tr></tbody></table>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-add_index-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-add_index-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 39</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">e</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:ignore_errors</span>]&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>){<span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>)}&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">DatabaseError</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">e</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-alter_table'>
                <a name='method-i-alter_table'></a>
                <div class='synopsis'>
                  <span class='name'>alter_table</span>
                  <span class='arguments'>(name, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alters the given table with the specified block. Example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">alter_table</span> :<span class="ruby-identifier">items</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">add_column</span> :<span class="ruby-identifier">category</span>, <span class="ruby-constant">String</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;ruby&#39;</span>&#x000A;  <span class="ruby-identifier">drop_column</span> :<span class="ruby-identifier">category</span>&#x000A;  <span class="ruby-identifier">rename_column</span> :<span class="ruby-identifier">cntr</span>, :<span class="ruby-identifier">counter</span>&#x000A;  <span class="ruby-identifier">set_column_type</span> :<span class="ruby-identifier">value</span>, <span class="ruby-constant">Float</span>&#x000A;  <span class="ruby-identifier">set_column_default</span> :<span class="ruby-identifier">value</span>, <span class="ruby-value">4.2</span>&#x000A;  <span class="ruby-identifier">add_index</span> [:<span class="ruby-identifier">group</span>, :<span class="ruby-identifier">category</span>]&#x000A;  <span class="ruby-identifier">drop_index</span> [:<span class="ruby-identifier">group</span>, :<span class="ruby-identifier">category</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Note that <code>add_column</code> accepts all the options available for
                  column definitions using <code>create_table</code>, and
                  <code>add_index</code> accepts all the options available for index
                  definition.</p>
                  
                  <p>See <code>Schema::AlterTableGenerator</code> and the <a
                  href="../../files/doc/migration_rdoc.html">Migrations and Schema
                  Modification guide</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-alter_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-alter_table-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 66</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">generator</span> = <span class="ruby-identifier">alter_table_generator</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">remove_cached_schema</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">apply_alter_table_generator</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">generator</span>)&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-alter_table_generator'>
                <a name='method-i-alter_table_generator'></a>
                <div class='synopsis'>
                  <span class='name'>alter_table_generator</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a new <a
                  href="Schema/AlterTableGenerator.html">Schema::AlterTableGenerator</a>
                  instance with the receiver as the database and the given block.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-alter_table_generator-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-alter_table_generator-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 75</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">alter_table_generator</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">alter_table_generator_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_join_table'>
                <a name='method-i-create_join_table'></a>
                <div class='synopsis'>
                  <span class='name'>create_join_table</span>
                  <span class='arguments'>(hash, options=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Create a join table using a hash of foreign keys to referenced table names.
                  Example:</p>
                  
                  <pre>create_join_table:cat_id: :cats, dog_id: :dogs)&#x000A;# CREATE TABLE cats_dogs (&#x000A;#  cat_id integer NOT NULL REFERENCES cats,&#x000A;#  dog_id integer NOT NULL REFERENCES dogs,&#x000A;#  PRIMARY KEY (cat_id, dog_id)&#x000A;# )&#x000A;# CREATE INDEX cats_dogs_dog_id_cat_id_index ON cats_dogs(dog_id, cat_id)</pre>
                  
                  <p>The primary key and index are used so that almost all operations on the
                  table can benefit from one of the two indexes, and the primary key ensures
                  that entries in the table are unique, which is the typical desire for a
                  join table.</p>
                  
                  <p>You can provide column options by making the values in the hash be option
                  hashes, so long as the option hashes have a :table entry giving the table
                  referenced:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">create_join_table</span>(<span class="ruby-identifier">cat_id</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">table</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">cats</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> :<span class="ruby-constant">Bignum</span>}, <span class="ruby-identifier">dog_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">dogs</span>)</pre>
                  
                  <p>You can provide a second argument which is a table options hash:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">create_join_table</span>({<span class="ruby-identifier">cat_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">cats</span>, <span class="ruby-identifier">dog_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">dogs</span>}, <span class="ruby-identifier">temp</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)</pre>
                  
                  <p>Some table options are handled specially:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:index_options </td><td>
                  <p>The options to pass to the index</p>
                  </td></tr><tr><td class='label'>:name </td><td>
                  <p>The name of the table to create</p>
                  </td></tr><tr><td class='label'>:no_index </td><td>
                  <p>Set to true not to create the second index.</p>
                  </td></tr><tr><td class='label'>:no_primary_key </td><td>
                  <p>Set to true to not create the primary key.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_join_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_join_table-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 111</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_join_table</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>&#x000A;  <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">join_table_name</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>), <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">v</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>]&#x000A;      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;        <span class="ruby-identifier">v</span> = {<span class="ruby-value">:table=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">v</span>}&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">v</span>[<span class="ruby-value">:null</span>] = <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:null</span>)&#x000A;      <span class="ruby-identifier">foreign_key</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">v</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">primary_key</span>(<span class="ruby-identifier">keys</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:no_primary_key</span>]&#x000A;    <span class="ruby-identifier">index</span>(<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">reverse</span>, <span class="ruby-identifier">options</span>[<span class="ruby-value">:index_options</span>] <span class="ruby-operator">||</span> {}) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:no_index</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_join_table-21'>
                <a name='method-i-create_join_table-21'></a>
                <div class='synopsis'>
                  <span class='name'>create_join_table!</span>
                  <span class='arguments'>(hash, options=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Forcibly create a join table, attempting to drop it if it already exists,
                  then creating it.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_join_table-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_join_table-21-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 129</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_join_table!</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">drop_table?</span>(<span class="ruby-identifier">join_table_name</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>))&#x000A;  <span class="ruby-identifier">create_join_table</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_join_table-3F'>
                <a name='method-i-create_join_table-3F'></a>
                <div class='synopsis'>
                  <span class='name'>create_join_table?</span>
                  <span class='arguments'>(hash, options=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Creates the join table unless it already exists.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_join_table-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_join_table-3F-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 135</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_join_table?</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_create_table_if_not_exists?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:no_index</span>]&#x000A;    <span class="ruby-identifier">create_join_table</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:if_not_exists=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>))&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">join_table_name</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>))&#x000A;    <span class="ruby-identifier">create_join_table</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_or_replace_view'>
                <a name='method-i-create_or_replace_view'></a>
                <div class='synopsis'>
                  <span class='name'>create_or_replace_view</span>
                  <span class='arguments'>(name, source, options = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Creates a view, replacing a view with the same name if one already exists.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_or_replace_view</span>(:<span class="ruby-identifier">some_items</span>, <span class="ruby-string">&quot;SELECT * FROM items WHERE price &lt; 100&quot;</span>)&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_or_replace_view</span>(:<span class="ruby-identifier">some_items</span>, <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;ruby&#39;</span>))</pre>
                  
                  <p>For databases where replacing a view is not natively supported, support is
                  emulated by dropping a view with the same name before creating the view.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_or_replace_view-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_or_replace_view-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 230</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_or_replace_view</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_create_or_replace_view?</span>&#x000A;    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:replace=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">drop_view</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">create_view</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_table'>
                <a name='method-i-create_table'></a>
                <div class='synopsis'>
                  <span class='name'>create_table</span>
                  <span class='arguments'>(name, options=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Creates a table with the columns given in the provided block:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">posts</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">primary_key</span> :<span class="ruby-identifier">id</span>&#x000A;  <span class="ruby-identifier">column</span> :<span class="ruby-identifier">title</span>, <span class="ruby-constant">String</span>&#x000A;  <span class="ruby-constant">String</span> :<span class="ruby-identifier">content</span>&#x000A;  <span class="ruby-identifier">index</span> :<span class="ruby-identifier">title</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>General options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:as </td><td>
                  <p>Create the table using the value, which should be either a dataset or a
                  literal <a href="SQL.html">SQL</a> string.  If this option is used, a block
                  should not be given to the method.</p>
                  </td></tr><tr><td class='label'>:ignore_index_errors </td><td>
                  <p>Ignore any errors when creating indexes.</p>
                  </td></tr><tr><td class='label'>:temp </td><td>
                  <p>Create the table as a temporary table.</p>
                  </td></tr></tbody></table>
                  
                  <p>MySQL specific options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:charset </td><td>
                  <p>The character set to use for the table.</p>
                  </td></tr><tr><td class='label'>:collate </td><td>
                  <p>The collation to use for the table.</p>
                  </td></tr><tr><td class='label'>:engine </td><td>
                  <p>The table engine to use for the table.</p>
                  </td></tr></tbody></table>
                  
                  <p>PostgreSQL specific options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:on_commit </td><td>
                  <p>Either :preserve_rows (default), :drop or :delete_rows. Should only be
                  specified when creating a temporary table.</p>
                  </td></tr><tr><td class='label'>:foreign </td><td>
                  <p>Create a foreign table.  The value should be the name of the foreign server
                  that was specified in CREATE SERVER.</p>
                  </td></tr><tr><td class='label'>:inherits </td><td>
                  <p>Inherit from a different table.  An array can be specified to inherit from
                  multiple tables.</p>
                  </td></tr><tr><td class='label'>:unlogged </td><td>
                  <p>Create the table as an unlogged table.</p>
                  </td></tr><tr><td class='label'>:options </td><td>
                  <p>The OPTIONS clause to use for foreign tables.  Should be a hash where keys
                  are option names and values are option values.  Note that option names are
                  unquoted, so you should not use untrusted keys.</p>
                  </td></tr></tbody></table>
                  
                  <p>See <code>Schema::CreateTableGenerator</code> and the <a
                  href="../../files/doc/schema_modification_rdoc.html">Schema Modification
                  guide</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_table-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 178</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">remove_cached_schema</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:as</span>]&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can&#39;t provide both :as option and block to create_table&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-identifier">create_table_as</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">sql</span>, <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">generator</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:generator</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">create_table_generator</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-identifier">create_table_from_generator</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">generator</span>, <span class="ruby-identifier">options</span>)&#x000A;    <span class="ruby-identifier">create_table_indexes_from_generator</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">generator</span>, <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_table-21'>
                <a name='method-i-create_table-21'></a>
                <div class='synopsis'>
                  <span class='name'>create_table!</span>
                  <span class='arguments'>(name, options=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Forcibly create a table, attempting to drop it if it already exists, then
                  creating it.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_table!</span>(:<span class="ruby-identifier">a</span>){<span class="ruby-constant">Integer</span> :<span class="ruby-identifier">a</span>} &#x000A;<span class="ruby-comment"># SELECT NULL FROM a LIMIT 1 -- check existence</span>&#x000A;<span class="ruby-comment"># DROP TABLE a -- drop table if already exists</span>&#x000A;<span class="ruby-comment"># CREATE TABLE a (a integer)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_table-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_table-21-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 197</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_table!</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">drop_table?</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_table-3F'>
                <a name='method-i-create_table-3F'></a>
                <div class='synopsis'>
                  <span class='name'>create_table?</span>
                  <span class='arguments'>(name, options=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Creates the table unless the table already exists.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_table?</span>(:<span class="ruby-identifier">a</span>){<span class="ruby-constant">Integer</span> :<span class="ruby-identifier">a</span>} &#x000A;<span class="ruby-comment"># SELECT NULL FROM a LIMIT 1 -- check existence</span>&#x000A;<span class="ruby-comment"># CREATE TABLE a (a integer) -- if it doesn&#39;t already exist</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_table-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_table-3F-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 207</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_table?</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>&#x000A;  <span class="ruby-identifier">generator</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:generator</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">create_table_generator</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">generator</span>.<span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">supports_create_table_if_not_exists?</span>&#x000A;    <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:if_not_exists=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>))&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_table_generator'>
                <a name='method-i-create_table_generator'></a>
                <div class='synopsis'>
                  <span class='name'>create_table_generator</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a new <a
                  href="Schema/CreateTableGenerator.html">Schema::CreateTableGenerator</a>
                  instance with the receiver as the database and the given block.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_table_generator-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_table_generator-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 219</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_table_generator</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">create_table_generator_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-create_view'>
                <a name='method-i-create_view'></a>
                <div class='synopsis'>
                  <span class='name'>create_view</span>
                  <span class='arguments'>(name, source, options = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Creates a view based on a dataset or an <a href="SQL.html">SQL</a> string:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_view</span>(:<span class="ruby-identifier">cheap_items</span>, <span class="ruby-string">&quot;SELECT * FROM items WHERE price &lt; 100&quot;</span>)&#x000A;<span class="ruby-comment"># CREATE VIEW cheap_items AS</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE price &lt; 100</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_view</span>(:<span class="ruby-identifier">ruby_items</span>, <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;ruby&#39;</span>))&#x000A;<span class="ruby-comment"># CREATE VIEW ruby_items AS</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (category = &#39;ruby&#39;)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">create_view</span>(:<span class="ruby-identifier">checked_items</span>, <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">foo</span>), <span class="ruby-identifier">check</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-comment"># CREATE VIEW checked_items AS</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE foo</span>&#x000A;<span class="ruby-comment"># WITH CHECK OPTION</span></pre>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:columns </td><td>
                  <p>The column names to use for the view.  If not given, automatically
                  determined based on the input dataset.</p>
                  </td></tr><tr><td class='label'>:check </td><td>
                  <p>Adds a WITH CHECK OPTION clause, so that attempting to modify  rows in the
                  underlying table that would not be returned by the view is not allowed. 
                  This can be set to :local to use WITH LOCAL CHECK OPTION.</p>
                  </td></tr></tbody></table>
                  
                  <p>PostgreSQL/SQLite specific option:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:temp </td><td>
                  <p>Create a temporary view, automatically dropped on disconnect.</p>
                  </td></tr></tbody></table>
                  
                  <p>PostgreSQL specific options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:materialized </td><td>
                  <p>Creates a materialized view, similar to a regular view, but backed by a
                  physical table.</p>
                  </td></tr><tr><td class='label'>:recursive </td><td>
                  <p>Creates a recursive view.  As columns must be specified for recursive
                  views, you can also set them as the value of this option.  Since a
                  recursive view requires a union that isn&#39;t in a subquery, if you are
                  providing a <a href="Dataset.html">Dataset</a> as the source argument, if
                  should probably call the union method with the all: true and from_self:
                  false options.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-create_view-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-create_view-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 276</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_view</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">create_view_sql</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">options</span>))&#x000A;  <span class="ruby-identifier">remove_cached_schema</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-drop_column'>
                <a name='method-i-drop_column'></a>
                <div class='synopsis'>
                  <span class='name'>drop_column</span>
                  <span class='arguments'>(table, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Removes a column from the specified table:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_column</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">category</span></pre>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-drop_column-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-drop_column-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 287</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_column</span>(<span class="ruby-identifier">table</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>) {<span class="ruby-identifier">drop_column</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-drop_index'>
                <a name='method-i-drop_index'></a>
                <div class='synopsis'>
                  <span class='name'>drop_index</span>
                  <span class='arguments'>(table, columns, options=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Removes an index for the given table and column(s):</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_index</span> :<span class="ruby-identifier">posts</span>, :<span class="ruby-identifier">title</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_index</span> :<span class="ruby-identifier">posts</span>, [:<span class="ruby-identifier">author</span>, :<span class="ruby-identifier">title</span>]</pre>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-drop_index-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-drop_index-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 297</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_index</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>){<span class="ruby-identifier">drop_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-drop_join_table'>
                <a name='method-i-drop_join_table'></a>
                <div class='synopsis'>
                  <span class='name'>drop_join_table</span>
                  <span class='arguments'>(hash, options=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Drop the join table that would have been created with the same arguments to
                  <a href="Database.html#method-i-create_join_table">#create_join_table</a>:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">drop_join_table</span>(<span class="ruby-identifier">cat_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">cats</span>, <span class="ruby-identifier">dog_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">dogs</span>)&#x000A;<span class="ruby-comment"># DROP TABLE cats_dogs</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-drop_join_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-drop_join_table-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 306</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_join_table</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">join_table_name</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">options</span>), <span class="ruby-identifier">options</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-drop_table'>
                <a name='method-i-drop_table'></a>
                <div class='synopsis'>
                  <span class='name'>drop_table</span>
                  <span class='arguments'>(*names)</span>
                </div>
                <div class='description'>
                  
                  <p>Drops one or more tables corresponding to the given names:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_table</span>(:<span class="ruby-identifier">posts</span>) <span class="ruby-comment"># DROP TABLE posts</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_table</span>(:<span class="ruby-identifier">posts</span>, :<span class="ruby-identifier">comments</span>)&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_table</span>(:<span class="ruby-identifier">posts</span>, :<span class="ruby-identifier">comments</span>, <span class="ruby-identifier">cascade</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-drop_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-drop_table-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 315</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_table</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)&#x000A;  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">names</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}&#x000A;  <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">drop_table_sql</span>(<span class="ruby-identifier">n</span>, <span class="ruby-identifier">options</span>))&#x000A;    <span class="ruby-identifier">remove_cached_schema</span>(<span class="ruby-identifier">n</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-drop_table-3F'>
                <a name='method-i-drop_table-3F'></a>
                <div class='synopsis'>
                  <span class='name'>drop_table?</span>
                  <span class='arguments'>(*names)</span>
                </div>
                <div class='description'>
                  
                  <p>Drops the table if it already exists.  If it doesn&#39;t exist, does
                  nothing.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_table?</span>(:<span class="ruby-identifier">a</span>)&#x000A;<span class="ruby-comment"># SELECT NULL FROM a LIMIT 1 -- check existence</span>&#x000A;<span class="ruby-comment"># DROP TABLE a -- if it already exists</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-drop_table-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-drop_table-3F-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 330</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_table?</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)&#x000A;  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">names</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_drop_table_if_exists?</span>&#x000A;    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:if_exists=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;    <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-drop_view'>
                <a name='method-i-drop_view'></a>
                <div class='synopsis'>
                  <span class='name'>drop_view</span>
                  <span class='arguments'>(*names)</span>
                </div>
                <div class='description'>
                  
                  <p>Drops one or more views corresponding to the given names:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_view</span>(:<span class="ruby-identifier">cheap_items</span>)&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_view</span>(:<span class="ruby-identifier">cheap_items</span>, :<span class="ruby-identifier">pricey_items</span>)&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_view</span>(:<span class="ruby-identifier">cheap_items</span>, :<span class="ruby-identifier">pricey_items</span>, <span class="ruby-identifier">cascade</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">drop_view</span>(:<span class="ruby-identifier">cheap_items</span>, :<span class="ruby-identifier">pricey_items</span>, <span class="ruby-identifier">if_exists</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)</pre>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:cascade </td><td>
                  <p>Also drop objects depending on this view.</p>
                  </td></tr><tr><td class='label'>:if_exists </td><td>
                  <p>Do not raise an error if the view does not exist.</p>
                  </td></tr></tbody></table>
                  
                  <p>PostgreSQL specific options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:materialized </td><td>
                  <p>Drop a materialized view.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-drop_view-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-drop_view-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 358</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_view</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)&#x000A;  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">names</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}&#x000A;  <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">drop_view_sql</span>(<span class="ruby-identifier">n</span>, <span class="ruby-identifier">options</span>))&#x000A;    <span class="ruby-identifier">remove_cached_schema</span>(<span class="ruby-identifier">n</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-rename_column'>
                <a name='method-i-rename_column'></a>
                <div class='synopsis'>
                  <span class='name'>rename_column</span>
                  <span class='arguments'>(table, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Renames a column in the specified table. This method expects the current
                  column name and the new column name:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">rename_column</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">cntr</span>, :<span class="ruby-identifier">counter</span></pre>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-rename_column-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-rename_column-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 384</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_column</span>(<span class="ruby-identifier">table</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>) {<span class="ruby-identifier">rename_column</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-rename_table'>
                <a name='method-i-rename_table'></a>
                <div class='synopsis'>
                  <span class='name'>rename_table</span>
                  <span class='arguments'>(name, new_name)</span>
                </div>
                <div class='description'>
                  
                  <p>Renames a table:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">tables</span> <span class="ruby-comment">#=&gt; [:items]</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">rename_table</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">old_items</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">tables</span> <span class="ruby-comment">#=&gt; [:old_items]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-rename_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-rename_table-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 372</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">new_name</span>)&#x000A;  <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">rename_table_sql</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">new_name</span>))&#x000A;  <span class="ruby-identifier">remove_cached_schema</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-set_column_default'>
                <a name='method-i-set_column_default'></a>
                <div class='synopsis'>
                  <span class='name'>set_column_default</span>
                  <span class='arguments'>(table, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Sets the default value for the given column in the given table:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">set_column_default</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">category</span>, <span class="ruby-string">&#39;perl!&#39;</span></pre>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-set_column_default-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-set_column_default-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 393</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_column_default</span>(<span class="ruby-identifier">table</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>) {<span class="ruby-identifier">set_column_default</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-set_column_type'>
                <a name='method-i-set_column_type'></a>
                <div class='synopsis'>
                  <span class='name'>set_column_type</span>
                  <span class='arguments'>(table, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Set the data type for the given column in the given table:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">set_column_type</span> :<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">price</span>, :<span class="ruby-identifier">float</span></pre>
                  
                  <p>See <code>alter_table</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-set_column_type-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-set_column_type-source'><span class="ruby-comment"># File lib/sequel/database/schema_methods.rb, line 402</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_column_type</span>(<span class="ruby-identifier">table</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table</span>) {<span class="ruby-identifier">set_column_type</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='3+-+Methods+that+create+datasets'>3 - Methods that create datasets</a>
            </h2>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-5B-5D'>
                <a name='method-i-5B-5D'></a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a dataset for the database. If the first argument is a string, the
                  method acts as an alias for <a
                  href="Database.html#method-i-fetch">#fetch</a>, returning a dataset for
                  arbitrary <a href="SQL.html">SQL</a>, with or without placeholders:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[<span class="ruby-string">&#39;SELECT * FROM items&#39;</span>].<span class="ruby-identifier">all</span>&#x000A;<span class="ruby-constant">DB</span>[<span class="ruby-string">&#39;SELECT * FROM items WHERE name = ?&#39;</span>, <span class="ruby-identifier">my_name</span>].<span class="ruby-identifier">all</span></pre>
                  
                  <p>Otherwise, acts as an alias for <a
                  href="Database.html#method-i-from">#from</a>, setting the primary table for
                  the dataset:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">sql</span> <span class="ruby-comment">#=&gt; &quot;SELECT * FROM items&quot;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-5B-5D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-5B-5D-source'><span class="ruby-comment"># File lib/sequel/database/dataset.rb, line 20</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">fetch</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-dataset'>
                <a name='method-i-dataset'></a>
                <div class='synopsis'>
                  <span class='name'>dataset</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a blank dataset for this database.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">dataset</span> <span class="ruby-comment"># SELECT *</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">from</span>(:<span class="ruby-identifier">items</span>) <span class="ruby-comment"># SELECT * FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-dataset-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-dataset-source'><span class="ruby-comment"># File lib/sequel/database/dataset.rb, line 28</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">dataset</span>&#x000A;  <span class="ruby-ivar">@dataset_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-fetch'>
                <a name='method-i-fetch'></a>
                <div class='synopsis'>
                  <span class='name'>fetch</span>
                  <span class='arguments'>(sql, *args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Fetches records for an arbitrary <a href="SQL.html">SQL</a> statement. If a
                  block is given, it is used to iterate over the records:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;SELECT * FROM items&#39;</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">r</span>}</pre>
                  
                  <p>The <code>fetch</code> method returns a dataset instance:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;SELECT * FROM items&#39;</span>).<span class="ruby-identifier">all</span></pre>
                  
                  <p><code>fetch</code> can also perform parameterized queries for protection
                  against <a href="SQL.html">SQL</a> injection:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;SELECT * FROM items WHERE name = ?&#39;</span>, <span class="ruby-identifier">my_name</span>).<span class="ruby-identifier">all</span></pre>
                  
                  <p>See caveats listed in <a
                  href="Dataset.html#method-i-with_sql">Sequel::Dataset#with_sql</a>
                  regarding datasets using custom <a href="SQL.html">SQL</a> and the methods
                  that can be called on them.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-fetch-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-fetch-source'><span class="ruby-comment"># File lib/sequel/database/dataset.rb, line 48</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">with_sql</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">ds</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-from'>
                <a name='method-i-from'></a>
                <div class='synopsis'>
                  <span class='name'>from</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a new dataset with the <code>from</code> method invoked. If a block
                  is given, it acts as a virtual row block</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">from</span>(:<span class="ruby-identifier">items</span>) <span class="ruby-comment"># SELECT * FROM items</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">from</span>{<span class="ruby-identifier">schema</span>[:<span class="ruby-identifier">table</span>]} <span class="ruby-comment"># SELECT * FROM schema.table</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-from-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-from-source'><span class="ruby-comment"># File lib/sequel/database/dataset.rb, line 59</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">table</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]).<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)&#x000A;    <span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:cached_dataset</span>, <span class="ruby-value">:&quot;_from_#{table}_ds&quot;</span>){<span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">table</span>)}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select'>
                <a name='method-i-select'></a>
                <div class='synopsis'>
                  <span class='name'>select</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a new dataset with the select method invoked.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">select</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># SELECT 1</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">select</span>{<span class="ruby-identifier">server_version</span>.<span class="ruby-identifier">function</span>} <span class="ruby-comment"># SELECT server_version()</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">from</span>(:<span class="ruby-identifier">items</span>) <span class="ruby-comment"># SELECT id FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select-source'><span class="ruby-comment"># File lib/sequel/database/dataset.rb, line 74</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-ivar">@default_dataset</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='4+-+Methods+relating+to+adapters-2C+connecting-2C+disconnecting-2C+and+sharding'>4 - Methods relating to adapters, connecting, disconnecting, and sharding</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>ADAPTERS</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'ado amalgalite ibmdb jdbc mock mysql mysql2 odbc oracle postgres sqlanywhere sqlite tinytds'.map(&:to_sym)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Array of supported database adapters</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-pool'>pool</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The connection pool for this <a href="Database.html">Database</a> instance.
                      All <a href="Database.html">Database</a> instances have their own
                      connection pools.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-adapter_class'>
                <a name='method-c-adapter_class'></a>
                <div class='synopsis'>
                  <span class='name'>adapter_class</span>
                  <span class='arguments'>(scheme)</span>
                </div>
                <div class='description'>
                  
                  <p>The <a href="Database.html">Database</a> subclass for the given adapter
                  scheme. Raises Sequel::AdapterNotFound if the adapter could not be loaded.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-adapter_class-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-adapter_class-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 15</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">adapter_class</span>(<span class="ruby-identifier">scheme</span>)&#x000A;  <span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Class</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">scheme</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">load_adapter</span>(<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">to_sym</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-adapter_scheme'>
                <a name='method-c-adapter_scheme'></a>
                <div class='synopsis'>
                  <span class='name'>adapter_scheme</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the scheme symbol for the <a href="Database.html">Database</a>
                  class.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-adapter_scheme-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-adapter_scheme-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 20</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">adapter_scheme</span>&#x000A;  <span class="ruby-ivar">@scheme</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-connect'>
                <a name='method-c-connect'></a>
                <div class='synopsis'>
                  <span class='name'>connect</span>
                  <span class='arguments'>(conn_string, opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Connects to a database.  See <a
                  href="../Sequel.html#method-c-connect">Sequel.connect</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-connect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-connect-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 25</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-identifier">conn_string</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">conn_string</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">conn_string</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;jdbc:&#39;</span>)&#x000A;      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">adapter_class</span>(<span class="ruby-value">:jdbc</span>)&#x000A;      <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:orig_opts=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">dup</span>)&#x000A;      <span class="ruby-identifier">opts</span> = {<span class="ruby-value">:uri=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">conn_string</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">conn_string</span>)&#x000A;      <span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>&#x000A;      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">adapter_class</span>(<span class="ruby-identifier">scheme</span>)&#x000A;      <span class="ruby-identifier">uri_options</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:uri_to_options</span>, <span class="ruby-identifier">uri</span>)&#x000A;      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;&amp;&#39;</span>).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;=&#39;</span>)}.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">uri_options</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">v</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">k</span>.<span class="ruby-identifier">empty?</span>} <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-identifier">uri_options</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">uri_options</span>[<span class="ruby-identifier">k</span>] = (<span class="ruby-keyword">defined?</span>(<span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_PARSER</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_PARSER</span> <span class="ruby-operator">:</span> <span class="ruby-constant">URI</span>).<span class="ruby-identifier">unescape</span>(<span class="ruby-identifier">v</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)}&#x000A;      <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">uri_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>).<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:orig_opts=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">dup</span>, <span class="ruby-value">:uri=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">conn_string</span>, <span class="ruby-value">:adapter=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">scheme</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>&#x000A;    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">conn_string</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:orig_opts=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">dup</span>)&#x000A;    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">adapter_class</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:adapter_class</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:adapter</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-string">&#39;adapter&#39;</span>])&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Sequel::Database.connect takes either a Hash or a String, given: #{conn_string.inspect}&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, (<span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span>)<span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">k</span> = <span class="ruby-value">:user</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;username&#39;</span>&#x000A;    <span class="ruby-identifier">m</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">v</span>&#x000A;    <span class="ruby-identifier">m</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-identifier">db</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>)&#x000A;    <span class="ruby-identifier">db</span>.<span class="ruby-identifier">test_connection</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:typecast_value_boolean</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:test</span>, <span class="ruby-keyword">true</span>))&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">db</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">ensure</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">disconnect</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>&#x000A;      <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">DATABASES</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">db</span>)}&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">db</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-load_adapter'>
                <a name='method-c-load_adapter'></a>
                <div class='synopsis'>
                  <span class='name'>load_adapter</span>
                  <span class='arguments'>(scheme, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Load the adapter from the file system.  Raises Sequel::AdapterNotFound if
                  the adapter cannot be loaded, or if the adapter isn&#39;t registered
                  correctly after being loaded. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:map </td><td>
                  <p>The Hash in which to look for an already loaded adapter (defaults to
                  ADAPTER_MAP).</p>
                  </td></tr><tr><td class='label'>:subdir </td><td>
                  <p>The subdirectory of sequel/adapters to look in, only to be used for loading
                  subadapters.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-load_adapter-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-load_adapter-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 76</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">load_adapter</span>(<span class="ruby-identifier">scheme</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">map</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:map</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ADAPTER_MAP</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">subdir</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:subdir</span>]&#x000A;    <span class="ruby-identifier">file</span> = <span class="ruby-node">&quot;#{subdir}/#{scheme}&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">file</span> = <span class="ruby-identifier">scheme</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  &#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">obj</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">map</span>[<span class="ruby-identifier">scheme</span>]}&#x000A;    <span class="ruby-comment"># attempt to load the adapter file</span>&#x000A;    <span class="ruby-keyword">begin</span>&#x000A;      <span class="ruby-identifier">require</span> <span class="ruby-node">&quot;sequel/adapters/#{file}&quot;</span>&#x000A;    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>&#x000A;      <span class="ruby-comment"># If subadapter file doesn&#39;t exist, just return, </span>&#x000A;      <span class="ruby-comment"># using the main adapter class without database customizations.</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">subdir</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">convert_exception_class</span>(<span class="ruby-identifier">e</span>, <span class="ruby-constant">AdapterNotFound</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    &#x000A;    <span class="ruby-comment"># make sure we actually loaded the adapter</span>&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">obj</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">map</span>[<span class="ruby-identifier">scheme</span>]}&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">AdapterNotFound</span>, <span class="ruby-node">&quot;Could not load #{file} adapter: adapter class not registered in ADAPTER_MAP&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">obj</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-set_shared_adapter_scheme'>
                <a name='method-c-set_shared_adapter_scheme'></a>
                <div class='synopsis'>
                  <span class='name'>set_shared_adapter_scheme</span>
                  <span class='arguments'>(scheme, mod)</span>
                </div>
                <div class='description'>
                  
                  <p>Sets the given module as the shared adapter module for the given scheme.
                  Used to register shared adapters for use by the mock adapter. Example:</p>
                  
                  <pre class="ruby"><span class="ruby-comment"># in file sequel/adapters/shared/mydb.rb</span>&#x000A;<span class="ruby-keyword">module</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">MyDB</span>&#x000A;  <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">set_shared_adapter_scheme</span> :<span class="ruby-identifier">mydb</span>, <span class="ruby-keyword">self</span>&#x000A;&#x000A;  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">mock_adapter_setup</span>(<span class="ruby-identifier">db</span>)&#x000A;    <span class="ruby-comment"># ...</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">module</span> <span class="ruby-constant">DatabaseMethods</span>&#x000A;    <span class="ruby-comment"># ...</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">module</span> <span class="ruby-constant">DatasetMethods</span>&#x000A;    <span class="ruby-comment"># ...</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>would allow the mock adapter to return a <a
                  href="Database.html">Database</a> instance that supports the MyDB syntax
                  via:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;mock://mydb&#39;</span>)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-set_shared_adapter_scheme-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-set_shared_adapter_scheme-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 146</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">set_shared_adapter_scheme</span>(<span class="ruby-identifier">scheme</span>, <span class="ruby-identifier">mod</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">SHARED_ADAPTER_MAP</span>[<span class="ruby-identifier">scheme</span>] = <span class="ruby-identifier">mod</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-adapter_scheme'>
                <a name='method-i-adapter_scheme'></a>
                <div class='synopsis'>
                  <span class='name'>adapter_scheme</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the scheme symbol for this instance&#39;s class, which reflects
                  which adapter is being used.  In some cases, this can be the same as the
                  <code>database_type</code> (for native adapters), in others (i.e. adapters
                  with subadapters), it will be different.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;jdbc:postgres://...&#39;</span>).<span class="ruby-identifier">adapter_scheme</span>&#x000A;<span class="ruby-comment"># =&gt; :jdbc</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-adapter_scheme-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-adapter_scheme-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 161</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">adapter_scheme</span>&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">adapter_scheme</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-add_servers'>
                <a name='method-i-add_servers'></a>
                <div class='synopsis'>
                  <span class='name'>add_servers</span>
                  <span class='arguments'>(servers)</span>
                </div>
                <div class='description'>
                  
                  <p>Dynamically add new servers or modify server options at runtime. Also adds
                  new servers to the connection pool. Only usable when using a sharded
                  connection pool.</p>
                  
                  <p>servers argument should be a hash with server name symbol keys and hash or
                  proc values.  If a servers key is already in use, it&#39;s value is
                  overridden with the value provided.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">add_servers</span>(<span class="ruby-identifier">f</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">host</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;hash_host_f&quot;</span>})</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-add_servers-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-add_servers-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 173</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_servers</span>(<span class="ruby-identifier">servers</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sharded?</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;cannot call Database#add_servers on a Database instance that does not use a sharded connection pool&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:servers</span>]&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">h</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">servers</span>)}&#x000A;  <span class="ruby-ivar">@pool</span>.<span class="ruby-identifier">add_servers</span>(<span class="ruby-identifier">servers</span>.<span class="ruby-identifier">keys</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-database_type'>
                <a name='method-i-database_type'></a>
                <div class='synopsis'>
                  <span class='name'>database_type</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The database type for this database object, the same as the adapter scheme
                  by default.  Should be overridden in adapters (especially shared adapters)
                  to be the correct type, so that even if two separate <a
                  href="Database.html">Database</a> objects are using different adapters you
                  can tell that they are using the same database type.  Even better, you can
                  tell that two <a href="Database.html">Database</a> objects that are using
                  the same adapter are connecting to different database types.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;jdbc:postgres://...&#39;</span>).<span class="ruby-identifier">database_type</span>&#x000A;<span class="ruby-comment"># =&gt; :postgres</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-database_type-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-database_type-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 192</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">database_type</span>&#x000A;  <span class="ruby-identifier">adapter_scheme</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-disconnect'>
                <a name='method-i-disconnect'></a>
                <div class='synopsis'>
                  <span class='name'>disconnect</span>
                  <span class='arguments'>(opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Disconnects all available connections from the connection pool.  Any
                  connections currently in use will not be disconnected. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:server </td><td>
                  <p>Should be a symbol specifing the server to disconnect from,</p>
                  
                  <pre>or an array of symbols to specify multiple servers.</pre>
                  </td></tr></tbody></table>
                  
                  <p>Example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">disconnect</span> <span class="ruby-comment"># All servers</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">disconnect</span>(<span class="ruby-identifier">server</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">server1</span>) <span class="ruby-comment"># Single server</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">disconnect</span>(<span class="ruby-identifier">server</span><span class="ruby-operator">:</span> [:<span class="ruby-identifier">server1</span>, :<span class="ruby-identifier">server2</span>]) <span class="ruby-comment"># Multiple servers</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-disconnect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-disconnect-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 206</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">disconnect</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">pool</span>.<span class="ruby-identifier">disconnect</span>(<span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-disconnect_connection'>
                <a name='method-i-disconnect_connection'></a>
                <div class='synopsis'>
                  <span class='name'>disconnect_connection</span>
                  <span class='arguments'>(conn)</span>
                </div>
                <div class='description'>
                  
                  <p>Should only be called by the connection pool code to disconnect a
                  connection. By default, calls the close method on the connection object,
                  since most adapters use that, but should be overwritten on other adapters.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-disconnect_connection-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-disconnect_connection-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 213</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">disconnect_connection</span>(<span class="ruby-identifier">conn</span>)&#x000A;  <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">close</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-remove_servers'>
                <a name='method-i-remove_servers'></a>
                <div class='synopsis'>
                  <span class='name'>remove_servers</span>
                  <span class='arguments'>(*servers)</span>
                </div>
                <div class='description'>
                  
                  <p>Dynamically remove existing servers from the connection pool. Only usable
                  when using a sharded connection pool</p>
                  
                  <p>servers should be symbols or arrays of symbols.  If a nonexistent server is
                  specified, it is ignored.  If no servers have been specified for this
                  database, no changes are made. If you attempt to remove the :default
                  server, an error will be raised.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">remove_servers</span>(:<span class="ruby-identifier">f1</span>, :<span class="ruby-identifier">f2</span>)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-remove_servers-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-remove_servers-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 226</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_servers</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">servers</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sharded?</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;cannot call Database#remove_servers on a Database instance that does not use a sharded connection pool&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:servers</span>]&#x000A;  <span class="ruby-identifier">servers</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">h</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">s</span>)}}&#x000A;  <span class="ruby-ivar">@pool</span>.<span class="ruby-identifier">remove_servers</span>(<span class="ruby-identifier">servers</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-servers'>
                <a name='method-i-servers'></a>
                <div class='synopsis'>
                  <span class='name'>servers</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>An array of servers/shards for this <a href="Database.html">Database</a>
                  object.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">servers</span> <span class="ruby-comment"># Unsharded: =&gt; [:default]</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">servers</span> <span class="ruby-comment"># Sharded:   =&gt; [:default, :server1, :server2]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-servers-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-servers-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 240</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">servers</span>&#x000A;  <span class="ruby-identifier">pool</span>.<span class="ruby-identifier">servers</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-single_threaded-3F'>
                <a name='method-i-single_threaded-3F'></a>
                <div class='synopsis'>
                  <span class='name'>single_threaded?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if the database is using a single-threaded connection pool.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-single_threaded-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-single_threaded-3F-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 245</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">single_threaded?</span>&#x000A;  <span class="ruby-ivar">@single_threaded</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-synchronize'>
                <a name='method-i-synchronize'></a>
                <div class='synopsis'>
                  <span class='name'>synchronize</span>
                  <span class='arguments'>(server=nil)</span>
                </div>
                <div class='description'>
                  
                  <p>Acquires a database connection, yielding it to the passed block. This is
                  useful if you want to make sure the same connection is used for all
                  database queries in the block.  It is also useful if you want to gain
                  direct access to the underlying connection object if you need to do
                  something <a href="../Sequel.html">Sequel</a> does not natively support.</p>
                  
                  <p>If a server option is given, acquires a connection for that specific
                  server, instead of the :default server.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-comment"># ...</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-synchronize-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-synchronize-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 262</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">server</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-ivar">@pool</span>.<span class="ruby-identifier">hold</span>(<span class="ruby-identifier">server</span> <span class="ruby-operator">||</span> <span class="ruby-value">:default</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">conn</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-test_connection'>
                <a name='method-i-test_connection'></a>
                <div class='synopsis'>
                  <span class='name'>test_connection</span>
                  <span class='arguments'>(server=nil)</span>
                </div>
                <div class='description'>
                  
                  <p>Attempts to acquire a database connection.  Returns true if successful.
                  Will probably raise an <a href="Error.html">Error</a> if unsuccessful.  If
                  a server argument is given, attempts to acquire a database connection to
                  the given server/shard.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-test_connection-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-test_connection-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 277</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">test_connection</span>(<span class="ruby-identifier">server</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">server</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>}&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-valid_connection-3F'>
                <a name='method-i-valid_connection-3F'></a>
                <div class='synopsis'>
                  <span class='name'>valid_connection?</span>
                  <span class='arguments'>(conn)</span>
                </div>
                <div class='description'>
                  
                  <p>Check whether the given connection is currently valid, by running a query
                  against it.  If the query fails, the connection should probably be removed
                  from the connection pool.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-valid_connection-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-valid_connection-3F-source'><span class="ruby-comment"># File lib/sequel/database/connecting.rb, line 286</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">valid_connection?</span>(<span class="ruby-identifier">conn</span>)&#x000A;  <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">valid_connection_sql</span>&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-identifier">log_connection_execute</span>(<span class="ruby-identifier">conn</span>, <span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">DatabaseError</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">database_error_classes</span>&#x000A;    <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='5+-+Methods+that+set+defaults+for+created+datasets'>5 - Methods that set defaults for created datasets</a>
            </h2>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-dataset_class'>dataset_class</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The class to use for creating datasets.  Should respond to new with the <a
                      href="Database.html">Database</a> argument as the first argument, and an
                      optional options hash.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-dataset_class-3D'>
                <a name='method-i-dataset_class-3D'></a>
                <div class='synopsis'>
                  <span class='name'>dataset_class=</span>
                  <span class='arguments'>(c)</span>
                </div>
                <div class='description'>
                  
                  <p>If the database has any dataset modules associated with it, use a subclass
                  of the given class that includes the modules as the dataset class.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-dataset_class-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-dataset_class-3D-source'><span class="ruby-comment"># File lib/sequel/database/dataset_defaults.rb, line 17</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">dataset_class=</span>(<span class="ruby-identifier">c</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@dataset_modules</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">c</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">c</span>)&#x000A;    <span class="ruby-ivar">@dataset_modules</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:include</span>, <span class="ruby-identifier">m</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-ivar">@dataset_class</span> = <span class="ruby-identifier">c</span>&#x000A;  <span class="ruby-identifier">reset_default_dataset</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-extend_datasets'>
                <a name='method-i-extend_datasets'></a>
                <div class='synopsis'>
                  <span class='name'>extend_datasets</span>
                  <span class='arguments'>(mod=nil, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Equivalent to extending all datasets produced by the database with a
                  module.  What it actually does is use a subclass of the current <a
                  href="Database.html#attribute-i-dataset_class">#dataset_class</a> as the
                  new <a href="Database.html#attribute-i-dataset_class">#dataset_class</a>,
                  and include the module in the subclass. Instead of a module, you can
                  provide a block that is used to create an anonymous module.</p>
                  
                  <p>This allows you to override any of the dataset methods even if they are
                  defined directly on the dataset class that this <a
                  href="Database.html">Database</a> object uses.</p>
                  
                  <p>If a block is given, a <a
                  href="Dataset/DatasetModule.html">Dataset::DatasetModule</a> instance is
                  created, allowing for the easy creation of named dataset methods that will
                  do caching.</p>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-comment"># Introspect columns for all of DB&#39;s datasets</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">extend_datasets</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnsIntrospection</span>)&#x000A;&#x000A;<span class="ruby-comment"># Trace all SELECT queries by printing the SQL and the full backtrace</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">extend_datasets</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>)&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">sql</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">caller</span>&#x000A;    <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-comment"># Add some named dataset methods</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">extend_datasets</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">order</span> :<span class="ruby-identifier">by_id</span>, :<span class="ruby-identifier">id</span>&#x000A;  <span class="ruby-identifier">select</span> :<span class="ruby-identifier">with_id_and_name</span>, :<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>&#x000A;  <span class="ruby-identifier">where</span> :<span class="ruby-identifier">active</span>, :<span class="ruby-identifier">active</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">active</span>.<span class="ruby-identifier">with_id_and_name</span>.<span class="ruby-identifier">by_id</span>&#x000A;<span class="ruby-comment"># SELECT id, name FROM table WHERE active ORDER BY id</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-extend_datasets-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-extend_datasets-source'><span class="ruby-comment"># File lib/sequel/database/dataset_defaults.rb, line 61</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">extend_datasets</span>(<span class="ruby-identifier">mod</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;must provide either mod or block, not both&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">mod</span> = <span class="ruby-constant">Dataset</span><span class="ruby-operator">::</span><span class="ruby-constant">DatasetModule</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dataset_modules</span>.<span class="ruby-identifier">empty?</span>&#x000A;   <span class="ruby-ivar">@dataset_modules</span> = [<span class="ruby-identifier">mod</span>]&#x000A;   <span class="ruby-ivar">@dataset_class</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@dataset_class</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;   <span class="ruby-ivar">@dataset_modules</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mod</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-ivar">@dataset_class</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:include</span>, <span class="ruby-identifier">mod</span>)&#x000A;  <span class="ruby-identifier">reset_default_dataset</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='6+-+Methods+relating+to+logging'>6 - Methods relating to logging</a>
            </h2>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-log_connection_info'>log_connection_info</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>Whether to include information about the connection in use when logging
                      queries.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-log_warn_duration'>log_warn_duration</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>Numeric specifying the duration beyond which queries are logged at warn
                      level instead of info level.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-loggers'>loggers</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>Array of <a href="SQL.html">SQL</a> loggers to use for this database.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-sql_log_level'>sql_log_level</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>Log level at which to log <a href="SQL.html">SQL</a> queries.  This is
                      actually the method sent to the logger, so it should be the method name
                      symbol. The default is :info, it can be set to :debug to log at DEBUG
                      level.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-log_connection_yield'>
                <a name='method-i-log_connection_yield'></a>
                <div class='synopsis'>
                  <span class='name'>log_connection_yield</span>
                  <span class='arguments'>(sql, conn, args=nil)</span>
                </div>
                <div class='description'>
                  
                  <p>Yield to the block, logging any errors at error level to all loggers, and
                  all other queries with the duration at warn or info level.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-log_connection_yield-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-log_connection_yield-source'><span class="ruby-comment"># File lib/sequel/database/logging.rb, line 36</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">log_connection_yield</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">conn</span>, <span class="ruby-identifier">args</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">yield</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@loggers</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;#{connection_info(conn) if conn &amp;&amp; log_connection_info}#{sql}#{&quot;; #{args.inspect}&quot; if args}&quot;</span>&#x000A;  <span class="ruby-identifier">start</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-keyword">yield</span>&#x000A;  <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>&#x000A;    <span class="ruby-identifier">log_exception</span>(<span class="ruby-identifier">e</span>, <span class="ruby-identifier">sql</span>)&#x000A;    <span class="ruby-identifier">raise</span>&#x000A;  <span class="ruby-keyword">ensure</span>&#x000A;    <span class="ruby-identifier">log_duration</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start</span>, <span class="ruby-identifier">sql</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">e</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-log_exception'>
                <a name='method-i-log_exception'></a>
                <div class='synopsis'>
                  <span class='name'>log_exception</span>
                  <span class='arguments'>(exception, message)</span>
                </div>
                <div class='description'>
                  
                  <p>Log a message at error level, with information about the exception.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-log_exception-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-log_exception-source'><span class="ruby-comment"># File lib/sequel/database/logging.rb, line 25</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">log_exception</span>(<span class="ruby-identifier">exception</span>, <span class="ruby-identifier">message</span>)&#x000A;  <span class="ruby-identifier">log_each</span>(<span class="ruby-value">:error</span>, <span class="ruby-node">&quot;#{exception.class}: #{exception.message.strip if exception.message}: #{message}&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-log_info'>
                <a name='method-i-log_info'></a>
                <div class='synopsis'>
                  <span class='name'>log_info</span>
                  <span class='arguments'>(message, args=nil)</span>
                </div>
                <div class='description'>
                  
                  <p>Log a message at level info to all loggers.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-log_info-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-log_info-source'><span class="ruby-comment"># File lib/sequel/database/logging.rb, line 30</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">log_info</span>(<span class="ruby-identifier">message</span>, <span class="ruby-identifier">args</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-identifier">log_each</span>(<span class="ruby-value">:info</span>, <span class="ruby-identifier">args</span> <span class="ruby-operator">?</span> <span class="ruby-node">&quot;#{message}; #{args.inspect}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">message</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-logger-3D'>
                <a name='method-i-logger-3D'></a>
                <div class='synopsis'>
                  <span class='name'>logger=</span>
                  <span class='arguments'>(logger)</span>
                </div>
                <div class='description'>
                  
                  <p>Remove any existing loggers and just use the given logger:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$stdout</span>)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-logger-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-logger-3D-source'><span class="ruby-comment"># File lib/sequel/database/logging.rb, line 53</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">logger=</span>(<span class="ruby-identifier">logger</span>)&#x000A;  <span class="ruby-ivar">@loggers</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">logger</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='7+-+Miscellaneous+methods'>7 - Miscellaneous methods</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>CHECK_CONSTRAINT_SQLSTATES</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'23513 23514'.freeze.each(&:freeze)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>DEFAULT_DATABASE_ERROR_REGEXPS</td>
                    <td>=</td>
                    <td class='context-item-value'>{}.freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Empty exception regexp to class map, used by default if <a
                      href="../Sequel.html">Sequel</a> doesn&#39;t have specific support for the
                      database in use.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>DEFAULT_STRING_COLUMN_SIZE</td>
                    <td>=</td>
                    <td class='context-item-value'>255</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The general default size for string columns for all <a
                      href="Database.html">Sequel::Database</a> instances.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>EXTENSIONS</td>
                    <td>=</td>
                    <td class='context-item-value'>{}</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Hash of extension name symbols to callable objects to load the extension
                      into the <a href="Database.html">Database</a> object (usually by extending
                      it with a module defined in the extension).</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>FOREIGN_KEY_CONSTRAINT_SQLSTATES</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'23503 23506 23504'.freeze.each(&:freeze)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>NOT_NULL_CONSTRAINT_SQLSTATES</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'23502'.freeze.each(&:freeze)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SCHEMA_TYPE_CLASSES</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      {:string=>String, :integer=>Integer, :date=>Date, :datetime=>[Time, DateTime].freeze,
                      :time=>Sequel::SQLTime, :boolean=>[TrueClass, FalseClass].freeze, :float=>Float, :decimal=>BigDecimal,
                      :blob=>Sequel::SQL::Blob}.freeze
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Mapping of schema type symbols to class or arrays of classes for that
                      symbol.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SERIALIZATION_CONSTRAINT_SQLSTATES</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'40001'.freeze.each(&:freeze)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>UNIQUE_CONSTRAINT_SQLSTATES</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'23505'.freeze.each(&:freeze)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-default_string_column_size'>default_string_column_size</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>The specific default size of string columns for this <a
                      href="Database.html">Sequel::Database</a>, usually 255 by default.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-opts'>opts</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The options hash for this database</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-timezone'>timezone</a>
                    </td>
                    <td class='context-item-value'>[W]</td>
                    <td class='context-item-desc'>
                      
                      <p>Set the timezone to use for this database, overridding
                      <code>Sequel.database_timezone</code>.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-after_initialize'>
                <a name='method-c-after_initialize'></a>
                <div class='synopsis'>
                  <span class='name'>after_initialize</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Register a hook that will be run when a new <a
                  href="Database.html">Database</a> is instantiated. It is called with the
                  new database handle.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-after_initialize-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-after_initialize-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 33</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">after_initialize</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;must provide block to after_initialize&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">previous</span> = <span class="ruby-ivar">@initialize_hook</span>&#x000A;    <span class="ruby-ivar">@initialize_hook</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">db</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">previous</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">db</span>)&#x000A;      <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">db</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-extension'>
                <a name='method-c-extension'></a>
                <div class='synopsis'>
                  <span class='name'>extension</span>
                  <span class='arguments'>(*extensions)</span>
                </div>
                <div class='description'>
                  
                  <p>Apply an extension to all <a href="Database.html">Database</a> objects
                  created in the future.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-extension-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-extension-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 45</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">extensions</span>)&#x000A;  <span class="ruby-identifier">after_initialize</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">db</span><span class="ruby-operator">|</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">extensions</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Constructs a new instance of a database connection with the specified
                  options hash.</p>
                  
                  <p>Accepts the following options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:cache_schema </td><td>
                  <p>Whether schema should be cached for this <a
                  href="Database.html">Database</a> instance</p>
                  </td></tr><tr><td class='label'>:default_string_column_size </td><td>
                  <p>The default size of string columns, 255 by default.</p>
                  </td></tr><tr><td class='label'>:keep_reference </td><td>
                  <p>Whether to keep a reference to this instance in Sequel::DATABASES, true by
                  default.</p>
                  </td></tr><tr><td class='label'>:logger </td><td>
                  <p>A specific logger to use.</p>
                  </td></tr><tr><td class='label'>:loggers </td><td>
                  <p>An array of loggers to use.</p>
                  </td></tr><tr><td class='label'>:log_connection_info </td><td>
                  <p>Whether connection information should be logged when logging queries.</p>
                  </td></tr><tr><td class='label'>:log_warn_duration </td><td>
                  <p>The number of elapsed seconds after which queries should be logged at warn
                  level.</p>
                  </td></tr><tr><td class='label'>:name </td><td>
                  <p>A name to use for the <a href="Database.html">Database</a> object.</p>
                  </td></tr><tr><td class='label'>:preconnect </td><td>
                  <p>Whether to automatically connect to the maximum number of servers.  Can use
                  a valid of &#39;concurrently&#39; to preconnect in separate threads.</p>
                  </td></tr><tr><td class='label'>:quote_identifiers </td><td>
                  <p>Whether to quote identifiers.</p>
                  </td></tr><tr><td class='label'>:servers </td><td>
                  <p>A hash specifying a server/shard specific options, keyed by shard symbol .</p>
                  </td></tr><tr><td class='label'>:single_threaded </td><td>
                  <p>Whether to use a single-threaded connection pool.</p>
                  </td></tr><tr><td class='label'>:sql_log_level </td><td>
                  <p>Method to use to log <a href="SQL.html">SQL</a> to a logger, :info by
                  default.</p>
                  </td></tr></tbody></table>
                  
                  <p>All options given are also passed to the connection pool.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 113</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-ivar">@opts</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-ivar">@opts</span> = <span class="ruby-identifier">connection_pool_default_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-ivar">@opts</span>)&#x000A;  <span class="ruby-ivar">@loggers</span> = <span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:logger</span>]) <span class="ruby-operator">+</span> <span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:loggers</span>])&#x000A;  <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:servers</span>] = {} <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:servers</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)&#x000A;  <span class="ruby-ivar">@sharded</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-ivar">@opts</span>[<span class="ruby-value">:servers</span>]&#x000A;  <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:adapter_class</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>&#x000A;  <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:single_threaded</span>] = <span class="ruby-ivar">@single_threaded</span> = <span class="ruby-identifier">typecast_value_boolean</span>(<span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:single_threaded</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">single_threaded</span>))&#x000A;  <span class="ruby-ivar">@default_string_column_size</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:default_string_column_size</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_STRING_COLUMN_SIZE</span>&#x000A;&#x000A;  <span class="ruby-ivar">@schemas</span> = {}&#x000A;  <span class="ruby-ivar">@prepared_statements</span> = {}&#x000A;  <span class="ruby-ivar">@transactions</span> = {}&#x000A;  <span class="ruby-ivar">@symbol_literal_cache</span> = {}&#x000A;&#x000A;  <span class="ruby-ivar">@timezone</span> = <span class="ruby-keyword">nil</span>&#x000A;&#x000A;  <span class="ruby-ivar">@dataset_class</span> = <span class="ruby-identifier">dataset_class_default</span>&#x000A;  <span class="ruby-ivar">@cache_schema</span> = <span class="ruby-identifier">typecast_value_boolean</span>(<span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:cache_schema</span>, <span class="ruby-keyword">true</span>))&#x000A;  <span class="ruby-ivar">@dataset_modules</span> = []&#x000A;  <span class="ruby-ivar">@loaded_extensions</span> = []&#x000A;  <span class="ruby-ivar">@schema_type_classes</span> = <span class="ruby-constant">SCHEMA_TYPE_CLASSES</span>.<span class="ruby-identifier">dup</span>&#x000A;&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">sql_log_level</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:sql_log_level</span>] <span class="ruby-operator">?</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:sql_log_level</span>].<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-value">:info</span>&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">log_warn_duration</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:log_warn_duration</span>]&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">log_connection_info</span> = <span class="ruby-identifier">typecast_value_boolean</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:log_connection_info</span>])&#x000A;&#x000A;  <span class="ruby-ivar">@pool</span> = <span class="ruby-constant">ConnectionPool</span>.<span class="ruby-identifier">get_pool</span>(<span class="ruby-keyword">self</span>, <span class="ruby-ivar">@opts</span>)&#x000A;&#x000A;  <span class="ruby-identifier">reset_default_dataset</span>&#x000A;  <span class="ruby-identifier">adapter_initialize</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">typecast_value_boolean</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:keep_reference</span>]) <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">DATABASES</span>.<span class="ruby-identifier">push</span>(<span class="ruby-keyword">self</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">run_after_initialize</span>(<span class="ruby-keyword">self</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">typecast_value_boolean</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:preconnect</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@pool</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:preconnect</span>, <span class="ruby-keyword">true</span>)&#x000A;    <span class="ruby-identifier">concurrent</span> = <span class="ruby-identifier">typecast_value_string</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:preconnect</span>]) <span class="ruby-operator">==</span> <span class="ruby-string">&quot;concurrently&quot;</span>&#x000A;    <span class="ruby-ivar">@pool</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:preconnect</span>, <span class="ruby-identifier">concurrent</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">exts</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:extensions</span>]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>&#x000A;    <span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">exts</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;,&#39;</span>).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_sym</span>))&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>&#x000A;    <span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">exts</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-identifier">extension</span>(<span class="ruby-identifier">exts</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>&#x000A;    <span class="ruby-comment"># nothing</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;unsupported Database :extensions option: #{@opts[:extensions].inspect}&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-register_extension'>
                <a name='method-c-register_extension'></a>
                <div class='synopsis'>
                  <span class='name'>register_extension</span>
                  <span class='arguments'>(ext, mod=nil, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Register an extension callback for <a href="Database.html">Database</a>
                  objects.  ext should be the extension name symbol, and mod should either be
                  a Module that the database is extended with, or a callable object called
                  with the database object.  If mod is not provided, a block can be provided
                  and is treated as the mod object.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-register_extension-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-register_extension-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 54</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">register_extension</span>(<span class="ruby-identifier">ext</span>, <span class="ruby-identifier">mod</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot provide both mod and block to Database.register_extension&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Module</span>)&#x000A;      <span class="ruby-identifier">block</span> = <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">db</span><span class="ruby-operator">|</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-identifier">mod</span>)}&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">block</span> = <span class="ruby-identifier">mod</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">EXTENSIONS</span>[<span class="ruby-identifier">ext</span>] = <span class="ruby-identifier">block</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-run_after_initialize'>
                <a name='method-c-run_after_initialize'></a>
                <div class='synopsis'>
                  <span class='name'>run_after_initialize</span>
                  <span class='arguments'>(instance)</span>
                </div>
                <div class='description'>
                  
                  <p>Run the <a
                  href="Database.html#method-c-after_initialize">::after_initialize</a> hook
                  for the given <code>instance</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-run_after_initialize-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-run_after_initialize-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 67</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">run_after_initialize</span>(<span class="ruby-identifier">instance</span>)&#x000A;  <span class="ruby-ivar">@initialize_hook</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">instance</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-cast_type_literal'>
                <a name='method-i-cast_type_literal'></a>
                <div class='synopsis'>
                  <span class='name'>cast_type_literal</span>
                  <span class='arguments'>(type)</span>
                </div>
                <div class='description'>
                  
                  <p>Cast the given type to a literal type</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">cast_type_literal</span>(<span class="ruby-constant">Float</span>) <span class="ruby-comment"># double precision</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">cast_type_literal</span>(:<span class="ruby-identifier">foo</span>)  <span class="ruby-comment"># foo</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-cast_type_literal-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-cast_type_literal-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 193</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">cast_type_literal</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-identifier">type_literal</span>(<span class="ruby-value">:type=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">type</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-extension'>
                <a name='method-i-extension'></a>
                <div class='synopsis'>
                  <span class='name'>extension</span>
                  <span class='arguments'>(*exts)</span>
                </div>
                <div class='description'>
                  
                  <p>Load an extension into the receiver.  In addition to requiring the
                  extension file, this also modifies the database to work with the extension
                  (usually extending it with a module defined in the extension file).  If no
                  related extension file exists or the extension does not have specific
                  support for <a href="Database.html">Database</a> objects, an <a
                  href="Error.html">Error</a> will be raised. Returns self.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-extension-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-extension-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 202</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">exts</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">exts</span>)&#x000A;  <span class="ruby-identifier">exts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">pr</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">EXTENSIONS</span>[<span class="ruby-identifier">ext</span>]}&#x000A;      <span class="ruby-keyword">unless</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@loaded_extensions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">ext</span>)}&#x000A;        <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@loaded_extensions</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ext</span>}&#x000A;        <span class="ruby-identifier">pr</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Extension #{ext} does not have specific support handling individual databases (try: Sequel.extension #{ext.inspect})&quot;</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-freeze'>
                <a name='method-i-freeze'></a>
                <div class='synopsis'>
                  <span class='name'>freeze</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Freeze internal data structures for the <a
                  href="Database.html">Database</a> instance.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-freeze-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-freeze-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 169</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-identifier">valid_connection_sql</span>&#x000A;  <span class="ruby-identifier">metadata_dataset</span>&#x000A;  <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@loggers</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@pool</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@dataset_class</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@dataset_modules</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@schema_type_classes</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@loaded_extensions</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-identifier">metadata_dataset</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-from_application_timestamp'>
                <a name='method-i-from_application_timestamp'></a>
                <div class='synopsis'>
                  <span class='name'>from_application_timestamp</span>
                  <span class='arguments'>(v)</span>
                </div>
                <div class='description'>
                  
                  <p>Convert the given timestamp from the application&#39;s timezone, to the
                  databases&#39;s timezone or the default database timezone if the database
                  does not have a timezone.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-from_application_timestamp-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-from_application_timestamp-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 220</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">from_application_timestamp</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">convert_output_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">timezone</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-inspect'>
                <a name='method-i-inspect'></a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a string representation of the database object including the class
                  name and connection URI and options used when connecting (if any).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-inspect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-inspect-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 226</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>&#x000A;  <span class="ruby-identifier">a</span> = []&#x000A;  <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>&#x000A;  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">oo</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:orig_opts</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">oo</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">oo</span>.<span class="ruby-identifier">inspect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-node">&quot;#&lt;#{self.class}: #{a.join(&#39; &#39;)}&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-literal'>
                <a name='method-i-literal'></a>
                <div class='synopsis'>
                  <span class='name'>literal</span>
                  <span class='arguments'>(v)</span>
                </div>
                <div class='description'>
                  
                  <p>Proxy the literal call to the dataset.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-value">1</span>)   <span class="ruby-comment"># 1</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">literal</span>(:<span class="ruby-identifier">a</span>)  <span class="ruby-comment"># a</span>&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-string">&#39;a&#39;</span>) <span class="ruby-comment"># &#39;a&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-literal-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-literal-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 240</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-identifier">schema_utility_dataset</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-literal_symbol'>
                <a name='method-i-literal_symbol'></a>
                <div class='synopsis'>
                  <span class='name'>literal_symbol</span>
                  <span class='arguments'>(sym)</span>
                </div>
                <div class='description'>
                  
                  <p>Return the literalized version of the symbol if cached, or nil if it is not
                  cached.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-literal_symbol-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-literal_symbol-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 246</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">literal_symbol</span>(<span class="ruby-identifier">sym</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@symbol_literal_cache</span>[<span class="ruby-identifier">sym</span>]}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-literal_symbol_set'>
                <a name='method-i-literal_symbol_set'></a>
                <div class='synopsis'>
                  <span class='name'>literal_symbol_set</span>
                  <span class='arguments'>(sym, lit)</span>
                </div>
                <div class='description'>
                  
                  <p>Set the cached value of the literal symbol.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-literal_symbol_set-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-literal_symbol_set-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 251</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">literal_symbol_set</span>(<span class="ruby-identifier">sym</span>, <span class="ruby-identifier">lit</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@symbol_literal_cache</span>[<span class="ruby-identifier">sym</span>] = <span class="ruby-identifier">lit</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-prepared_statement'>
                <a name='method-i-prepared_statement'></a>
                <div class='synopsis'>
                  <span class='name'>prepared_statement</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='description'>
                  
                  <p>Synchronize access to the prepared statements cache.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-prepared_statement-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-prepared_statement-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 256</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">prepared_statement</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>]}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-quote_identifier'>
                <a name='method-i-quote_identifier'></a>
                <div class='synopsis'>
                  <span class='name'>quote_identifier</span>
                  <span class='arguments'>(v)</span>
                </div>
                <div class='description'>
                  
                  <p>Proxy the <a
                  href="Database.html#method-i-quote_identifier">#quote_identifier</a> method
                  to the dataset, useful for quoting unqualified identifiers for use outside
                  of datasets.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-quote_identifier-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-quote_identifier-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 263</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">quote_identifier</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-identifier">schema_utility_dataset</span>.<span class="ruby-identifier">quote_identifier</span>(<span class="ruby-identifier">v</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-schema_type_class'>
                <a name='method-i-schema_type_class'></a>
                <div class='synopsis'>
                  <span class='name'>schema_type_class</span>
                  <span class='arguments'>(type)</span>
                </div>
                <div class='description'>
                  
                  <p>Return ruby class or array of classes for the given type symbol.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-schema_type_class-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-schema_type_class-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 268</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">schema_type_class</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-ivar">@schema_type_classes</span>[<span class="ruby-identifier">type</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-serial_primary_key_options'>
                <a name='method-i-serial_primary_key_options'></a>
                <div class='synopsis'>
                  <span class='name'>serial_primary_key_options</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Default serial primary key options, used by the table creation code.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-serial_primary_key_options-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-serial_primary_key_options-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 273</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">serial_primary_key_options</span>&#x000A;  {<span class="ruby-value">:primary_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Integer</span>, <span class="ruby-value">:auto_increment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-set_prepared_statement'>
                <a name='method-i-set_prepared_statement'></a>
                <div class='synopsis'>
                  <span class='name'>set_prepared_statement</span>
                  <span class='arguments'>(name, ps)</span>
                </div>
                <div class='description'>
                  
                  <p>Cache the prepared statement object at the given name.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-set_prepared_statement-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-set_prepared_statement-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 278</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_prepared_statement</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">ps</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">ps</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-sharded-3F'>
                <a name='method-i-sharded-3F'></a>
                <div class='synopsis'>
                  <span class='name'>sharded?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether this database instance uses multiple servers, either for sharding
                  or for master/slave.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-sharded-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-sharded-3F-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 284</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">sharded?</span>&#x000A;  <span class="ruby-ivar">@sharded</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-timezone'>
                <a name='method-i-timezone'></a>
                <div class='synopsis'>
                  <span class='name'>timezone</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The timezone to use for this database, defaulting to
                  <code>Sequel.database_timezone</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-timezone-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-timezone-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 289</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">timezone</span>&#x000A;  <span class="ruby-ivar">@timezone</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">database_timezone</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-to_application_timestamp'>
                <a name='method-i-to_application_timestamp'></a>
                <div class='synopsis'>
                  <span class='name'>to_application_timestamp</span>
                  <span class='arguments'>(v)</span>
                </div>
                <div class='description'>
                  
                  <p>Convert the given timestamp to the application&#39;s timezone, from the
                  databases&#39;s timezone or the default database timezone if the database
                  does not have a timezone.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-to_application_timestamp-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-to_application_timestamp-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 296</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_application_timestamp</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">timezone</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-typecast_value'>
                <a name='method-i-typecast_value'></a>
                <div class='synopsis'>
                  <span class='name'>typecast_value</span>
                  <span class='arguments'>(column_type, value)</span>
                </div>
                <div class='description'>
                  
                  <p>Typecast the value to the given column_type. Calls
                  typecast_value_#{column_type} if the method exists, otherwise returns the
                  value. This method should raise Sequel::InvalidValue if assigned value is
                  invalid.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-typecast_value-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-typecast_value-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 305</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">typecast_value</span>(<span class="ruby-identifier">column_type</span>, <span class="ruby-identifier">value</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>&#x000A;  <span class="ruby-identifier">meth</span> = <span class="ruby-node">&quot;typecast_value_#{column_type}&quot;</span>&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-comment"># Allow calling private methods as per-type typecasting methods are private</span>&#x000A;    <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-keyword">true</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">value</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">value</span>&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-constant">TypeError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">convert_exception_class</span>(<span class="ruby-identifier">e</span>, <span class="ruby-constant">InvalidValue</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-uri'>
                <a name='method-i-uri'></a>
                <div class='synopsis'>
                  <span class='name'>uri</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the URI use to connect to the database.  If a URI was not used when
                  connecting, returns nil.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-uri-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-uri-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 318</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">uri</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:uri</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-url'>
                <a name='method-i-url'></a>
                <div class='synopsis'>
                  <span class='name'>url</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Explicit alias of uri for easier subclassing.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-url-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-url-source'><span class="ruby-comment"># File lib/sequel/database/misc.rb, line 323</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">url</span>&#x000A;  <span class="ruby-identifier">uri</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='8+-+Methods+related+to+database+transactions'>8 - Methods related to database transactions</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>TRANSACTION_ISOLATION_LEVELS</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      {:uncommitted=>'READ UNCOMMITTED'.freeze,
                      :committed=>'READ COMMITTED'.freeze,
                      :repeatable=>'REPEATABLE READ'.freeze,
                      :serializable=>'SERIALIZABLE'.freeze}.freeze
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-transaction_isolation_level'>transaction_isolation_level</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>The default transaction isolation level for this database, used for all
                      future transactions.  For MSSQL, this should be set to something if you
                      ever plan to use the :isolation option to <a
                      href="Database.html#method-i-transaction">#transaction</a>, as on MSSQL if
                      affects all future transactions on the same connection.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-after_commit'>
                <a name='method-i-after_commit'></a>
                <div class='synopsis'>
                  <span class='name'>after_commit</span>
                  <span class='arguments'>(opts=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>If a transaction is not currently in process, yield to the block
                  immediately. Otherwise, add the block to the list of blocks to call after
                  the currently in progress transaction commits (and only if it commits).
                  Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:server </td><td>
                  <p>The server/shard to use.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-after_commit-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-after_commit-source'><span class="ruby-comment"># File lib/sequel/database/transactions.rb, line 28</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_commit</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;must provide block to after_commit&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span> = <span class="ruby-identifier">_trans</span>(<span class="ruby-identifier">conn</span>)&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot call after_commit in a prepared transaction&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>[<span class="ruby-value">:prepare</span>]&#x000A;      <span class="ruby-identifier">add_transaction_hook</span>(<span class="ruby-identifier">conn</span>, <span class="ruby-value">:after_commit</span>, <span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">yield</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-after_rollback'>
                <a name='method-i-after_rollback'></a>
                <div class='synopsis'>
                  <span class='name'>after_rollback</span>
                  <span class='arguments'>(opts=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>If a transaction is not currently in progress, ignore the block. Otherwise,
                  add the block to the list of the blocks to call after the currently in
                  progress transaction rolls back (and only if it rolls back). Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:server </td><td>
                  <p>The server/shard to use.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-after_rollback-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-after_rollback-source'><span class="ruby-comment"># File lib/sequel/database/transactions.rb, line 45</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_rollback</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;must provide block to after_rollback&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span> = <span class="ruby-identifier">_trans</span>(<span class="ruby-identifier">conn</span>)&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot call after_rollback in a prepared transaction&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>[<span class="ruby-value">:prepare</span>]&#x000A;      <span class="ruby-identifier">add_transaction_hook</span>(<span class="ruby-identifier">conn</span>, <span class="ruby-value">:after_rollback</span>, <span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-in_transaction-3F'>
                <a name='method-i-in_transaction-3F'></a>
                <div class='synopsis'>
                  <span class='name'>in_transaction?</span>
                  <span class='arguments'>(opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Return true if already in a transaction given the options, false otherwise.
                  Respects the :server option for selecting a shard.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-in_transaction-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-in_transaction-3F-source'><span class="ruby-comment"># File lib/sequel/database/transactions.rb, line 58</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">in_transaction?</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]){<span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">_trans</span>(<span class="ruby-identifier">conn</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-rollback_checker'>
                <a name='method-i-rollback_checker'></a>
                <div class='synopsis'>
                  <span class='name'>rollback_checker</span>
                  <span class='arguments'>(opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a proc that you can call to check if the transaction has been
                  rolled back.  The proc will return nil if the transaction is still in
                  progress, true if the transaction was rolled back, and false if it was
                  committed.  Raises an <a href="Error.html">Error</a> if called outside a
                  transaction.  Respects the :server option for selecting a shard.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-rollback_checker-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-rollback_checker-source'><span class="ruby-comment"># File lib/sequel/database/transactions.rb, line 68</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">rollback_checker</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;not in a transaction&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">t</span> = <span class="ruby-identifier">_trans</span>(<span class="ruby-identifier">conn</span>)&#x000A;    <span class="ruby-identifier">t</span>[<span class="ruby-value">:rollback_checker</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span>{<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">t</span>[<span class="ruby-value">:rolled_back</span>]}}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-transaction'>
                <a name='method-i-transaction'></a>
                <div class='synopsis'>
                  <span class='name'>transaction</span>
                  <span class='arguments'>(opts=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Starts a database transaction.  When a database transaction is used, either
                  all statements are successful or none of the statements are successful. 
                  Note that MySQL MyISAM tables do not support transactions.</p>
                  
                  <p>The following general options are respected:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:auto_savepoint </td><td>
                  <p>Automatically use a savepoint for <a
                  href="Database.html#method-i-transaction">#transaction</a> calls inside
                  this transaction block.</p>
                  </td></tr><tr><td class='label'>:isolation </td><td>
                  <p>The transaction isolation level to use for this transaction, should be
                  :uncommitted, :committed, :repeatable, or :serializable, used if given and
                  the database/adapter supports customizable transaction isolation levels.</p>
                  </td></tr><tr><td class='label'>:num_retries </td><td>
                  <p>The number of times to retry if the :retry_on option is used. The default
                  is 5 times.  Can be set to nil to retry indefinitely, but that is not
                  recommended.</p>
                  </td></tr><tr><td class='label'>:before_retry </td><td>
                  <p>Proc to execute before rertrying if the :retry_on option is used. Called
                  with two arguments: the number of retry attempts (counting the current one)
                  and the error the last attempt failed with.</p>
                  </td></tr><tr><td class='label'>:prepare </td><td>
                  <p>A string to use as the transaction identifier for a prepared transaction
                  (two-phase commit), if the database/adapter supports prepared transactions.</p>
                  </td></tr><tr><td class='label'>:retry_on </td><td>
                  <p>An exception class or array of exception classes for which to automatically
                  retry the transaction.  Can only be set if not inside an existing
                  transaction. Note that this should not be used unless the entire
                  transaction block is idempotent, as otherwise it can cause non-idempotent
                  behavior to execute multiple times.</p>
                  </td></tr><tr><td class='label'>:rollback </td><td>
                  <p>Can the set to :reraise to reraise any Sequel::Rollback exceptions raised,
                  or :always to always rollback even if no exceptions occur (useful for
                  testing).</p>
                  </td></tr><tr><td class='label'>:server </td><td>
                  <p>The server to use for the transaction. Set to :default, :read_only, or
                  whatever symbol you used in the connect string when naming your servers.</p>
                  </td></tr><tr><td class='label'>:savepoint </td><td>
                  <p>Whether to create a new savepoint for this transaction, only respected if
                  the database/adapter supports savepoints.  By default <a
                  href="../Sequel.html">Sequel</a> will reuse an existing transaction, so if
                  you want to use a savepoint you must use this option.  If the surrounding
                  transaction uses :auto_savepoint, you can set this to false to not use a
                  savepoint. If the value given for this option is :only, it will only create
                  a savepoint if it is inside a transaction.</p>
                  </td></tr></tbody></table>
                  
                  <p>PostgreSQL specific options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:deferrable </td><td>
                  <p>(9.1+) If present, set to DEFERRABLE if true or NOT DEFERRABLE if false.</p>
                  </td></tr><tr><td class='label'>:read_only </td><td>
                  <p>If present, set to READ ONLY if true or READ WRITE if false.</p>
                  </td></tr><tr><td class='label'>:synchronous </td><td>
                  <p>if non-nil, set synchronous_commit appropriately.  Valid values true, :on,
                  false, :off, :local (9.1+), and :remote_write (9.2+).</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-transaction-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-transaction-source'><span class="ruby-comment"># File lib/sequel/database/transactions.rb, line 122</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">retry_on</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:retry_on</span>]&#x000A;    <span class="ruby-identifier">tot_retries</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:num_retries</span>, <span class="ruby-value">5</span>)&#x000A;    <span class="ruby-identifier">num_retries</span> = <span class="ruby-value">0</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">tot_retries</span>.<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-keyword">begin</span>&#x000A;      <span class="ruby-identifier">opts</span>[<span class="ruby-value">:retry_on</span>] = <span class="ruby-keyword">nil</span>&#x000A;      <span class="ruby-identifier">opts</span>[<span class="ruby-value">:retrying</span>] = <span class="ruby-keyword">true</span>&#x000A;      <span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">rescue</span> <span class="ruby-operator">*</span><span class="ruby-identifier">retry_on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">num_retries</span>&#x000A;        <span class="ruby-identifier">num_retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">num_retries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">tot_retries</span>&#x000A;          <span class="ruby-identifier">opts</span>[<span class="ruby-value">:before_retry</span>].<span class="ruby-identifier">call</span>(<span class="ruby-identifier">num_retries</span>, <span class="ruby-identifier">e</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:before_retry</span>]&#x000A;          <span class="ruby-keyword">retry</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-keyword">retry</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">raise</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:only</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_savepoints?</span>&#x000A;          <span class="ruby-keyword">if</span> <span class="ruby-identifier">_trans</span>(<span class="ruby-identifier">conn</span>)&#x000A;            <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>] = <span class="ruby-keyword">true</span>&#x000A;          <span class="ruby-keyword">else</span>&#x000A;            <span class="ruby-keyword">return</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">conn</span>)&#x000A;          <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>] = <span class="ruby-keyword">false</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">already_in_transaction?</span>(<span class="ruby-identifier">conn</span>, <span class="ruby-identifier">opts</span>)&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:rollback</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:always</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:savepoint</span>)&#x000A;          <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_savepoints?</span> &#x000A;            <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>] = <span class="ruby-keyword">true</span>&#x000A;          <span class="ruby-keyword">else</span>&#x000A;            <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot set :rollback=&gt;:always transaction option if already inside a transaction&quot;</span>&#x000A;          <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">stack</span> = <span class="ruby-identifier">_trans</span>(<span class="ruby-identifier">conn</span>)[<span class="ruby-value">:savepoints</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span>&#x000A;          <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>] = <span class="ruby-keyword">true</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;&#x000A;        <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:savepoint</span>]&#x000A;          <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:retrying</span>]&#x000A;            <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot set :retry_on options if you are already inside a transaction&quot;</span>&#x000A;          <span class="ruby-keyword">end</span>&#x000A;          <span class="ruby-keyword">return</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">conn</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;&#x000A;      <span class="ruby-identifier">_transaction</span>(<span class="ruby-identifier">conn</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='9+-+Methods+that+describe+what+the+database+supports'>9 - Methods that describe what the database supports</a>
            </h2>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-global_index_namespace-3F'>
                <a name='method-i-global_index_namespace-3F'></a>
                <div class='synopsis'>
                  <span class='name'>global_index_namespace?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database uses a global namespace for the index, true by
                  default.  If false, the indexes are going to be namespaced per table.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-global_index_namespace-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-global_index_namespace-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 12</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">global_index_namespace?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_create_table_if_not_exists-3F'>
                <a name='method-i-supports_create_table_if_not_exists-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_create_table_if_not_exists?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports CREATE TABLE IF NOT EXISTS syntax, false by
                  default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_create_table_if_not_exists-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_create_table_if_not_exists-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 18</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_create_table_if_not_exists?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_deferrable_constraints-3F'>
                <a name='method-i-supports_deferrable_constraints-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_deferrable_constraints?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports deferrable constraints, false by default as
                  few databases do.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_deferrable_constraints-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_deferrable_constraints-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 24</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_deferrable_constraints?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_deferrable_foreign_key_constraints-3F'>
                <a name='method-i-supports_deferrable_foreign_key_constraints-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_deferrable_foreign_key_constraints?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports deferrable foreign key constraints, false by
                  default as few databases do.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_deferrable_foreign_key_constraints-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_deferrable_foreign_key_constraints-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 30</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_deferrable_foreign_key_constraints?</span>&#x000A;  <span class="ruby-identifier">supports_deferrable_constraints?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_drop_table_if_exists-3F'>
                <a name='method-i-supports_drop_table_if_exists-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_drop_table_if_exists?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports DROP TABLE IF EXISTS syntax, false by
                  default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_drop_table_if_exists-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_drop_table_if_exists-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 36</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_drop_table_if_exists?</span>&#x000A;  <span class="ruby-identifier">supports_create_table_if_not_exists?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_foreign_key_parsing-3F'>
                <a name='method-i-supports_foreign_key_parsing-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_foreign_key_parsing?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports Database#foreign_key_list for parsing foreign
                  keys.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_foreign_key_parsing-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_foreign_key_parsing-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 42</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_foreign_key_parsing?</span>&#x000A;  <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:foreign_key_list</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_index_parsing-3F'>
                <a name='method-i-supports_index_parsing-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_index_parsing?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports Database#indexes for parsing indexes.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_index_parsing-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_index_parsing-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 47</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_index_parsing?</span>&#x000A;  <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:indexes</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_partial_indexes-3F'>
                <a name='method-i-supports_partial_indexes-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_partial_indexes?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports partial indexes (indexes on a subset of a
                  table), false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_partial_indexes-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_partial_indexes-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 53</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_partial_indexes?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_prepared_transactions-3F'>
                <a name='method-i-supports_prepared_transactions-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_prepared_transactions?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database and adapter support prepared transactions (two-phase
                  commit), false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_prepared_transactions-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_prepared_transactions-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 59</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_prepared_transactions?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_savepoints-3F'>
                <a name='method-i-supports_savepoints-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_savepoints?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database and adapter support savepoints, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_savepoints-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_savepoints-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 64</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_savepoints?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_savepoints_in_prepared_transactions-3F'>
                <a name='method-i-supports_savepoints_in_prepared_transactions-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_savepoints_in_prepared_transactions?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database and adapter support savepoints inside prepared
                  transactions (two-phase commit), false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_savepoints_in_prepared_transactions-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_savepoints_in_prepared_transactions-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 70</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_savepoints_in_prepared_transactions?</span>&#x000A;  <span class="ruby-identifier">supports_prepared_transactions?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">supports_savepoints?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_schema_parsing-3F'>
                <a name='method-i-supports_schema_parsing-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_schema_parsing?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports schema parsing via <a
                  href="Database.html#method-i-schema">#schema</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_schema_parsing-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_schema_parsing-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 75</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_schema_parsing?</span>&#x000A;  <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:schema_parse_table</span>, <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_table_listing-3F'>
                <a name='method-i-supports_table_listing-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_table_listing?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports Database#tables for getting list of tables.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_table_listing-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_table_listing-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 80</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_table_listing?</span>&#x000A;  <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:tables</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_transaction_isolation_levels-3F'>
                <a name='method-i-supports_transaction_isolation_levels-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_transaction_isolation_levels?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database and adapter support transaction isolation levels,
                  false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_transaction_isolation_levels-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_transaction_isolation_levels-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 90</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_transaction_isolation_levels?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_transactional_ddl-3F'>
                <a name='method-i-supports_transactional_ddl-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_transactional_ddl?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether DDL statements work correctly in transactions, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_transactional_ddl-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_transactional_ddl-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 95</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_transactional_ddl?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_view_listing-3F'>
                <a name='method-i-supports_view_listing-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_view_listing?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports Database#views for getting list of views.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_view_listing-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_view_listing-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 85</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_view_listing?</span>&#x000A;  <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:views</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_views_with_check_option-3F'>
                <a name='method-i-supports_views_with_check_option-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_views_with_check_option?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether CREATE VIEW  WITH CHECK OPTION is supported, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_views_with_check_option-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_views_with_check_option-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 100</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_views_with_check_option?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">view_with_check_option_support</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_views_with_local_check_option-3F'>
                <a name='method-i-supports_views_with_local_check_option-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_views_with_local_check_option?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether CREATE VIEW  WITH LOCAL CHECK OPTION is supported, false by
                  default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_views_with_local_check_option-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_views_with_local_check_option-3F-source'><span class="ruby-comment"># File lib/sequel/database/features.rb, line 105</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_views_with_local_check_option?</span>&#x000A;  <span class="ruby-identifier">view_with_check_option_support</span> <span class="ruby-operator">==</span> <span class="ruby-value">:local</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="https://github.com/rdoc/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
    </div>
  </body>
</html>
