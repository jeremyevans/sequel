<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Sequel::Dataset</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      function popupCode(url) {
        window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
      }
      
      function toggleCode(id) {
        var code = document.getElementById(id)
      
        code.style.display = code.style.display != 'block' ? 'block' : 'none'
        return true
      }
      
      // Make codeblocks hidden by default
      document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Sequel::Dataset
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/sequel/dataset_rb.html">lib/sequel/dataset.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/actions_rb.html">lib/sequel/dataset/actions.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/dataset_module_rb.html">lib/sequel/dataset/dataset_module.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/features_rb.html">lib/sequel/dataset/features.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/graph_rb.html">lib/sequel/dataset/graph.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/misc_rb.html">lib/sequel/dataset/misc.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/placeholder_literalizer_rb.html">lib/sequel/dataset/placeholder_literalizer.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/prepared_statements_rb.html">lib/sequel/dataset/prepared_statements.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/query_rb.html">lib/sequel/dataset/query.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/dataset/sql_rb.html">lib/sequel/dataset/sql.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/model/associations_rb.html">lib/sequel/model/associations.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/model/base_rb.html">lib/sequel/model/base.rb</a>
          </li>
          <li class='other'>
            <a href="../../files/lib/sequel/sql_rb.html">lib/sequel/sql.rb</a>
          </li>
          <li>
            <a class='show' href='#' onclick='this.parentNode.parentNode.className += " expanded"; this.parentNode.removeChild(this); return false'>show all</a>
          </li>
        </ol>
        <div class='parent'>
          Superclass:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>A dataset represents an <a href="SQL.html">SQL</a> query. Datasets can be
            used to select, insert, update and delete records.</p>
            
            <p>Query results are always retrieved on demand, so a dataset can be kept
            around and reused indefinitely (datasets never cache results):</p>
            
            <pre class="ruby"><span class="ruby-identifier">my_posts</span> = <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">posts</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">author</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;david&#39;</span>) <span class="ruby-comment"># no records are retrieved</span>&#x000A;<span class="ruby-identifier">my_posts</span>.<span class="ruby-identifier">all</span> <span class="ruby-comment"># records are retrieved</span>&#x000A;<span class="ruby-identifier">my_posts</span>.<span class="ruby-identifier">all</span> <span class="ruby-comment"># records are retrieved again</span></pre>
            
            <p>Datasets are frozen and use a functional style where modification methods
            return modified copies of the the dataset.  This allows you to reuse
            datasets:</p>
            
            <pre class="ruby"><span class="ruby-identifier">posts</span> = <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">posts</span>]&#x000A;<span class="ruby-identifier">davids_posts</span> = <span class="ruby-identifier">posts</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">author</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;david&#39;</span>)&#x000A;<span class="ruby-identifier">old_posts</span> = <span class="ruby-identifier">posts</span>.<span class="ruby-identifier">where</span>{<span class="ruby-identifier">stamp</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span> <span class="ruby-operator">-</span> <span class="ruby-value">7</span>}&#x000A;<span class="ruby-identifier">davids_old_posts</span> = <span class="ruby-identifier">davids_posts</span>.<span class="ruby-identifier">where</span>{<span class="ruby-identifier">stamp</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span> <span class="ruby-operator">-</span> <span class="ruby-value">7</span>}</pre>
            
            <p>Datasets are Enumerable objects, so they can be manipulated using any of
            the Enumerable methods, such as map, inject, etc.</p>
            
            <p>For more information, see the <a
            href="../../files/doc/dataset_basics_rdoc.html">“Dataset Basics” guide</a>.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a href="#method-c-clause_methods">clause_methods</a></li>
              <li><a href="#method-c-def_sql_method">def_sql_method</a></li>
              <li><a href="#method-c-new">new</a></li>
              <li><a href="#method-c-register_extension">register_extension</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a href="#method-i-3C-3C"><<</a></li>
              <li><a href="#method-i-3D-3D">==</a></li>
              <li><a href="#method-i-5B-5D">[]</a></li>
              <li><a href="#method-i-add_graph_aliases">add_graph_aliases</a></li>
              <li><a href="#method-i-aliased_expression_sql_append">aliased_expression_sql_append</a></li>
              <li><a href="#method-i-all">all</a></li>
              <li><a href="#method-i-array_sql_append">array_sql_append</a></li>
              <li><a href="#method-i-as_hash">as_hash</a></li>
              <li><a href="#method-i-avg">avg</a></li>
              <li><a href="#method-i-bind">bind</a></li>
              <li><a href="#method-i-boolean_constant_sql_append">boolean_constant_sql_append</a></li>
              <li><a href="#method-i-call">call</a></li>
              <li><a href="#method-i-case_expression_sql_append">case_expression_sql_append</a></li>
              <li><a href="#method-i-cast_sql_append">cast_sql_append</a></li>
              <li><a href="#method-i-clone">clone</a></li>
              <li><a href="#method-i-column_all_sql_append">column_all_sql_append</a></li>
              <li><a href="#method-i-columns">columns</a></li>
              <li><a href="#method-i-columns-21">columns!</a></li>
              <li><a href="#method-i-complex_expression_sql_append">complex_expression_sql_append</a></li>
              <li><a href="#method-i-constant_sql_append">constant_sql_append</a></li>
              <li><a href="#method-i-count">count</a></li>
              <li><a href="#method-i-current_datetime">current_datetime</a></li>
              <li><a href="#attribute-i-db">db</a></li>
              <li><a href="#method-i-delayed_evaluation_sql_append">delayed_evaluation_sql_append</a></li>
              <li><a href="#method-i-delete">delete</a></li>
              <li><a href="#method-i-distinct">distinct</a></li>
              <li><a href="#method-i-dup">dup</a></li>
              <li><a href="#method-i-each">each</a></li>
              <li><a href="#method-i-each_server">each_server</a></li>
              <li><a href="#method-i-empty-3F">empty?</a></li>
              <li><a href="#method-i-eql-3F">eql?</a></li>
              <li><a href="#method-i-escape_like">escape_like</a></li>
              <li><a href="#method-i-except">except</a></li>
              <li><a href="#method-i-exclude">exclude</a></li>
              <li><a href="#method-i-exclude_having">exclude_having</a></li>
              <li><a href="#method-i-exists">exists</a></li>
              <li><a href="#method-i-extension">extension</a></li>
              <li><a href="#method-i-filter">filter</a></li>
              <li><a href="#method-i-first">first</a></li>
              <li><a href="#method-i-first-21">first!</a></li>
              <li><a href="#method-i-first_source">first_source</a></li>
              <li><a href="#method-i-first_source_alias">first_source_alias</a></li>
              <li><a href="#method-i-first_source_table">first_source_table</a></li>
              <li><a href="#method-i-for_update">for_update</a></li>
              <li><a href="#method-i-freeze">freeze</a></li>
              <li><a href="#method-i-from">from</a></li>
              <li><a href="#method-i-from_self">from_self</a></li>
              <li><a href="#method-i-function_sql_append">function_sql_append</a></li>
              <li><a href="#method-i-get">get</a></li>
              <li><a href="#method-i-graph">graph</a></li>
              <li><a href="#method-i-grep">grep</a></li>
              <li><a href="#method-i-group">group</a></li>
              <li><a href="#method-i-group_and_count">group_and_count</a></li>
              <li><a href="#method-i-group_append">group_append</a></li>
              <li><a href="#method-i-group_by">group_by</a></li>
              <li><a href="#method-i-group_cube">group_cube</a></li>
              <li><a href="#method-i-group_rollup">group_rollup</a></li>
              <li><a href="#method-i-grouping_sets">grouping_sets</a></li>
              <li><a href="#method-i-hash">hash</a></li>
              <li><a href="#method-i-having">having</a></li>
              <li><a href="#method-i-import">import</a></li>
              <li><a href="#method-i-insert">insert</a></li>
              <li><a href="#method-i-insert_sql">insert_sql</a></li>
              <li><a href="#method-i-inspect">inspect</a></li>
              <li><a href="#method-i-intersect">intersect</a></li>
              <li><a href="#method-i-invert">invert</a></li>
              <li><a href="#method-i-join">join</a></li>
              <li><a href="#method-i-join_clause_sql_append">join_clause_sql_append</a></li>
              <li><a href="#method-i-join_on_clause_sql_append">join_on_clause_sql_append</a></li>
              <li><a href="#method-i-join_table">join_table</a></li>
              <li><a href="#method-i-join_using_clause_sql_append">join_using_clause_sql_append</a></li>
              <li><a href="#method-i-joined_dataset-3F">joined_dataset?</a></li>
              <li><a href="#method-i-last">last</a></li>
              <li><a href="#method-i-lateral">lateral</a></li>
              <li><a href="#method-i-limit">limit</a></li>
              <li><a href="#method-i-literal_append">literal_append</a></li>
              <li><a href="#method-i-lock_style">lock_style</a></li>
              <li><a href="#method-i-map">map</a></li>
              <li><a href="#method-i-max">max</a></li>
              <li><a href="#method-i-min">min</a></li>
              <li><a href="#method-i-multi_insert">multi_insert</a></li>
              <li><a href="#method-i-multi_insert_sql">multi_insert_sql</a></li>
              <li><a href="#method-i-naked">naked</a></li>
              <li><a href="#method-i-negative_boolean_constant_sql_append">negative_boolean_constant_sql_append</a></li>
              <li><a href="#method-i-offset">offset</a></li>
              <li><a href="#attribute-i-opts">opts</a></li>
              <li><a href="#method-i-or">or</a></li>
              <li><a href="#method-i-order">order</a></li>
              <li><a href="#method-i-order_append">order_append</a></li>
              <li><a href="#method-i-order_by">order_by</a></li>
              <li><a href="#method-i-order_more">order_more</a></li>
              <li><a href="#method-i-order_prepend">order_prepend</a></li>
              <li><a href="#method-i-ordered_expression_sql_append">ordered_expression_sql_append</a></li>
              <li><a href="#method-i-paged_each">paged_each</a></li>
              <li><a href="#method-i-placeholder_literal_string_sql_append">placeholder_literal_string_sql_append</a></li>
              <li><a href="#method-i-prepare">prepare</a></li>
              <li><a href="#method-i-provides_accurate_rows_matched-3F">provides_accurate_rows_matched?</a></li>
              <li><a href="#method-i-qualified_identifier_sql_append">qualified_identifier_sql_append</a></li>
              <li><a href="#method-i-qualify">qualify</a></li>
              <li><a href="#method-i-quote_identifier_append">quote_identifier_append</a></li>
              <li><a href="#method-i-quote_identifiers-3F">quote_identifiers?</a></li>
              <li><a href="#method-i-quote_schema_table_append">quote_schema_table_append</a></li>
              <li><a href="#method-i-quoted_identifier_append">quoted_identifier_append</a></li>
              <li><a href="#method-i-recursive_cte_requires_column_aliases-3F">recursive_cte_requires_column_aliases?</a></li>
              <li><a href="#method-i-requires_placeholder_type_specifiers-3F">requires_placeholder_type_specifiers?</a></li>
              <li><a href="#method-i-requires_sql_standard_datetimes-3F">requires_sql_standard_datetimes?</a></li>
              <li><a href="#method-i-returning">returning</a></li>
              <li><a href="#method-i-reverse">reverse</a></li>
              <li><a href="#method-i-reverse_order">reverse_order</a></li>
              <li><a href="#method-i-row_number_column">row_number_column</a></li>
              <li><a href="#method-i-row_proc">row_proc</a></li>
              <li><a href="#method-i-schema_and_table">schema_and_table</a></li>
              <li><a href="#method-i-select">select</a></li>
              <li><a href="#method-i-select_all">select_all</a></li>
              <li><a href="#method-i-select_append">select_append</a></li>
              <li><a href="#method-i-select_group">select_group</a></li>
              <li><a href="#method-i-select_hash">select_hash</a></li>
              <li><a href="#method-i-select_hash_groups">select_hash_groups</a></li>
              <li><a href="#method-i-select_map">select_map</a></li>
              <li><a href="#method-i-select_more">select_more</a></li>
              <li><a href="#method-i-select_order_map">select_order_map</a></li>
              <li><a href="#method-i-server">server</a></li>
              <li><a href="#method-i-server-3F">server?</a></li>
              <li><a href="#method-i-set_graph_aliases">set_graph_aliases</a></li>
              <li><a href="#method-i-single_record">single_record</a></li>
              <li><a href="#method-i-single_record-21">single_record!</a></li>
              <li><a href="#method-i-single_value">single_value</a></li>
              <li><a href="#method-i-single_value-21">single_value!</a></li>
              <li><a href="#method-i-skip_limit_check">skip_limit_check</a></li>
              <li><a href="#method-i-skip_locked">skip_locked</a></li>
              <li><a href="#method-i-split_alias">split_alias</a></li>
              <li><a href="#method-i-split_qualifiers">split_qualifiers</a></li>
              <li><a href="#method-i-sql">sql</a></li>
              <li><a href="#method-i-subscript_sql_append">subscript_sql_append</a></li>
              <li><a href="#method-i-sum">sum</a></li>
              <li><a href="#method-i-supports_cte-3F">supports_cte?</a></li>
              <li><a href="#method-i-supports_cte_in_subqueries-3F">supports_cte_in_subqueries?</a></li>
              <li><a href="#method-i-supports_derived_column_lists-3F">supports_derived_column_lists?</a></li>
              <li><a href="#method-i-supports_distinct_on-3F">supports_distinct_on?</a></li>
              <li><a href="#method-i-supports_group_cube-3F">supports_group_cube?</a></li>
              <li><a href="#method-i-supports_group_rollup-3F">supports_group_rollup?</a></li>
              <li><a href="#method-i-supports_grouping_sets-3F">supports_grouping_sets?</a></li>
              <li><a href="#method-i-supports_insert_select-3F">supports_insert_select?</a></li>
              <li><a href="#method-i-supports_intersect_except-3F">supports_intersect_except?</a></li>
              <li><a href="#method-i-supports_intersect_except_all-3F">supports_intersect_except_all?</a></li>
              <li><a href="#method-i-supports_is_true-3F">supports_is_true?</a></li>
              <li><a href="#method-i-supports_join_using-3F">supports_join_using?</a></li>
              <li><a href="#method-i-supports_lateral_subqueries-3F">supports_lateral_subqueries?</a></li>
              <li><a href="#method-i-supports_limits_in_correlated_subqueries-3F">supports_limits_in_correlated_subqueries?</a></li>
              <li><a href="#method-i-supports_modifying_joins-3F">supports_modifying_joins?</a></li>
              <li><a href="#method-i-supports_multiple_column_in-3F">supports_multiple_column_in?</a></li>
              <li><a href="#method-i-supports_offsets_in_correlated_subqueries-3F">supports_offsets_in_correlated_subqueries?</a></li>
              <li><a href="#method-i-supports_ordered_distinct_on-3F">supports_ordered_distinct_on?</a></li>
              <li><a href="#method-i-supports_regexp-3F">supports_regexp?</a></li>
              <li><a href="#method-i-supports_replace-3F">supports_replace?</a></li>
              <li><a href="#method-i-supports_returning-3F">supports_returning?</a></li>
              <li><a href="#method-i-supports_select_all_and_column-3F">supports_select_all_and_column?</a></li>
              <li><a href="#method-i-supports_skip_locked-3F">supports_skip_locked?</a></li>
              <li><a href="#method-i-supports_timestamp_timezones-3F">supports_timestamp_timezones?</a></li>
              <li><a href="#method-i-supports_timestamp_usecs-3F">supports_timestamp_usecs?</a></li>
              <li><a href="#method-i-supports_where_true-3F">supports_where_true?</a></li>
              <li><a href="#method-i-supports_window_functions-3F">supports_window_functions?</a></li>
              <li><a href="#method-i-to_hash">to_hash</a></li>
              <li><a href="#method-i-to_hash_groups">to_hash_groups</a></li>
              <li><a href="#method-i-truncate">truncate</a></li>
              <li><a href="#method-i-truncate_sql">truncate_sql</a></li>
              <li><a href="#method-i-unfiltered">unfiltered</a></li>
              <li><a href="#method-i-ungraphed">ungraphed</a></li>
              <li><a href="#method-i-ungrouped">ungrouped</a></li>
              <li><a href="#method-i-union">union</a></li>
              <li><a href="#method-i-unlimited">unlimited</a></li>
              <li><a href="#method-i-unordered">unordered</a></li>
              <li><a href="#method-i-unqualified_column_for">unqualified_column_for</a></li>
              <li><a href="#method-i-unused_table_alias">unused_table_alias</a></li>
              <li><a href="#method-i-update">update</a></li>
              <li><a href="#method-i-update_sql">update_sql</a></li>
              <li><a href="#method-i-where">where</a></li>
              <li><a href="#method-i-where_all">where_all</a></li>
              <li><a href="#method-i-where_each">where_each</a></li>
              <li><a href="#method-i-where_single_value">where_single_value</a></li>
              <li><a href="#method-i-window_sql_append">window_sql_append</a></li>
              <li><a href="#method-i-with">with</a></li>
              <li><a href="#method-i-with_extend">with_extend</a></li>
              <li><a href="#method-i-with_quote_identifiers">with_quote_identifiers</a></li>
              <li><a href="#method-i-with_recursive">with_recursive</a></li>
              <li><a href="#method-i-with_row_proc">with_row_proc</a></li>
              <li><a href="#method-i-with_sql">with_sql</a></li>
              <li><a href="#method-i-with_sql_all">with_sql_all</a></li>
              <li><a href="#method-i-with_sql_delete">with_sql_delete</a></li>
              <li><a href="#method-i-with_sql_each">with_sql_each</a></li>
              <li><a href="#method-i-with_sql_first">with_sql_first</a></li>
              <li><a href="#method-i-with_sql_insert">with_sql_insert</a></li>
              <li><a href="#method-i-with_sql_single_value">with_sql_single_value</a></li>
            </ol>
            <h3>Protected Instance</h3>
            <ol>
              <li><a href="#method-i-_columns">_columns</a></li>
              <li><a href="#method-i-_import">_import</a></li>
              <li><a href="#method-i-_select_map_multiple">_select_map_multiple</a></li>
              <li><a href="#method-i-_select_map_single">_select_map_single</a></li>
              <li><a href="#attribute-i-cache">cache</a></li>
              <li><a href="#method-i-cache_get">cache_get</a></li>
              <li><a href="#method-i-cache_set">cache_set</a></li>
              <li><a href="#method-i-clear_columns_cache">clear_columns_cache</a></li>
              <li><a href="#method-i-compound_clone">compound_clone</a></li>
              <li><a href="#method-i-compound_from_self">compound_from_self</a></li>
              <li><a href="#method-i-options_overlap">options_overlap</a></li>
              <li><a href="#method-i-simple_select_all-3F">simple_select_all?</a></li>
              <li><a href="#method-i-single_value_ds">single_value_ds</a></li>
              <li><a href="#method-i-to_prepared_statement">to_prepared_statement</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='contents'>
              <h2>Contents</h2>
              <ol>
                <li><a href="#5Buntitled-5D"></a></li>
                <li><a href="#1+-+Methods+that+return+modified+datasets">1 - Methods that return modified datasets</a></li>
                <li><a href="#2+-+Methods+that+execute+code+on+the+database">2 - Methods that execute code on the database</a></li>
                <li><a href="#3+-+User+Methods+relating+to+SQL+Creation">3 - User Methods relating to SQL Creation</a></li>
                <li><a href="#4+-+Methods+that+describe+what+the+dataset+supports">4 - Methods that describe what the dataset supports</a></li>
                <li><a href="#5+-+Methods+related+to+dataset+graphing">5 - Methods related to dataset graphing</a></li>
                <li><a href="#6+-+Miscellaneous+methods">6 - Miscellaneous methods</a></li>
                <li><a href="#8+-+Methods+related+to+prepared+statements+or+bound+variables">8 - Methods related to prepared statements or bound variables</a></li>
                <li><a href="#9+-+Internal+Methods+relating+to+SQL+Creation">9 - Internal Methods relating to SQL Creation</a></li>
              </ol>
            </div>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li>Enumerable</li>
                <li><a href="SQL/AliasMethods.html">SQL::AliasMethods</a></li>
                <li><a href="SQL/BooleanMethods.html">SQL::BooleanMethods</a></li>
                <li><a href="SQL/CastMethods.html">SQL::CastMethods</a></li>
                <li><a href="SQL/ComplexExpressionMethods.html">SQL::ComplexExpressionMethods</a></li>
                <li><a href="SQL/InequalityMethods.html">SQL::InequalityMethods</a></li>
                <li><a href="SQL/NumericMethods.html">SQL::NumericMethods</a></li>
                <li><a href="SQL/OrderMethods.html">SQL::OrderMethods</a></li>
                <li><a href="SQL/StringMethods.html">SQL::StringMethods</a></li>
              </ol>
            </div>
          </div>
          <div id='class-list'>
            <h2>Classes and Modules</h2>
            <ol>
              <li><a href="Dataset/ArgumentMapper.html">Sequel::Dataset::ArgumentMapper</a></li>
              <li><a href="Dataset/PreparedStatementMethods.html">Sequel::Dataset::PreparedStatementMethods</a></li>
              <li><a href="Dataset/UnnumberedArgumentMapper.html">Sequel::Dataset::UnnumberedArgumentMapper</a></li>
              <li><a href="Dataset/DatasetModule.html">Sequel::Dataset::DatasetModule</a></li>
              <li><a href="Dataset/PlaceholderLiteralizer.html">Sequel::Dataset::PlaceholderLiteralizer</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>OPTS</td>
                    <td>=</td>
                    <td class='context-item-value'>Sequel::OPTS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>TRUE_FREEZE</td>
                    <td>=</td>
                    <td class='context-item-value'>RUBY_VERSION >= '2.4'</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Whether <a href="Dataset.html#method-i-freeze">#freeze</a> can actually
                      freeze datasets.  True only on ruby 2.4+, as it requires clone(freeze:
                      false)</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='1+-+Methods+that+return+modified+datasets'>1 - Methods that return modified datasets</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COLUMN_CHANGE_OPTS</td>
                    <td>=</td>
                    <td class='context-item-value'>[:select, :sql, :from, :join].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The dataset options that require the removal of cached columns if changed.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>CONDITIONED_JOIN_TYPES</td>
                    <td>=</td>
                    <td class='context-item-value'>[:inner, :full_outer, :right_outer, :left_outer, :full, :right, :left].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>These symbols have _join methods created (e.g. inner_join) that call <a
                      href="Dataset.html#method-i-join_table">#join_table</a> with the symbol,
                      passing along the arguments and block from the method call.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>EMPTY_ARRAY</td>
                    <td>=</td>
                    <td class='context-item-value'>[].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>EXTENSIONS</td>
                    <td>=</td>
                    <td class='context-item-value'>{}</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Hash of extension name symbols to callable objects to load the extension
                      into the <a href="Dataset.html">Dataset</a> object (usually by extending it
                      with a module defined in the extension).</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>JOIN_METHODS</td>
                    <td>=</td>
                    <td class='context-item-value'>((CONDITIONED_JOIN_TYPES + UNCONDITIONED_JOIN_TYPES).map{|x| "#{x}_join".to_sym} + [:join, :join_table]).freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>All methods that return modified datasets with a joined table added.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>NON_SQL_OPTIONS</td>
                    <td>=</td>
                    <td class='context-item-value'>[:server, :graph, :row_proc, :quote_identifiers, :skip_symbol_cache].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Which options don&#39;t affect the <a href="SQL.html">SQL</a> generation. 
                      Used by simple_select_all? to determine if this is a simple SELECT * FROM
                      table.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>QUERY_METHODS</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      ((<<-METHS).split.map(&:to_sym) + JOIN_METHODS).freeze
                      add_graph_aliases distinct except exclude exclude_having
                      filter for_update from from_self graph grep group group_and_count group_append group_by having intersect invert
                      limit lock_style naked offset or order order_append order_by order_more order_prepend qualify
                      reverse reverse_order select select_all select_append select_group select_more server
                      set_graph_aliases unfiltered ungraphed ungrouped union
                      unlimited unordered where with with_recursive with_sql
                      METHS
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Methods that return modified datasets</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SIMPLE_SELECT_ALL_ALLOWED_FROM</td>
                    <td>=</td>
                    <td class='context-item-value'>[Symbol, SQL::Identifier, SQL::QualifiedIdentifier].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>From types allowed to be considered a simple_select_all</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>UNCONDITIONED_JOIN_TYPES</td>
                    <td>=</td>
                    <td class='context-item-value'>[:natural, :natural_left, :natural_right, :natural_full, :cross].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>These symbols have _join methods created (e.g. natural_join). They accept a
                      table argument and options hash which is passed to <a
                      href="Dataset.html#method-i-join_table">#join_table</a>, and they raise an
                      error if called with a block.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='aliases-list'>
              <h2>Public Instance Aliases</h2>
              <div class='name-list'>
                <table summary='Public Instance Aliases'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>_clone</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'><a href="#method-i-clone">clone</a></td>
                    <td class='context-item-desc'>
                      
                      <p>Save original clone implementation, as some other methods need to call it
                      internally.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-register_extension'>
                <a name='method-c-register_extension'></a>
                <div class='synopsis'>
                  <span class='name'>register_extension</span>
                  <span class='arguments'>(ext, mod=nil, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Register an extension callback for <a href="Dataset.html">Dataset</a>
                  objects.  ext should be the extension name symbol, and mod should either be
                  a Module that the dataset is extended with, or a callable object called
                  with the database object.  If mod is not provided, a block can be provided
                  and is treated as the mod object.</p>
                  
                  <p>If mod is a module, this also registers a <a
                  href="Database.html">Database</a> extension that will extend all of the
                  database&#39;s datasets.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-register_extension-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-register_extension-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 54</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">register_extension</span>(<span class="ruby-identifier">ext</span>, <span class="ruby-identifier">mod</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot provide both mod and block to Dataset.register_extension&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Module</span>)&#x000A;      <span class="ruby-identifier">block</span> = <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">ds</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-identifier">mod</span>)}&#x000A;      <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">register_extension</span>(<span class="ruby-identifier">ext</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">db</span><span class="ruby-operator">|</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">extend_datasets</span>(<span class="ruby-identifier">mod</span>)}&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">block</span> = <span class="ruby-identifier">mod</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">EXTENSIONS</span>[<span class="ruby-identifier">ext</span>] = <span class="ruby-identifier">block</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-clone'>
                <a name='method-i-clone'></a>
                <div class='synopsis'>
                  <span class='name'>clone</span>
                  <span class='arguments'>(opts = (return self; nil))</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a new clone of the dataset with the given options merged. If the
                  options changed include options in <a
                  href="Dataset.html#COLUMN_CHANGE_OPTS">COLUMN_CHANGE_OPTS</a>, the cached
                  columns are deleted.  This method should generally not be called directly
                  by user code.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-clone-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-clone-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 83</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span> = (<span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>; <span class="ruby-keyword">nil</span>))&#x000A;  <span class="ruby-identifier">c</span> = <span class="ruby-keyword">super</span>(<span class="ruby-value">:freeze=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">false</span>)&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">each_key</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">COLUMN_CHANGE_OPTS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">o</span>)}&#x000A;    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">clear_columns_cache</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-identifier">c</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-distinct'>
                <a name='method-i-distinct'></a>
                <div class='synopsis'>
                  <span class='name'>distinct</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the <a href="SQL.html">SQL</a> DISTINCT
                  clause. The DISTINCT clause is used to remove duplicate rows from the
                  output.  If arguments are provided, uses a DISTINCT ON clause, in which
                  case it will only be distinct on those columns, instead of all returned
                  columns. If a block is given, it is treated as a virtual row block, similar
                  to <code>where</code>. Raises an error if arguments are given and DISTINCT
                  ON is not supported.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">distinct</span> <span class="ruby-comment"># SQL: SELECT DISTINCT * FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">distinct</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SQL: SELECT DISTINCT ON (id) * FROM items ORDER BY id</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">distinct</span>{<span class="ruby-identifier">func</span>(:<span class="ruby-identifier">id</span>)} <span class="ruby-comment"># SQL: SELECT DISTINCT ON (func(id)) * FROM items ORDER BY id</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-distinct-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-distinct-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 116</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">distinct</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&quot;DISTINCT ON not supported&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_distinct_on?</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:distinct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">freeze</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-except'>
                <a name='method-i-except'></a>
                <div class='synopsis'>
                  <span class='name'>except</span>
                  <span class='arguments'>(dataset, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds an EXCEPT clause using a second dataset object. An EXCEPT compound
                  dataset returns all rows in the current dataset that are not in the given
                  dataset. Raises an <code>InvalidOperation</code> if the operation is not
                  supported. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:alias </td><td>
                  <p>Use the given value as the <a
                  href="Dataset.html#method-i-from_self">#from_self</a> alias</p>
                  </td></tr><tr><td class='label'>:all </td><td>
                  <p>Set to true to use EXCEPT ALL instead of EXCEPT, so duplicate rows can
                  occur</p>
                  </td></tr><tr><td class='label'>:from_self </td><td>
                  <p>Set to false to not wrap the returned dataset in a <a
                  href="Dataset.html#method-i-from_self">#from_self</a>, use with care.</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">except</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>])&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT * FROM items EXCEPT SELECT * FROM other_items) AS t1</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">except</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>], <span class="ruby-identifier">all</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">from_self</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items EXCEPT ALL SELECT * FROM other_items</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">except</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>], <span class="ruby-keyword">alias</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">i</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT * FROM items EXCEPT SELECT * FROM other_items) AS i</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-except-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-except-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 139</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">except</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&quot;EXCEPT not supported&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_intersect_except?</span>&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&quot;EXCEPT ALL not supported&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:all</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_intersect_except_all?</span>&#x000A;  <span class="ruby-identifier">compound_clone</span>(<span class="ruby-value">:except</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-exclude'>
                <a name='method-i-exclude'></a>
                <div class='synopsis'>
                  <span class='name'>exclude</span>
                  <span class='arguments'>(*cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Performs the inverse of <a href="Dataset.html#method-i-where">#where</a>. 
                  Note that if you have multiple filter conditions, this is not the same as a
                  negation of all conditions.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (category != &#39;software&#39;)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE ((category != &#39;software&#39;) OR (id != 3))</span></pre>
                  
                  <p>Also note that <a href="SQL.html">SQL</a> uses 3-valued boolean logic
                  (<code>true</code>, <code>false</code>, <code>NULL</code>), so the inverse
                  of a true condition is a false condition, and will still not match rows
                  that were NULL originally.  If you take the earlier example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (category != &#39;software&#39;)</span></pre>
                  
                  <p>Note that this does not match rows where <code>category</code> is
                  <code>NULL</code>.  This is because <code>NULL</code> is an unknown value,
                  and you do not know whether or not the <code>NULL</code> category is
                  <code>software</code>.  You can explicitly specify how to handle
                  <code>NULL</code> values if you want:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">exclude</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-operator">~</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>) <span class="ruby-operator">&amp;</span> {<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>})&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE ((category IS NULL) OR (category != &#39;software&#39;))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-exclude-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-exclude-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 169</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">exclude</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">add_filter</span>(<span class="ruby-value">:where</span>, <span class="ruby-identifier">cond</span>, <span class="ruby-keyword">true</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-exclude_having'>
                <a name='method-i-exclude_having'></a>
                <div class='synopsis'>
                  <span class='name'>exclude_having</span>
                  <span class='arguments'>(*cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Inverts the given conditions and adds them to the HAVING clause.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select_group</span>(:<span class="ruby-identifier">name</span>).<span class="ruby-identifier">exclude_having</span>{<span class="ruby-identifier">count</span>(<span class="ruby-identifier">name</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>}&#x000A;<span class="ruby-comment"># SELECT name FROM items GROUP BY name HAVING (count(name) &gt;= 2)</span></pre>
                  
                  <p>See documentation for exclude for how inversion is handled in regards to <a
                  href="SQL.html">SQL</a> 3-valued boolean logic.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-exclude_having-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-exclude_having-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 180</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">exclude_having</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">add_filter</span>(<span class="ruby-value">:having</span>, <span class="ruby-identifier">cond</span>, <span class="ruby-keyword">true</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-extension'>
                <a name='method-i-extension'></a>
                <div class='synopsis'>
                  <span class='name'>extension</span>
                  <span class='arguments'>(*a)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a clone of the dataset loaded with the given dataset extensions. If
                  no related extension file exists or the extension does not have specific
                  support for <a href="Dataset.html">Dataset</a> objects, an <a
                  href="Error.html">Error</a> will be raised.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-extension-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-extension-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 188</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">a</span>)&#x000A;  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_clone</span>(<span class="ruby-value">:freeze=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">false</span>)&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:_extension!</span>, <span class="ruby-identifier">a</span>)&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-identifier">c</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-filter'>
                <a name='method-i-filter'></a>
                <div class='synopsis'>
                  <span class='name'>filter</span>
                  <span class='arguments'>(*cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias for where.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-filter-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-filter-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 205</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">where</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-for_update'>
                <a name='method-i-for_update'></a>
                <div class='synopsis'>
                  <span class='name'>for_update</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a cloned dataset with a :update lock style.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">for_update</span> <span class="ruby-comment"># SELECT * FROM table FOR UPDATE</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-for_update-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-for_update-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 212</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">for_update</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_for_update_ds</span>){<span class="ruby-identifier">lock_style</span>(<span class="ruby-value">:update</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-from'>
                <a name='method-i-from'></a>
                <div class='synopsis'>
                  <span class='name'>from</span>
                  <span class='arguments'>(*source, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the source changed. If no source is
                  given, removes all tables.  If multiple sources are given, it is the same
                  as using a CROSS JOIN (cartesian product) between all tables. If a block is
                  given, it is treated as a virtual row block, similar to <code>where</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">from</span> <span class="ruby-comment"># SQL: SELECT *</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">from</span>(:<span class="ruby-identifier">blah</span>) <span class="ruby-comment"># SQL: SELECT * FROM blah</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">from</span>(:<span class="ruby-identifier">blah</span>, :<span class="ruby-identifier">foo</span>) <span class="ruby-comment"># SQL: SELECT * FROM blah, foo</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">from</span>{<span class="ruby-identifier">fun</span>(<span class="ruby-identifier">arg</span>)} <span class="ruby-comment"># SQL: SELECT * FROM fun(arg)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-from-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-from-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 225</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">source</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">table_alias_num</span> = <span class="ruby-value">0</span>&#x000A;  <span class="ruby-identifier">ctes</span> = <span class="ruby-keyword">nil</span>&#x000A;  <span class="ruby-identifier">source</span>.<span class="ruby-identifier">map!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">s</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">Dataset</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">hoist_cte?</span>(<span class="ruby-identifier">s</span>)&#x000A;        <span class="ruby-identifier">ctes</span> <span class="ruby-operator">||=</span> []&#x000A;        <span class="ruby-identifier">ctes</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:with</span>]&#x000A;        <span class="ruby-identifier">s</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-value">:with=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">s</span>, <span class="ruby-identifier">dataset_alias</span>(<span class="ruby-identifier">table_alias_num</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>))&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;      <span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">aliaz</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">s</span>)&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">aliaz</span>&#x000A;        <span class="ruby-identifier">s</span> = <span class="ruby-identifier">sch</span> <span class="ruby-operator">?</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>) <span class="ruby-operator">:</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table</span>)&#x000A;        <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">s</span>, <span class="ruby-identifier">aliaz</span>.<span class="ruby-identifier">to_sym</span>)&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">s</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">s</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">o</span> = {<span class="ruby-value">:from=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">freeze</span>}&#x000A;  <span class="ruby-identifier">o</span>[<span class="ruby-value">:with</span>] = ((<span class="ruby-identifier">opts</span>[<span class="ruby-value">:with</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">EMPTY_ARRAY</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">ctes</span>).<span class="ruby-identifier">freeze</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ctes</span>&#x000A;  <span class="ruby-identifier">o</span>[<span class="ruby-value">:num_dataset_sources</span>] = <span class="ruby-identifier">table_alias_num</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_alias_num</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">o</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-from_self'>
                <a name='method-i-from_self'></a>
                <div class='synopsis'>
                  <span class='name'>from_self</span>
                  <span class='arguments'>(opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a dataset selecting from the current dataset. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:alias </td><td>
                  <p>Controls the alias of the table</p>
                  </td></tr><tr><td class='label'>:column_aliases </td><td>
                  <p>Also aliases columns, using derived column lists. Only used in conjunction
                  with :alias.</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-identifier">ds</span> = <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">name</span>).<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>)&#x000A;<span class="ruby-comment"># SELECT id,name FROM items ORDER BY name</span>&#x000A;&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">from_self</span>&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT id, name FROM items ORDER BY name) AS t1</span>&#x000A;&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">from_self</span>(<span class="ruby-keyword">alias</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">foo</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT id, name FROM items ORDER BY name) AS foo</span>&#x000A;&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">from_self</span>(<span class="ruby-keyword">alias</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">foo</span>, <span class="ruby-identifier">column_aliases</span><span class="ruby-operator">:</span> [:<span class="ruby-identifier">c1</span>, :<span class="ruby-identifier">c2</span>])&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT id, name FROM items ORDER BY name) AS foo(c1, c2)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-from_self-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-from_self-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 273</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">from_self</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">fs</span> = {}&#x000A;  <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">fs</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">non_sql_option?</span>(<span class="ruby-identifier">k</span>)}&#x000A;  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">fs</span>).<span class="ruby-identifier">from</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:alias</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">as</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:alias</span>], <span class="ruby-identifier">opts</span>[<span class="ruby-value">:column_aliases</span>]) <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">_columns</span>&#x000A;    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:columns=</span>, <span class="ruby-identifier">cols</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">c</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-grep'>
                <a name='method-i-grep'></a>
                <div class='synopsis'>
                  <span class='name'>grep</span>
                  <span class='arguments'>(columns, patterns, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Match any of the columns to any of the patterns. The terms can be strings
                  (which use LIKE) or regular expressions if the database supports that. Note
                  that the total number of pattern matches will be Array(columns).length *
                  Array(terms).length, which could cause performance issues.</p>
                  
                  <p>Options (all are boolean):</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:all_columns </td><td>
                  <p>All columns must be matched to any of the given patterns.</p>
                  </td></tr><tr><td class='label'>:all_patterns </td><td>
                  <p>All patterns must match at least one of the columns.</p>
                  </td></tr><tr><td class='label'>:case_insensitive </td><td>
                  <p>Use a case insensitive pattern match (the default is case sensitive if the
                  database supports it).</p>
                  </td></tr></tbody></table>
                  
                  <p>If both :all_columns and :all_patterns are true, all columns must match all
                  patterns.</p>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">grep</span>(:<span class="ruby-identifier">a</span>, <span class="ruby-string">&#39;%test%&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (a LIKE &#39;%test%&#39; ESCAPE &#39;\&#39;)</span>&#x000A;&#x000A;<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">grep</span>([:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>], <span class="ruby-node">%w&#39;%test% foo&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE ((a LIKE &#39;%test%&#39; ESCAPE &#39;\&#39;) OR (a LIKE &#39;foo&#39; ESCAPE &#39;\&#39;)</span>&#x000A;<span class="ruby-comment">#   OR (b LIKE &#39;%test%&#39; ESCAPE &#39;\&#39;) OR (b LIKE &#39;foo&#39; ESCAPE &#39;\&#39;))</span>&#x000A;&#x000A;<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">grep</span>([:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>], <span class="ruby-node">%w&#39;%foo% %bar%&#39;</span>, <span class="ruby-identifier">all_patterns</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM a WHERE (((a LIKE &#39;%foo%&#39; ESCAPE &#39;\&#39;) OR (b LIKE &#39;%foo%&#39; ESCAPE &#39;\&#39;))</span>&#x000A;<span class="ruby-comment">#   AND ((a LIKE &#39;%bar%&#39; ESCAPE &#39;\&#39;) OR (b LIKE &#39;%bar%&#39; ESCAPE &#39;\&#39;)))</span>&#x000A;&#x000A;<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">grep</span>([:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>], <span class="ruby-node">%w&#39;%foo% %bar%&#39;</span>, <span class="ruby-identifier">all_columns</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM a WHERE (((a LIKE &#39;%foo%&#39; ESCAPE &#39;\&#39;) OR (a LIKE &#39;%bar%&#39; ESCAPE &#39;\&#39;))</span>&#x000A;<span class="ruby-comment">#   AND ((b LIKE &#39;%foo%&#39; ESCAPE &#39;\&#39;) OR (b LIKE &#39;%bar%&#39; ESCAPE &#39;\&#39;)))</span>&#x000A;&#x000A;<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">grep</span>([:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>], <span class="ruby-node">%w&#39;%foo% %bar%&#39;</span>, <span class="ruby-identifier">all_patterns</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">all_columns</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM a WHERE ((a LIKE &#39;%foo%&#39; ESCAPE &#39;\&#39;) AND (b LIKE &#39;%foo%&#39; ESCAPE &#39;\&#39;)</span>&#x000A;<span class="ruby-comment">#   AND (a LIKE &#39;%bar%&#39; ESCAPE &#39;\&#39;) AND (b LIKE &#39;%bar%&#39; ESCAPE &#39;\&#39;))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-grep-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-grep-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 318</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">grep</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">patterns</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:all_patterns</span>]&#x000A;    <span class="ruby-identifier">conds</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">patterns</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pat</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:all_columns</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:AND</span> <span class="ruby-operator">:</span> <span class="ruby-value">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">StringExpression</span>.<span class="ruby-identifier">like</span>(<span class="ruby-identifier">c</span>, <span class="ruby-identifier">pat</span>, <span class="ruby-identifier">opts</span>)})&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:all_patterns</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:AND</span> <span class="ruby-operator">:</span> <span class="ruby-value">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">conds</span>))&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">conds</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-constant">Array</span>(<span class="ruby-identifier">patterns</span>).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">pat</span><span class="ruby-operator">|</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">StringExpression</span>.<span class="ruby-identifier">like</span>(<span class="ruby-identifier">c</span>, <span class="ruby-identifier">pat</span>, <span class="ruby-identifier">opts</span>)})&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:all_columns</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:AND</span> <span class="ruby-operator">:</span> <span class="ruby-value">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">conds</span>))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-group'>
                <a name='method-i-group'></a>
                <div class='synopsis'>
                  <span class='name'>group</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the results grouped by the value of  the
                  given columns.  If a block is given, it is treated as a virtual row block,
                  similar to <code>where</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT * FROM items GROUP BY id</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>(:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>) <span class="ruby-comment"># SELECT * FROM items GROUP BY id, name</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>{[<span class="ruby-identifier">a</span>, <span class="ruby-identifier">sum</span>(<span class="ruby-identifier">b</span>)]} <span class="ruby-comment"># SELECT * FROM items GROUP BY a, sum(b)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-group-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-group-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 339</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:group</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">freeze</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-group_and_count'>
                <a name='method-i-group_and_count'></a>
                <div class='synopsis'>
                  <span class='name'>group_and_count</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a dataset grouped by the given column with count by group. Column
                  aliases may be supplied, and will be included in the select clause. If a
                  block is given, it is treated as a virtual row block, similar to
                  <code>where</code>.</p>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group_and_count</span>(:<span class="ruby-identifier">name</span>).<span class="ruby-identifier">all</span>&#x000A;<span class="ruby-comment"># SELECT name, count(*) AS count FROM items GROUP BY name </span>&#x000A;<span class="ruby-comment"># =&gt; [{:name=&gt;&#39;a&#39;, :count=&gt;1}, ...]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group_and_count</span>(:<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">last_name</span>).<span class="ruby-identifier">all</span>&#x000A;<span class="ruby-comment"># SELECT first_name, last_name, count(*) AS count FROM items GROUP BY first_name, last_name</span>&#x000A;<span class="ruby-comment"># =&gt; [{:first_name=&gt;&#39;a&#39;, :last_name=&gt;&#39;b&#39;, :count=&gt;1}, ...]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group_and_count</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">first_name</span>].<span class="ruby-identifier">as</span>(:<span class="ruby-identifier">name</span>)).<span class="ruby-identifier">all</span>&#x000A;<span class="ruby-comment"># SELECT first_name AS name, count(*) AS count FROM items GROUP BY first_name</span>&#x000A;<span class="ruby-comment"># =&gt; [{:name=&gt;&#39;a&#39;, :count=&gt;1}, ...]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group_and_count</span>{<span class="ruby-identifier">substr</span>(:<span class="ruby-identifier">first_name</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">as</span>(:<span class="ruby-identifier">initial</span>)}.<span class="ruby-identifier">all</span>&#x000A;<span class="ruby-comment"># SELECT substr(first_name, 1, 1) AS initial, count(*) AS count FROM items GROUP BY substr(first_name, 1, 1)</span>&#x000A;<span class="ruby-comment"># =&gt; [{:initial=&gt;&#39;a&#39;, :count=&gt;1}, ...]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-group_and_count-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-group_and_count-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 370</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">group_and_count</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">select_group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">select_append</span>(<span class="ruby-constant">COUNT_OF_ALL_AS_COUNT</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-group_append'>
                <a name='method-i-group_append'></a>
                <div class='synopsis'>
                  <span class='name'>group_append</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the given columns added to the list of
                  existing columns to group on. If no existing columns are present this
                  method simply sets the columns as the initial ones to group on.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group_append</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items GROUP BY b</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">group_append</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items GROUP BY a, b</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-group_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-group_append-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 380</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">group_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">columns</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:group</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">columns</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:group</span>]&#x000A;  <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-group_by'>
                <a name='method-i-group_by'></a>
                <div class='synopsis'>
                  <span class='name'>group_by</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of group</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-group_by-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-group_by-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 345</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">group_by</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-group_cube'>
                <a name='method-i-group_cube'></a>
                <div class='synopsis'>
                  <span class='name'>group_cube</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Adds the appropriate CUBE syntax to GROUP BY.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-group_cube-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-group_cube-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 386</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">group_cube</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;GROUP BY CUBE not supported on #{db.database_type}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_group_cube?</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:group_options=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:cube</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-group_rollup'>
                <a name='method-i-group_rollup'></a>
                <div class='synopsis'>
                  <span class='name'>group_rollup</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Adds the appropriate ROLLUP syntax to GROUP BY.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-group_rollup-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-group_rollup-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 392</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">group_rollup</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;GROUP BY ROLLUP not supported on #{db.database_type}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_group_rollup?</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:group_options=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:rollup</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-grouping_sets'>
                <a name='method-i-grouping_sets'></a>
                <div class='synopsis'>
                  <span class='name'>grouping_sets</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Adds the appropriate GROUPING SETS syntax to GROUP BY.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-grouping_sets-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-grouping_sets-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 398</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">grouping_sets</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;GROUP BY GROUPING SETS not supported on #{db.database_type}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_grouping_sets?</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:group_options=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:&quot;grouping sets&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-having'>
                <a name='method-i-having'></a>
                <div class='synopsis'>
                  <span class='name'>having</span>
                  <span class='arguments'>(*cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the HAVING conditions changed. See <a
                  href="Dataset.html#method-i-where">where</a> for argument types.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>(:<span class="ruby-identifier">sum</span>).<span class="ruby-identifier">having</span>(<span class="ruby-identifier">sum</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items GROUP BY sum HAVING (sum = 10)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-having-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-having-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 407</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">having</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">add_filter</span>(<span class="ruby-value">:having</span>, <span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-intersect'>
                <a name='method-i-intersect'></a>
                <div class='synopsis'>
                  <span class='name'>intersect</span>
                  <span class='arguments'>(dataset, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds an INTERSECT clause using a second dataset object. An INTERSECT
                  compound dataset returns all rows in both the current dataset and the given
                  dataset. Raises an <code>InvalidOperation</code> if the operation is not
                  supported. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:alias </td><td>
                  <p>Use the given value as the <a
                  href="Dataset.html#method-i-from_self">#from_self</a> alias</p>
                  </td></tr><tr><td class='label'>:all </td><td>
                  <p>Set to true to use INTERSECT ALL instead of INTERSECT, so duplicate rows
                  can occur</p>
                  </td></tr><tr><td class='label'>:from_self </td><td>
                  <p>Set to false to not wrap the returned dataset in a <a
                  href="Dataset.html#method-i-from_self">#from_self</a>, use with care.</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">intersect</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>])&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT * FROM items INTERSECT SELECT * FROM other_items) AS t1</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">intersect</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>], <span class="ruby-identifier">all</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">from_self</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items INTERSECT ALL SELECT * FROM other_items</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">intersect</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>], <span class="ruby-keyword">alias</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">i</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT * FROM items INTERSECT SELECT * FROM other_items) AS i</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-intersect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-intersect-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 428</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">intersect</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&quot;INTERSECT not supported&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_intersect_except?</span>&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&quot;INTERSECT ALL not supported&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:all</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_intersect_except_all?</span>&#x000A;  <span class="ruby-identifier">compound_clone</span>(<span class="ruby-value">:intersect</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-invert'>
                <a name='method-i-invert'></a>
                <div class='synopsis'>
                  <span class='name'>invert</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Inverts the current WHERE and HAVING clauses.  If there is neither a WHERE
                  or HAVING clause, adds a WHERE clause that is always false.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>).<span class="ruby-identifier">invert</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (category != &#39;software&#39;)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>).<span class="ruby-identifier">invert</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE ((category != &#39;software&#39;) OR (id != 3))</span></pre>
                  
                  <p>See documentation for exclude for how inversion is handled in regards to <a
                  href="SQL.html">SQL</a> 3-valued boolean logic.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-invert-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-invert-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 445</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">invert</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_invert_ds</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">having</span>, <span class="ruby-identifier">where</span> = <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-value">:having</span>, <span class="ruby-value">:where</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">having</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">where</span>.<span class="ruby-identifier">nil?</span>&#x000A;      <span class="ruby-identifier">where</span>(<span class="ruby-keyword">false</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">o</span> = {}&#x000A;      <span class="ruby-identifier">o</span>[<span class="ruby-value">:having</span>] = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">having</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">having</span>&#x000A;      <span class="ruby-identifier">o</span>[<span class="ruby-value">:where</span>] = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">where</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">where</span>&#x000A;      <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">o</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-join'>
                <a name='method-i-join'></a>
                <div class='synopsis'>
                  <span class='name'>join</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of <code>inner_join</code></p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-join-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-join-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 460</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">join</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">inner_join</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-join_table'>
                <a name='method-i-join_table'></a>
                <div class='synopsis'>
                  <span class='name'>join_table</span>
                  <span class='arguments'>(type, table, expr=nil, options=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a joined dataset.  Not usually called directly, users should use
                  the appropriate join method (e.g. join, left_join, natural_join,
                  cross_join) which fills in the <code>type</code> argument.</p>
                  
                  <p>Takes the following arguments:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>type </td><td>
                  <p>The type of join to do (e.g. :inner)</p>
                  </td></tr><tr><td class='label'>table </td><td>
                  <p>table to join into the current dataset.  Generally one of the following
                  types:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>String, Symbol </td><td>
                  <p>identifier used as table or view name</p>
                  </td></tr><tr><td class='label'><a href="Dataset.html">Dataset</a> </td><td>
                  <p>a subselect is performed with an alias of tN for some value of N</p>
                  </td></tr><tr><td class='label'><a href="SQL/Function.html">SQL::Function</a> </td><td>
                  <p>set returning function</p>
                  </td></tr><tr><td class='label'><a href="SQL/AliasedExpression.html">SQL::AliasedExpression</a> </td><td>
                  <p>already aliased expression.  Uses given alias unless overridden by the
                  :table_alias option.</p>
                  </td></tr></tbody></table>
                  </td></tr><tr><td class='label'>expr </td><td>
                  <p>conditions used when joining, depends on type:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>Hash, Array of pairs </td><td>
                  <p>Assumes key (1st arg) is column of joined table (unless already qualified),
                  and value (2nd arg) is column of the last joined or primary table (or the
                  :implicit_qualifier option). To specify multiple conditions on a single
                  joined table column, you must use an array.  Uses a JOIN with an ON clause.</p>
                  </td></tr><tr><td class='label'>Array </td><td>
                  <p>If all members of the array are symbols, considers them as columns and 
                  uses a JOIN with a USING clause.  Most databases will remove duplicate
                  columns from the result set if this is used.</p>
                  </td></tr><tr><td class='label'>nil </td><td>
                  <p>If a block is not given, doesn&#39;t use ON or USING, so the JOIN should be
                  a NATURAL or CROSS join. If a block is given, uses an ON clause based on
                  the block, see below.</p>
                  </td></tr><tr><td class='label'>otherwise </td><td>
                  <p>Treats the argument as a filter expression, so strings are considered
                  literal, symbols specify boolean columns, and <a
                  href="../Sequel.html">Sequel</a> expressions can be used. Uses a JOIN with
                  an ON clause.</p>
                  </td></tr></tbody></table>
                  </td></tr><tr><td class='label'>options </td><td>
                  <p>a hash of options, with the following keys supported:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:table_alias </td><td>
                  <p>Override the table alias used when joining.  In general you shouldn&#39;t
                  use this option, you should provide the appropriate <a
                  href="SQL/AliasedExpression.html">SQL::AliasedExpression</a> as the table
                  argument.</p>
                  </td></tr><tr><td class='label'>:implicit_qualifier </td><td>
                  <p>The name to use for qualifying implicit conditions.  By default, the last
                  joined or primary table is used.</p>
                  </td></tr><tr><td class='label'>:reset_implicit_qualifier </td><td>
                  <p>Can set to false to ignore this join when future joins determine qualifier
                  for implicit conditions.</p>
                  </td></tr><tr><td class='label'>:qualify </td><td>
                  <p>Can be set to false to not do any implicit qualification.  Can be set to
                  :deep to use the <a href="Qualifier.html">Qualifier</a> AST Transformer,
                  which will attempt to qualify subexpressions of the expression tree.  Can
                  be set to :symbol to only qualify symbols. Defaults to the value of
                  default_join_table_qualification.</p>
                  </td></tr></tbody></table>
                  </td></tr><tr><td class='label'>block </td><td>
                  <p>The block argument should only be given if a JOIN with an ON clause is
                  used, in which case it yields the table alias/name for the table currently
                  being joined, the table alias/name for the last joined (or first table),
                  and an array of previous <a href="SQL/JoinClause.html">SQL::JoinClause</a>.
                  Unlike <code>where</code>, this block is not treated as a virtual row
                  block.</p>
                  </td></tr></tbody></table>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">a</span>].<span class="ruby-identifier">join_table</span>(:<span class="ruby-identifier">cross</span>, :<span class="ruby-identifier">b</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM a CROSS JOIN b</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">a</span>].<span class="ruby-identifier">join_table</span>(:<span class="ruby-identifier">inner</span>, <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">b</span>], <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-identifier">d</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM a INNER JOIN (SELECT * FROM b) AS t1 ON (t1.c = a.d)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">a</span>].<span class="ruby-identifier">join_table</span>(:<span class="ruby-identifier">left</span>, <span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">b</span>].<span class="ruby-identifier">as</span>(:<span class="ruby-identifier">c</span>), [:<span class="ruby-identifier">d</span>])&#x000A;<span class="ruby-comment"># SELECT * FROM a LEFT JOIN b AS c USING (d)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">a</span>].<span class="ruby-identifier">natural_join</span>(:<span class="ruby-identifier">b</span>).<span class="ruby-identifier">join_table</span>(:<span class="ruby-identifier">inner</span>, :<span class="ruby-identifier">c</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span>, <span class="ruby-identifier">jta</span>, <span class="ruby-identifier">js</span><span class="ruby-operator">|</span>&#x000A;  (<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">ta</span>, :<span class="ruby-identifier">d</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">jta</span>, :<span class="ruby-identifier">e</span>)) <span class="ruby-operator">&amp;</span> {<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">ta</span>, :<span class="ruby-identifier">f</span>)=<span class="ruby-operator">&gt;</span><span class="ruby-constant">DB</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">js</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">table</span>).<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">g</span>)}&#x000A;<span class="ruby-keyword">end</span>&#x000A;<span class="ruby-comment"># SELECT * FROM a NATURAL JOIN b INNER JOIN c</span>&#x000A;<span class="ruby-comment">#   ON ((c.d &gt; b.e) AND (c.f IN (SELECT g FROM b)))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-join_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-join_table-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 523</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">expr</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hoist_cte?</span>(<span class="ruby-identifier">table</span>)&#x000A;    <span class="ruby-identifier">s</span>, <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">hoist_cte</span>(<span class="ruby-identifier">table</span>)&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">expr</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">using_join</span> = <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">expr</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)}&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">using_join</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_join_using?</span>&#x000A;    <span class="ruby-identifier">h</span> = {}&#x000A;    <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">e</span>] = <span class="ruby-identifier">e</span>}&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">h</span>, <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:table_alias</span>]&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>)&#x000A;    <span class="ruby-identifier">table_expr</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_alias</span>&#x000A;      <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table</span>.<span class="ruby-identifier">expression</span>, <span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">table</span>.<span class="ruby-identifier">columns</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">table</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">table</span> = <span class="ruby-identifier">table_expr</span>.<span class="ruby-identifier">expression</span>&#x000A;    <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">table_expr</span>.<span class="ruby-identifier">alias</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_alias</span>.<span class="ruby-identifier">nil?</span>&#x000A;      <span class="ruby-identifier">table_alias_num</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:num_dataset_sources</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;      <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">dataset_alias</span>(<span class="ruby-identifier">table_alias_num</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span>&#x000A;    <span class="ruby-identifier">table_expr</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">table</span>, <span class="ruby-identifier">implicit_table_alias</span> = <span class="ruby-identifier">split_alias</span>(<span class="ruby-identifier">table</span>)&#x000A;    <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">implicit_table_alias</span>&#x000A;    <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">table</span>&#x000A;    <span class="ruby-identifier">table_expr</span> = <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">?</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">table</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">join</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table_expr</span>)&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">using_join</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can&#39;t use a block if providing an array of symbols as expr&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinUsingClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">table_expr</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">last_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:implicit_qualifier</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:last_joined_table</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">first_source_alias</span>&#x000A;    <span class="ruby-identifier">qualify_type</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:qualify</span>]&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>(<span class="ruby-identifier">expr</span>)&#x000A;      <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">qualify_type</span> = <span class="ruby-identifier">default_join_table_qualification</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">qualify_type</span>.<span class="ruby-identifier">nil?</span>&#x000A;        <span class="ruby-keyword">case</span> <span class="ruby-identifier">qualify_type</span>&#x000A;        <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span>&#x000A;          <span class="ruby-keyword">nil</span> <span class="ruby-comment"># Do no qualification</span>&#x000A;        <span class="ruby-keyword">when</span> <span class="ruby-value">:deep</span>&#x000A;          <span class="ruby-identifier">k</span> = <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Qualifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">transform</span>(<span class="ruby-identifier">k</span>)&#x000A;          <span class="ruby-identifier">v</span> = <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Qualifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">last_alias</span>).<span class="ruby-identifier">transform</span>(<span class="ruby-identifier">v</span>)&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-identifier">k</span> = <span class="ruby-identifier">qualified_column_name</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">table_name</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)&#x000A;          <span class="ruby-identifier">v</span> = <span class="ruby-identifier">qualified_column_name</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">last_alias</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        [<span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span>]&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">expr</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">from_value_pairs</span>(<span class="ruby-identifier">expr</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;      <span class="ruby-identifier">expr2</span> = <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">last_alias</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:join</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">EMPTY_ARRAY</span>)&#x000A;      <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">expr</span> <span class="ruby-operator">?</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:AND</span>, <span class="ruby-identifier">expr</span>, <span class="ruby-identifier">expr2</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">expr2</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinOnClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">table_expr</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">opts</span> = {<span class="ruby-value">:join</span> =<span class="ruby-operator">&gt;</span> ((<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:join</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">EMPTY_ARRAY</span>) <span class="ruby-operator">+</span> [<span class="ruby-identifier">join</span>]).<span class="ruby-identifier">freeze</span>}&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:last_joined_table</span>] = <span class="ruby-identifier">table_name</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:reset_implicit_qualifier</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:num_dataset_sources</span>] = <span class="ruby-identifier">table_alias_num</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_alias_num</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-lateral'>
                <a name='method-i-lateral'></a>
                <div class='synopsis'>
                  <span class='name'>lateral</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Marks this dataset as a lateral dataset.  If used in another dataset&#39;s
                  FROM or JOIN clauses, it will surround the subquery with LATERAL to enable
                  it to deal with previous tables in the query:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">from</span>(:<span class="ruby-identifier">a</span>, <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">b</span>].<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">a</span>][:<span class="ruby-identifier">c</span>]=<span class="ruby-operator">&gt;</span><span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">b</span>][:<span class="ruby-identifier">d</span>]).<span class="ruby-identifier">lateral</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM a, LATERAL (SELECT * FROM b WHERE (a.c = b.d))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-lateral-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-lateral-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 617</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">lateral</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:lateral=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-limit'>
                <a name='method-i-limit'></a>
                <div class='synopsis'>
                  <span class='name'>limit</span>
                  <span class='arguments'>(l, o = (no_offset = true; nil))</span>
                </div>
                <div class='description'>
                  
                  <p>If given an integer, the dataset will contain only the first l results. If
                  given a range, it will contain only those at offsets within that range. If
                  a second argument is given, it is used as an offset. To use an offset
                  without a limit, pass nil as the first argument.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># SELECT * FROM items LIMIT 10</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>, <span class="ruby-value">20</span>) <span class="ruby-comment"># SELECT * FROM items LIMIT 10 OFFSET 20</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span><span class="ruby-operator">...</span><span class="ruby-value">20</span>) <span class="ruby-comment"># SELECT * FROM items LIMIT 10 OFFSET 10</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>) <span class="ruby-comment"># SELECT * FROM items LIMIT 11 OFFSET 10</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">limit</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-value">20</span>) <span class="ruby-comment"># SELECT * FROM items OFFSET 20</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-limit-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-limit-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 631</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">o</span> = (<span class="ruby-identifier">no_offset</span> = <span class="ruby-keyword">true</span>; <span class="ruby-keyword">nil</span>))&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-identifier">from_self</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">o</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:sql</span>]&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">l</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Range</span>)&#x000A;    <span class="ruby-identifier">no_offset</span> = <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-identifier">o</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">first</span>&#x000A;    <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">l</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">l</span>.<span class="ruby-identifier">exclude_end?</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">l</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">l</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">LiteralString</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">l</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;Limits must be greater than or equal to 1&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">l</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">1</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">clone</span>(<span class="ruby-value">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">l</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">o</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">no_offset</span>&#x000A;  <span class="ruby-identifier">ds</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-lock_style'>
                <a name='method-i-lock_style'></a>
                <div class='synopsis'>
                  <span class='name'>lock_style</span>
                  <span class='arguments'>(style)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a cloned dataset with the given lock style.  If style is a string,
                  it will be used directly. You should never pass a string to this method
                  that is derived from user input, as that can lead to <a
                  href="SQL.html">SQL</a> injection.</p>
                  
                  <p>A symbol may be used for database independent locking behavior, but all
                  supported symbols have separate methods (e.g. <a
                  href="Dataset.html#method-i-for_update">#for_update</a>).</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">lock_style</span>(<span class="ruby-string">&#39;FOR SHARE NOWAIT&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items FOR SHARE NOWAIT</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">lock_style</span>(<span class="ruby-string">&#39;FOR UPDATE OF table1 SKIP LOCKED&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items FOR UPDATE OF table1 SKIP LOCKED</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-lock_style-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-lock_style-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 661</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">lock_style</span>(<span class="ruby-identifier">style</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:lock</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">style</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-naked'>
                <a name='method-i-naked'></a>
                <div class='synopsis'>
                  <span class='name'>naked</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a cloned dataset without a row_proc.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">ds</span> = <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">with_row_proc</span>(:<span class="ruby-identifier">invert</span>.<span class="ruby-identifier">to_proc</span>)&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">all</span> <span class="ruby-comment"># =&gt; [{2=&gt;:id}]</span>&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">naked</span>.<span class="ruby-identifier">all</span> <span class="ruby-comment"># =&gt; [{:id=&gt;2}]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-naked-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-naked-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 670</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">naked</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_naked_ds</span>){<span class="ruby-identifier">with_row_proc</span>(<span class="ruby-keyword">nil</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-offset'>
                <a name='method-i-offset'></a>
                <div class='synopsis'>
                  <span class='name'>offset</span>
                  <span class='arguments'>(o)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with a specified order. Can be safely
                  combined with limit. If you call limit with an offset, it will override
                  override the offset if you&#39;ve called offset first.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">offset</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># SELECT * FROM items OFFSET 10</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-offset-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-offset-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 679</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">offset</span>(<span class="ruby-identifier">o</span>)&#x000A;  <span class="ruby-identifier">o</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">LiteralString</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;Offsets must be greater than or equal to 0&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">o</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:offset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">o</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-or'>
                <a name='method-i-or'></a>
                <div class='synopsis'>
                  <span class='name'>or</span>
                  <span class='arguments'>(*cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds an alternate filter to an existing WHERE clause using OR.  If there 
                  is no WHERE clause, then the default is WHERE true, and OR would be
                  redundant, so return the dataset in that case.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">or</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items WHERE a OR b</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">or</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-or-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-or-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 693</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">or</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:where</span>].<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-keyword">self</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">add_filter</span>(<span class="ruby-value">:where</span>, <span class="ruby-identifier">cond</span>, <span class="ruby-keyword">false</span>, <span class="ruby-value">:OR</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-order'>
                <a name='method-i-order'></a>
                <div class='synopsis'>
                  <span class='name'>order</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the order changed. If the dataset has an
                  existing order, it is ignored and overwritten with this order. If a nil is
                  given the returned dataset has no order. This can accept multiple arguments
                  of varying kinds, such as <a href="SQL.html">SQL</a> functions.  If a block
                  is given, it is treated as a virtual row block, similar to
                  <code>where</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">name</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY name</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY a, b</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">lit</span>(<span class="ruby-string">&#39;a + b&#39;</span>)) <span class="ruby-comment"># SELECT * FROM items ORDER BY a + b</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">a</span>] <span class="ruby-operator">+</span> :<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY (a + b)</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">desc</span>(:<span class="ruby-identifier">name</span>)) <span class="ruby-comment"># SELECT * FROM items ORDER BY name DESC</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">asc</span>(:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">nulls=</span><span class="ruby-operator">&gt;</span>:<span class="ruby-identifier">last</span>)) <span class="ruby-comment"># SELECT * FROM items ORDER BY name ASC NULLS LAST</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>{<span class="ruby-identifier">sum</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">desc</span>} <span class="ruby-comment"># SELECT * FROM items ORDER BY sum(name) DESC</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(<span class="ruby-keyword">nil</span>) <span class="ruby-comment"># SELECT * FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-order-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-order-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 715</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">freeze</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-order_append'>
                <a name='method-i-order_append'></a>
                <div class='synopsis'>
                  <span class='name'>order_append</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the order columns added to the end of
                  the existing order.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY b</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">order_append</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY a, b</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-order_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-order_append-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 725</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">order_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">columns</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">columns</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>]&#x000A;  <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-order_by'>
                <a name='method-i-order_by'></a>
                <div class='synopsis'>
                  <span class='name'>order_by</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of order</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-order_by-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-order_by-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 731</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">order_by</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-order_more'>
                <a name='method-i-order_more'></a>
                <div class='synopsis'>
                  <span class='name'>order_more</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of order_append.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-order_more-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-order_more-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 736</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">order_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">order_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-order_prepend'>
                <a name='method-i-order_prepend'></a>
                <div class='synopsis'>
                  <span class='name'>order_prepend</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the order columns added to the beginning
                  of the existing order.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY b</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">order_prepend</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY b, a</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-order_prepend-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-order_prepend-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 745</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">order_prepend</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">order_append</span>(<span class="ruby-operator">*</span><span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>]) <span class="ruby-operator">:</span> <span class="ruby-identifier">ds</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-qualify'>
                <a name='method-i-qualify'></a>
                <div class='synopsis'>
                  <span class='name'>qualify</span>
                  <span class='arguments'>(table=first_source)</span>
                </div>
                <div class='description'>
                  
                  <p>Qualify to the given table, or first source if no table is given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">qualify</span>&#x000A;<span class="ruby-comment"># SELECT items.* FROM items WHERE (items.id = 1)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">qualify</span>(:<span class="ruby-identifier">i</span>)&#x000A;<span class="ruby-comment"># SELECT i.* FROM items WHERE (i.id = 1)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-qualify-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-qualify-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 757</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">table</span>=<span class="ruby-identifier">first_source</span>)&#x000A;  <span class="ruby-identifier">o</span> = <span class="ruby-ivar">@opts</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:sql</span>]&#x000A;  <span class="ruby-identifier">h</span> = {}&#x000A;  (<span class="ruby-identifier">o</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">QUALIFY_KEYS</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">qualified_expression</span>(<span class="ruby-identifier">o</span>[<span class="ruby-identifier">k</span>], <span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">h</span>[<span class="ruby-value">:select</span>] = [<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnAll</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table</span>)].<span class="ruby-identifier">freeze</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>[<span class="ruby-value">:select</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:select</span>].<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">h</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-returning'>
                <a name='method-i-returning'></a>
                <div class='synopsis'>
                  <span class='name'>returning</span>
                  <span class='arguments'>(*values)</span>
                </div>
                <div class='description'>
                  
                  <p>Modify the RETURNING clause, only supported on a few databases.  If
                  returning is used, instead of insert returning the autogenerated primary
                  key or update/delete returning the number of modified rows, results are
                  returned using <code>fetch_rows</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">returning</span> <span class="ruby-comment"># RETURNING *</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">returning</span>(<span class="ruby-keyword">nil</span>) <span class="ruby-comment"># RETURNING NULL</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">returning</span>(:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>) <span class="ruby-comment"># RETURNING id, name</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-returning-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-returning-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 776</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">returning</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;RETURNING is not supported on #{db.database_type}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_returning?</span>(<span class="ruby-value">:insert</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:returning=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">values</span>.<span class="ruby-identifier">freeze</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-reverse'>
                <a name='method-i-reverse'></a>
                <div class='synopsis'>
                  <span class='name'>reverse</span>
                  <span class='arguments'>(*order, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the order reversed. If no order is
                  given, the existing order is inverted.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">reverse</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT * FROM items ORDER BY id DESC</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">reverse</span>{<span class="ruby-identifier">foo</span>(<span class="ruby-identifier">bar</span>)} <span class="ruby-comment"># SELECT * FROM items ORDER BY foo(bar) DESC</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">reverse</span> <span class="ruby-comment"># SELECT * FROM items ORDER BY id DESC</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">reverse</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">desc</span>(:<span class="ruby-identifier">name</span>)) <span class="ruby-comment"># SELECT * FROM items ORDER BY name ASC</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-reverse-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-reverse-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 788</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">reverse</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">order</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_reverse_ds</span>){<span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">invert_order</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>]))}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">order</span>, <span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">invert_order</span>(<span class="ruby-identifier">order</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">order</span>.<span class="ruby-identifier">freeze</span>))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-reverse_order'>
                <a name='method-i-reverse_order'></a>
                <div class='synopsis'>
                  <span class='name'>reverse_order</span>
                  <span class='arguments'>(*order, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of <code>reverse</code></p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-reverse_order-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-reverse_order-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 798</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">reverse_order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">reverse</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select'>
                <a name='method-i-select'></a>
                <div class='synopsis'>
                  <span class='name'>select</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the columns selected changed to the
                  given columns. This also takes a virtual row block, similar to
                  <code>where</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">a</span>) <span class="ruby-comment"># SELECT a FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT a, b FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select</span>{[<span class="ruby-identifier">a</span>, <span class="ruby-identifier">sum</span>(<span class="ruby-identifier">b</span>)]} <span class="ruby-comment"># SELECT a, sum(b) FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 809</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">freeze</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_all'>
                <a name='method-i-select_all'></a>
                <div class='synopsis'>
                  <span class='name'>select_all</span>
                  <span class='arguments'>(*tables)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset selecting the wildcard if no arguments are
                  given.  If arguments are given, treat them as tables and select all columns
                  (using the wildcard) from each table.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">select_all</span> <span class="ruby-comment"># SELECT * FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select_all</span>(:<span class="ruby-identifier">items</span>) <span class="ruby-comment"># SELECT items.* FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select_all</span>(:<span class="ruby-identifier">items</span>, :<span class="ruby-identifier">foo</span>) <span class="ruby-comment"># SELECT items.*, foo.* FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_all-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_all-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 821</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_all</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">tables</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">tables</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">clone</span>(<span class="ruby-value">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">tables</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>, <span class="ruby-identifier">a</span> = <span class="ruby-identifier">split_alias</span>(<span class="ruby-identifier">t</span>); <span class="ruby-identifier">a</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">i</span>}.<span class="ruby-identifier">map!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnAll</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">t</span>)}.<span class="ruby-identifier">freeze</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_append'>
                <a name='method-i-select_append'></a>
                <div class='synopsis'>
                  <span class='name'>select_append</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the given columns added to the existing
                  selected columns.  If no columns are currently selected, it will select the
                  columns given in addition to *.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT b FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">select_append</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT a, b FROM items</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select_append</span>(:<span class="ruby-identifier">b</span>) <span class="ruby-comment"># SELECT *, b FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_append-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 836</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">cur_sel</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:select</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">cur_sel</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cur_sel</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_select_all_and_column?</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-identifier">select_all</span>(<span class="ruby-operator">*</span>(<span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:from</span>]) <span class="ruby-operator">+</span> <span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:join</span>]))).<span class="ruby-identifier">select_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">cur_sel</span> = [<span class="ruby-constant">WILDCARD</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span>(<span class="ruby-identifier">cur_sel</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">columns</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_group'>
                <a name='method-i-select_group'></a>
                <div class='synopsis'>
                  <span class='name'>select_group</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Set both the select and group clauses with the given <code>columns</code>.
                  Column aliases may be supplied, and will be included in the select clause.
                  This also takes a virtual row block similar to <code>where</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select_group</span>(:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>)&#x000A;<span class="ruby-comment"># SELECT a, b FROM items GROUP BY a, b</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">select_group</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">c</span>].<span class="ruby-identifier">as</span>(:<span class="ruby-identifier">a</span>)){<span class="ruby-identifier">f</span>(<span class="ruby-identifier">c2</span>)}&#x000A;<span class="ruby-comment"># SELECT c AS a, f(c2) FROM items GROUP BY c, f(c2)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_group-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_group-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 856</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">virtual_row_columns</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>).<span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">unaliased_identifier</span>(<span class="ruby-identifier">c</span>)})&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_more'>
                <a name='method-i-select_more'></a>
                <div class='synopsis'>
                  <span class='name'>select_more</span>
                  <span class='arguments'>(*columns, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias for select_append.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_more-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_more-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 862</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">select_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-server'>
                <a name='method-i-server'></a>
                <div class='synopsis'>
                  <span class='name'>server</span>
                  <span class='arguments'>(servr)</span>
                </div>
                <div class='description'>
                  
                  <p>Set the server for this dataset to use.  Used to pick a specific database
                  shard to run a query against, or to override the default (where SELECT uses
                  :read_only database and all other queries use the :default database).  This
                  method is always available but is only useful when database sharding is
                  being used.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">all</span> <span class="ruby-comment"># Uses the :read_only or :default server </span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">delete</span> <span class="ruby-comment"># Uses the :default server</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">server</span>(:<span class="ruby-identifier">blah</span>).<span class="ruby-identifier">delete</span> <span class="ruby-comment"># Uses the :blah server</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-server-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-server-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 875</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">server</span>(<span class="ruby-identifier">servr</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:server=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">servr</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-server-3F'>
                <a name='method-i-server-3F'></a>
                <div class='synopsis'>
                  <span class='name'>server?</span>
                  <span class='arguments'>(server)</span>
                </div>
                <div class='description'>
                  
                  <p>If the database uses sharding and the current dataset has not had a server
                  set, return a cloned dataset that uses the given server. Otherwise, return
                  the receiver directly instead of returning a clone.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-server-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-server-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 882</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">server?</span>(<span class="ruby-identifier">server</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">sharded?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]&#x000A;    <span class="ruby-identifier">server</span>(<span class="ruby-identifier">server</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">self</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-skip_limit_check'>
                <a name='method-i-skip_limit_check'></a>
                <div class='synopsis'>
                  <span class='name'>skip_limit_check</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Specify that the check for limits/offsets when updating/deleting be skipped
                  for the dataset.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-skip_limit_check-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-skip_limit_check-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 891</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_limit_check</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_skip_limit_check_ds</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">clone</span>(<span class="ruby-value">:skip_limit_check=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-skip_locked'>
                <a name='method-i-skip_locked'></a>
                <div class='synopsis'>
                  <span class='name'>skip_locked</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Skip locked rows when returning results from this dataset.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-skip_locked-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-skip_locked-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 898</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_locked</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_skip_locked_ds</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;This dataset does not support skipping locked rows&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_skip_locked?</span>&#x000A;    <span class="ruby-identifier">clone</span>(<span class="ruby-value">:skip_locked=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-unfiltered'>
                <a name='method-i-unfiltered'></a>
                <div class='synopsis'>
                  <span class='name'>unfiltered</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with no filters (HAVING or WHERE clause)
                  applied.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">having</span>(<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">b</span>).<span class="ruby-identifier">unfiltered</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items GROUP BY a</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-unfiltered-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-unfiltered-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 909</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">unfiltered</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_unfiltered_ds</span>){<span class="ruby-identifier">clone</span>(<span class="ruby-value">:where</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:having</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-ungrouped'>
                <a name='method-i-ungrouped'></a>
                <div class='synopsis'>
                  <span class='name'>ungrouped</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with no grouping (GROUP or HAVING clause)
                  applied.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">group</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">having</span>(<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">b</span>).<span class="ruby-identifier">ungrouped</span>&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE b</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-ungrouped-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-ungrouped-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 917</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">ungrouped</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_ungrouped_ds</span>){<span class="ruby-identifier">clone</span>(<span class="ruby-value">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:having</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-union'>
                <a name='method-i-union'></a>
                <div class='synopsis'>
                  <span class='name'>union</span>
                  <span class='arguments'>(dataset, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds a UNION clause using a second dataset object. A UNION compound dataset
                  returns all rows in either the current dataset or the given dataset.
                  Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:alias </td><td>
                  <p>Use the given value as the <a
                  href="Dataset.html#method-i-from_self">#from_self</a> alias</p>
                  </td></tr><tr><td class='label'>:all </td><td>
                  <p>Set to true to use UNION ALL instead of UNION, so duplicate rows can occur</p>
                  </td></tr><tr><td class='label'>:from_self </td><td>
                  <p>Set to false to not wrap the returned dataset in a <a
                  href="Dataset.html#method-i-from_self">#from_self</a>, use with care.</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">union</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>])&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT * FROM items UNION SELECT * FROM other_items) AS t1</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">union</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>], <span class="ruby-identifier">all</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">from_self</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items UNION ALL SELECT * FROM other_items</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">union</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">other_items</span>], <span class="ruby-keyword">alias</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">i</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM (SELECT * FROM items UNION SELECT * FROM other_items) AS i</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-union-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-union-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 937</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">union</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">compound_clone</span>(<span class="ruby-value">:union</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-unlimited'>
                <a name='method-i-unlimited'></a>
                <div class='synopsis'>
                  <span class='name'>unlimited</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with no limit or offset.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>, <span class="ruby-value">20</span>).<span class="ruby-identifier">unlimited</span> <span class="ruby-comment"># SELECT * FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-unlimited-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-unlimited-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 944</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">unlimited</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_unlimited_ds</span>){<span class="ruby-identifier">clone</span>(<span class="ruby-value">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>, <span class="ruby-value">:offset=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-unordered'>
                <a name='method-i-unordered'></a>
                <div class='synopsis'>
                  <span class='name'>unordered</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with no order.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">unordered</span> <span class="ruby-comment"># SELECT * FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-unordered-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-unordered-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 951</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">unordered</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_unordered_ds</span>){<span class="ruby-identifier">clone</span>(<span class="ruby-value">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-where'>
                <a name='method-i-where'></a>
                <div class='synopsis'>
                  <span class='name'>where</span>
                  <span class='arguments'>(*cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the given WHERE conditions imposed upon
                  it.</p>
                  
                  <p>Accepts the following argument types:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>Hash, Array of pairs </td><td>
                  <p>list of equality/inclusion expressions</p>
                  </td></tr><tr><td class='label'>Symbol </td><td>
                  <p>taken as a boolean column argument (e.g. WHERE active)</p>
                  </td></tr><tr><td class='label'><a href="SQL/BooleanExpression.html">Sequel::SQL::BooleanExpression</a>, <a href="LiteralString.html">Sequel::LiteralString</a> </td><td>
                  <p>an existing condition expression, probably created using the <a
                  href="../Sequel.html">Sequel</a> expression filter DSL.</p>
                  </td></tr></tbody></table>
                  
                  <p>where also accepts a block, which should return one of the above argument
                  types, and is treated the same way.  This block yields a virtual row
                  object, which is easy to use to create identifiers and functions.  For more
                  details on the virtual row support, see the <a
                  href="../../files/doc/virtual_rows_rdoc.html">“Virtual Rows” guide</a></p>
                  
                  <p>If both a block and regular argument are provided, they get ANDed together.</p>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (id = 3)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">lit</span>(<span class="ruby-string">&#39;price &lt; ?&#39;</span>, <span class="ruby-value">100</span>))&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE price &lt; 100</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>([[:<span class="ruby-identifier">id</span>, [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>]], [:<span class="ruby-identifier">id</span>, <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>]])&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE ((id IN (1, 2, 3)) AND ((id &gt;= 0) AND (id &lt;= 10)))</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">lit</span>(<span class="ruby-string">&#39;price &lt; 100&#39;</span>))&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE price &lt; 100</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">active</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE :active</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">where</span>{<span class="ruby-identifier">price</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">100</span>}&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE (price &lt; 100)</span></pre>
                  
                  <p>Multiple where calls can be chained for scoping:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">software</span> = <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>).<span class="ruby-identifier">where</span>{<span class="ruby-identifier">price</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">100</span>}&#x000A;<span class="ruby-comment"># SELECT * FROM items WHERE ((category = &#39;software&#39;) AND (price &lt; 100))</span></pre>
                  
                  <p>See the <a href="../../files/doc/dataset_filtering_rdoc.html">“Dataset
                  Filtering” guide</a> for more examples and details.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-where-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-where-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 997</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">where</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">add_filter</span>(<span class="ruby-value">:where</span>, <span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with'>
                <a name='method-i-with'></a>
                <div class='synopsis'>
                  <span class='name'>with</span>
                  <span class='arguments'>(name, dataset, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Add a common table expression (CTE) with the given name and a dataset that
                  defines the CTE. A common table expression acts as an inline view for the
                  query. Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:args </td><td>
                  <p>Specify the arguments/columns for the CTE, should be an array of symbols.</p>
                  </td></tr><tr><td class='label'>:recursive </td><td>
                  <p>Specify that this is a recursive CTE</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">with</span>(:<span class="ruby-identifier">items</span>, <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">syx</span>].<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">name</span>].<span class="ruby-identifier">like</span>(<span class="ruby-string">&#39;A%&#39;</span>)))&#x000A;<span class="ruby-comment"># WITH items AS (SELECT * FROM syx WHERE (name LIKE &#39;A%&#39; ESCAPE &#39;\&#39;)) SELECT * FROM items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1009</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;This dataset does not support common table expressions&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_cte?</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hoist_cte?</span>(<span class="ruby-identifier">dataset</span>)&#x000A;    <span class="ruby-identifier">s</span>, <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">hoist_cte</span>(<span class="ruby-identifier">dataset</span>)&#x000A;    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">with</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">clone</span>(<span class="ruby-value">:with=</span><span class="ruby-operator">&gt;</span>((<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:with</span>]<span class="ruby-operator">||</span><span class="ruby-constant">EMPTY_ARRAY</span>) <span class="ruby-operator">+</span> [<span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:name=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">name</span>, <span class="ruby-value">:dataset=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">dataset</span>)]).<span class="ruby-identifier">freeze</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_extend'>
                <a name='method-i-with_extend'></a>
                <div class='synopsis'>
                  <span class='name'>with_extend</span>
                  <span class='arguments'>(*mods, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a clone of the dataset extended with the given modules. Note that
                  like Object#extend, when multiple modules are provided as arguments the
                  cloned dataset is extended with the modules in reverse order.  If a block
                  is provided, a <a href="Dataset/DatasetModule.html">DatasetModule</a> is
                  created using the block and the clone is extended with that module after
                  any modules given as arguments.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_extend-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_extend-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1054</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_extend</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">mods</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_clone</span>(<span class="ruby-value">:freeze=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">false</span>)&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">mods</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">mods</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">DatasetModule</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-identifier">c</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_recursive'>
                <a name='method-i-with_recursive'></a>
                <div class='synopsis'>
                  <span class='name'>with_recursive</span>
                  <span class='arguments'>(name, nonrecursive, recursive, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Add a recursive common table expression (CTE) with the given name, a
                  dataset that defines the nonrecursive part of the CTE, and a dataset that
                  defines the recursive part of the CTE.  Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:args </td><td>
                  <p>Specify the arguments/columns for the CTE, should be an array of symbols.</p>
                  </td></tr><tr><td class='label'>:union_all </td><td>
                  <p>Set to false to use UNION instead of UNION ALL combining the nonrecursive
                  and recursive parts.</p>
                  </td></tr></tbody></table>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">t</span>].<span class="ruby-identifier">with_recursive</span>(:<span class="ruby-identifier">t</span>,&#x000A;  <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">i1</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">parent_id</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">parent_id</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>),&#x000A;  <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">i1</span>].<span class="ruby-identifier">join</span>(:<span class="ruby-identifier">t</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">parent_id</span>).<span class="ruby-identifier">select</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">i1</span>][:<span class="ruby-identifier">id</span>], <span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">i1</span>][:<span class="ruby-identifier">parent_id</span>]),&#x000A;  :<span class="ruby-identifier">args=</span><span class="ruby-operator">&gt;</span>[:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">parent_id</span>])&#x000A;&#x000A;<span class="ruby-comment"># WITH RECURSIVE t(id, parent_id) AS (</span>&#x000A;<span class="ruby-comment">#   SELECT id, parent_id FROM i1 WHERE (parent_id IS NULL)</span>&#x000A;<span class="ruby-comment">#   UNION ALL</span>&#x000A;<span class="ruby-comment">#   SELECT i1.id, i1.parent_id FROM i1 INNER JOIN t ON (t.id = i1.parent_id)</span>&#x000A;<span class="ruby-comment"># ) SELECT * FROM t</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_recursive-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_recursive-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1035</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_recursive</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">nonrecursive</span>, <span class="ruby-identifier">recursive</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;This datatset does not support common table expressions&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_cte?</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hoist_cte?</span>(<span class="ruby-identifier">nonrecursive</span>)&#x000A;    <span class="ruby-identifier">s</span>, <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">hoist_cte</span>(<span class="ruby-identifier">nonrecursive</span>)&#x000A;    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">with_recursive</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">recursive</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">hoist_cte?</span>(<span class="ruby-identifier">recursive</span>)&#x000A;    <span class="ruby-identifier">s</span>, <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">hoist_cte</span>(<span class="ruby-identifier">recursive</span>)&#x000A;    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">with_recursive</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">nonrecursive</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">clone</span>(<span class="ruby-value">:with=</span><span class="ruby-operator">&gt;</span>((<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:with</span>]<span class="ruby-operator">||</span><span class="ruby-constant">EMPTY_ARRAY</span>) <span class="ruby-operator">+</span> [<span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:recursive=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>, <span class="ruby-value">:name=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">name</span>, <span class="ruby-value">:dataset=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">nonrecursive</span>.<span class="ruby-identifier">union</span>(<span class="ruby-identifier">recursive</span>, {<span class="ruby-value">:all=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-value">:union_all</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">:from_self=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">false</span>}))]).<span class="ruby-identifier">freeze</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_row_proc'>
                <a name='method-i-with_row_proc'></a>
                <div class='synopsis'>
                  <span class='name'>with_row_proc</span>
                  <span class='arguments'>(callable)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a cloned dataset with the given row_proc.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">ds</span> = <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>]&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">all</span> <span class="ruby-comment"># =&gt; [{:id=&gt;2}]</span>&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">with_row_proc</span>(:<span class="ruby-identifier">invert</span>.<span class="ruby-identifier">to_proc</span>).<span class="ruby-identifier">all</span> <span class="ruby-comment"># =&gt; [{2=&gt;:id}]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_row_proc-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_row_proc-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1077</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_row_proc</span>(<span class="ruby-identifier">callable</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:row_proc=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">callable</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql'>
                <a name='method-i-with_sql'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql</span>
                  <span class='arguments'>(sql, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a copy of the dataset with the static <a href="SQL.html">SQL</a>
                  used.  This is useful if you want to keep the same row_proc/graph, but
                  change the <a href="SQL.html">SQL</a> used to custom <a
                  href="SQL.html">SQL</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">with_sql</span>(<span class="ruby-string">&#39;SELECT * FROM foo&#39;</span>) <span class="ruby-comment"># SELECT * FROM foo</span></pre>
                  
                  <p>You can use placeholders in your <a href="SQL.html">SQL</a> and provide
                  arguments for those placeholders:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">with_sql</span>(<span class="ruby-string">&#39;SELECT ? FROM foo&#39;</span>, <span class="ruby-value">1</span>) <span class="ruby-comment"># SELECT 1 FROM foo</span></pre>
                  
                  <p>You can also provide a method name and arguments to call to get the SQL:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">with_sql</span>(:<span class="ruby-identifier">insert_sql</span>, :<span class="ruby-identifier">b=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>) <span class="ruby-comment"># INSERT INTO items (b) VALUES (1)</span></pre>
                  
                  <p>Note that datasets that specify custom <a href="SQL.html">SQL</a> using
                  this method will generally ignore future dataset methods that modify the <a
                  href="SQL.html">SQL</a> used, as specifying custom <a
                  href="SQL.html">SQL</a> overrides Sequel&#39;s <a href="SQL.html">SQL</a>
                  generator.  You should probably limit yourself to the following dataset
                  methods when using this method, or use the implicit_subquery extension:</p>
                  <ul><li>
                  <p>each</p>
                  </li><li>
                  <p>all</p>
                  </li><li>
                  <p><a href="Dataset.html#method-i-single_record">#single_record</a> (if only
                  one record could be returned)</p>
                  </li><li>
                  <p><a href="Dataset.html#method-i-single_value">#single_value</a> (if only one
                  record could be returned, and a single column is selected)</p>
                  </li><li>
                  <p>map</p>
                  </li><li>
                  <p><a href="Dataset.html#method-i-as_hash">#as_hash</a></p>
                  </li><li>
                  <p><a href="Dataset.html#method-i-to_hash">#to_hash</a></p>
                  </li><li>
                  <p><a href="Dataset.html#method-i-to_hash_groups">#to_hash_groups</a></p>
                  </li><li>
                  <p>delete (if a DELETE statement)</p>
                  </li><li>
                  <p>update (if an UPDATE statement, with no arguments)</p>
                  </li><li>
                  <p>insert (if an INSERT statement, with no arguments)</p>
                  </li><li>
                  <p>truncate (if a TRUNCATE statement, with no arguments)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1111</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sql</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)&#x000A;    <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">sql</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">PlaceholderLiteralString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:sql=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Protected Instance methods</h2>
              <div class='method protected-instance' id='method-method-i-compound_clone'>
                <a name='method-i-compound_clone'></a>
                <div class='synopsis'>
                  <span class='name'>compound_clone</span>
                  <span class='arguments'>(type, dataset, opts)</span>
                </div>
                <div class='description'>
                  
                  <p>Add the dataset to the list of compounds</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-compound_clone-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-compound_clone-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1123</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">compound_clone</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hoist_cte?</span>(<span class="ruby-identifier">dataset</span>)&#x000A;    <span class="ruby-identifier">s</span>, <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">hoist_cte</span>(<span class="ruby-identifier">dataset</span>)&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">compound_clone</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">compound_from_self</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-value">:compounds=</span><span class="ruby-operator">&gt;</span>(<span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:compounds</span>]).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:dup</span>) <span class="ruby-operator">+</span> [[<span class="ruby-identifier">type</span>, <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">compound_from_self</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:all</span>]].<span class="ruby-identifier">freeze</span>]).<span class="ruby-identifier">freeze</span>)&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:from_self</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">ds</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">from_self</span>(<span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-options_overlap'>
                <a name='method-i-options_overlap'></a>
                <div class='synopsis'>
                  <span class='name'>options_overlap</span>
                  <span class='arguments'>(opts)</span>
                </div>
                <div class='description'>
                  
                  <p>Return true if the dataset has a non-nil value for any key in opts.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-options_overlap-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-options_overlap-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1133</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">options_overlap</span>(<span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-operator">!</span>(<span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>}.<span class="ruby-identifier">compact</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">opts</span>).<span class="ruby-identifier">empty?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-simple_select_all-3F'>
                <a name='method-i-simple_select_all-3F'></a>
                <div class='synopsis'>
                  <span class='name'>simple_select_all?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether this dataset is a simple select from an underlying table, such as:</p>
                  
                  <pre>SELECT * FROM table&#x000A;SELECT table.* FROM table</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-simple_select_all-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-simple_select_all-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/query.rb, line 1144</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">simple_select_all?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">f</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:from</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;  <span class="ruby-identifier">o</span> = <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">non_sql_option?</span>(<span class="ruby-identifier">k</span>)}&#x000A;  <span class="ruby-identifier">from</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">first</span>&#x000A;  <span class="ruby-identifier">from</span> = <span class="ruby-identifier">from</span>.<span class="ruby-identifier">expression</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">from</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>)&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-constant">SIMPLE_SELECT_ALL_ALLOWED_FROM</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">from</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">x</span>)}&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">length</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">1</span>&#x000A;      <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">2</span>&#x000A;      (<span class="ruby-identifier">s</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:select</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnAll</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='2+-+Methods+that+execute+code+on+the+database'>2 - Methods that execute code on the database</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>ACTION_METHODS</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      (<<-METHS).split.map(&:to_sym).freeze
                      << [] all as_hash avg count columns columns! delete each
                      empty? fetch_rows first first! get import insert last
                      map max min multi_insert paged_each select_hash select_hash_groups select_map select_order_map
                      single_record single_record! single_value single_value! sum to_hash to_hash_groups truncate update
                      where_all where_each where_single_value
                      METHS
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Action methods defined by <a href="../Sequel.html">Sequel</a> that execute
                      code on the database.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COLUMNS_CLONE_OPTIONS</td>
                    <td>=</td>
                    <td class='context-item-value'>{:distinct => nil, :limit => 1, :offset=>nil, :where=>nil, :having=>nil, :order=>nil, :row_proc=>nil, :graph=>nil, :eager_graph=>nil}.freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The clone options to use when retriveing columns for a dataset.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COUNT_SELECT</td>
                    <td>=</td>
                    <td class='context-item-value'>Sequel.function(:count).*.as(:count)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>EMPTY_SELECT</td>
                    <td>=</td>
                    <td class='context-item-value'>Sequel::SQL::AliasedExpression.new(1, :one)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='aliases-list'>
              <h2>Public Instance Aliases</h2>
              <div class='name-list'>
                <table summary='Public Instance Aliases'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>with_sql_update</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'><a href="#method-i-with_sql_delete">with_sql_delete</a></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-3C-3C'>
                <a name='method-i-3C-3C'></a>
                <div class='synopsis'>
                  <span class='name'><<</span>
                  <span class='arguments'>(arg)</span>
                </div>
                <div class='description'>
                  
                  <p>Inserts the given argument into the database.  Returns self so it can be
                  used safely when chaining:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>] <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Zero&#39;</span>} <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">old_items</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">id</span>, <span class="ruby-identifier">name</span>)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-3C-3C-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-3C-3C-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 27</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-identifier">arg</span>)&#x000A;  <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">arg</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-5B-5D'>
                <a name='method-i-5B-5D'></a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(*conditions)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the first record matching the conditions. Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>][<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>] <span class="ruby-comment"># SELECT * FROM table WHERE (id = 1) LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;1}</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-5B-5D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-5B-5D-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 36</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">conditions</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;You cannot call Dataset#[] with an integer or with no arguments&#39;</span>) <span class="ruby-keyword">if</span> (<span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)) <span class="ruby-keyword">or</span> <span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;  <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">conditions</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-all'>
                <a name='method-i-all'></a>
                <div class='synopsis'>
                  <span class='name'>all</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns an array with all records in the dataset. If a block is given, the
                  array is iterated over after all items have been loaded.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">all</span> <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [{:id=&gt;1, ...}, {:id=&gt;2, ...}, ...]</span>&#x000A;&#x000A;<span class="ruby-comment"># Iterate over all rows in the table</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">all</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">row</span>}</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-all-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-all-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 49</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">all</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">_all</span>(<span class="ruby-identifier">block</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>}}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-as_hash'>
                <a name='method-i-as_hash'></a>
                <div class='synopsis'>
                  <span class='name'>as_hash</span>
                  <span class='arguments'>(key_column, value_column = nil, opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a hash with one column used as key and another used as value. If
                  rows have duplicate values for the key column, the latter row(s) will
                  overwrite the value of the previous row(s). If the value_column is not
                  given or nil, uses the entire hash as the value.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">as_hash</span>(:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {1=&gt;&#39;Jim&#39;, 2=&gt;&#39;Bob&#39;, ...}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">as_hash</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {1=&gt;{:id=&gt;1, :name=&gt;&#39;Jim&#39;}, 2=&gt;{:id=&gt;2, :name=&gt;&#39;Bob&#39;}, ...}</span></pre>
                  
                  <p>You can also provide an array of column names for either the key_column,
                  the value column, or both:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">as_hash</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">foo</span>], [:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">bar</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {[1, 3]=&gt;[&#39;Jim&#39;, &#39;bo&#39;], [2, 4]=&gt;[&#39;Bob&#39;, &#39;be&#39;], ...}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">as_hash</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {[1, &#39;Jim&#39;]=&gt;{:id=&gt;1, :name=&gt;&#39;Jim&#39;}, [2, &#39;Bob&#39;]=&gt;{:id=&gt;2, :name=&gt;&#39;Bob&#39;}, ...}</span></pre>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:all </td><td>
                  <p>Use all instead of each to retrieve the objects</p>
                  </td></tr><tr><td class='label'>:hash </td><td>
                  <p>The object into which the values will be placed.  If this is not given, an
                  empty hash is used.  This can be used to use a hash with a default value or
                  default proc.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-as_hash-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-as_hash-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 763</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">as_hash</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">h</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:hash</span>] <span class="ruby-operator">||</span> {}&#x000A;  <span class="ruby-identifier">meth</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:all</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:all</span> <span class="ruby-operator">:</span> <span class="ruby-value">:each</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">value_column</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">naked</span>.<span class="ruby-identifier">as_hash</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">row_proc</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">key_column</span>)] = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">value_column</span>)}&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">value_column</span>)}&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">key_column</span>)] = <span class="ruby-identifier">r</span>[<span class="ruby-identifier">value_column</span>]}&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] = <span class="ruby-identifier">r</span>[<span class="ruby-identifier">value_column</span>]}&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;    <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">k</span>]}] = <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] = <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">h</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-avg'>
                <a name='method-i-avg'></a>
                <div class='synopsis'>
                  <span class='name'>avg</span>
                  <span class='arguments'>(arg=Sequel.virtual_row(&Proc.new))</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the average value for the given column/expression. Uses a virtual
                  row block if no argument is given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">avg</span>(:<span class="ruby-identifier">number</span>) <span class="ruby-comment"># SELECT avg(number) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 3</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">avg</span>{<span class="ruby-identifier">function</span>(<span class="ruby-identifier">column</span>)} <span class="ruby-comment"># SELECT avg(function(column)) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 1</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-avg-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-avg-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 60</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">avg</span>(<span class="ruby-identifier">arg</span>=<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>(<span class="ruby-operator">&amp;</span><span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>))&#x000A;  <span class="ruby-identifier">_aggregate</span>(<span class="ruby-value">:avg</span>, <span class="ruby-identifier">arg</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-columns'>
                <a name='method-i-columns'></a>
                <div class='synopsis'>
                  <span class='name'>columns</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the columns in the result set in order as an array of symbols. If
                  the columns are currently cached, returns the cached value. Otherwise, a
                  SELECT query is performed to retrieve a single row in order to get the
                  columns.</p>
                  
                  <p>If you are looking for all columns for a single table and maybe some
                  information about each column (e.g. database type), see
                  <code>Database#schema</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">columns</span>&#x000A;<span class="ruby-comment"># =&gt; [:id, :name]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-columns-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-columns-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 73</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">columns</span>&#x000A;  <span class="ruby-identifier">_columns</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">columns!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-columns-21'>
                <a name='method-i-columns-21'></a>
                <div class='synopsis'>
                  <span class='name'>columns!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Ignore any cached column information and perform a query to retrieve a row
                  in order to get the columns.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">columns!</span>&#x000A;<span class="ruby-comment"># =&gt; [:id, :name]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-columns-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-columns-21-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 82</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">columns!</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">clone</span>(<span class="ruby-constant">COLUMNS_CLONE_OPTIONS</span>)&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">each</span>{<span class="ruby-keyword">break</span>}&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">cache</span>[<span class="ruby-value">:_columns</span>]&#x000A;    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">columns</span> = <span class="ruby-identifier">cols</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    []&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-count'>
                <a name='method-i-count'></a>
                <div class='synopsis'>
                  <span class='name'>count</span>
                  <span class='arguments'>(arg=(no_arg=true), &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the number of records in the dataset. If an argument is provided,
                  it is used as the argument to count.  If a block is provided, it is treated
                  as a virtual row, and the result is used as the argument to count.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">count</span> <span class="ruby-comment"># SELECT count(*) AS count FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 3</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">count</span>(:<span class="ruby-identifier">column</span>) <span class="ruby-comment"># SELECT count(column) AS count FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 2</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">count</span>{<span class="ruby-identifier">foo</span>(<span class="ruby-identifier">column</span>)} <span class="ruby-comment"># SELECT count(foo(column)) AS count FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 1</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-count-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-count-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 106</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>(<span class="ruby-identifier">arg</span>=(<span class="ruby-identifier">no_arg</span>=<span class="ruby-keyword">true</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">no_arg</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_count_ds</span>) <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-identifier">aggregate_dataset</span>.<span class="ruby-identifier">select</span>(<span class="ruby-constant">COUNT_SELECT</span>).<span class="ruby-identifier">single_value_ds</span>&#x000A;    <span class="ruby-keyword">end</span>.<span class="ruby-identifier">single_value!</span>.<span class="ruby-identifier">to_i</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">no_arg</span>&#x000A;        <span class="ruby-identifier">arg</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;cannot provide both argument and block to Dataset#count&#39;</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">_aggregate</span>(<span class="ruby-value">:count</span>, <span class="ruby-identifier">arg</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-delete'>
                <a name='method-i-delete'></a>
                <div class='synopsis'>
                  <span class='name'>delete</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Deletes the records in the dataset, returning the number of records
                  deleted.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">delete</span> <span class="ruby-comment"># DELETE * FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; 3</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-delete-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-delete-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 128</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">delete_sql</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uses_returning?</span>(<span class="ruby-value">:delete</span>)&#x000A;    <span class="ruby-identifier">returning_fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-each'>
                <a name='method-i-each'></a>
                <div class='synopsis'>
                  <span class='name'>each</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Iterates over the records in the dataset as they are yielded from the
                  database adapter, and returns self.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">row</span>} <span class="ruby-comment"># SELECT * FROM table</span></pre>
                  
                  <p>Note that this method is not safe to use on many adapters if you are
                  running additional queries inside the provided block.  If you are running
                  queries inside the block, you should use <code>all</code> instead of
                  <code>each</code> for the outer queries, or use a separate thread or shard
                  inside <code>each</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-each-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-each-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 146</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rp</span> = <span class="ruby-identifier">row_proc</span>&#x000A;    <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">select_sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rp</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>)}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">select_sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-empty-3F'>
                <a name='method-i-empty-3F'></a>
                <div class='synopsis'>
                  <span class='name'>empty?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if no records exist in the dataset, false otherwise</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">empty?</span> <span class="ruby-comment"># SELECT 1 AS one FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; false</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-empty-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-empty-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 161</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">cached_dataset</span>(<span class="ruby-value">:_empty_ds</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">single_value_ds</span>.<span class="ruby-identifier">unordered</span>.<span class="ruby-identifier">select</span>(<span class="ruby-constant">EMPTY_SELECT</span>)&#x000A;  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">single_value!</span>.<span class="ruby-identifier">nil?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-first'>
                <a name='method-i-first'></a>
                <div class='synopsis'>
                  <span class='name'>first</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the first matching record if no arguments are given. If a integer
                  argument is given, it is interpreted as a limit, and then returns all 
                  matching records up to that limit.  If any other type of argument(s) is
                  passed, it is treated as a filter and the first matching record is
                  returned.  If a block is given, it is used to filter the dataset before
                  returning anything.</p>
                  
                  <p>If there are no records in the dataset, returns nil (or an empty array if
                  an integer argument is given).</p>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span> <span class="ruby-comment"># SELECT * FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;7}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># SELECT * FROM table LIMIT 2</span>&#x000A;<span class="ruby-comment"># =&gt; [{:id=&gt;6}, {:id=&gt;4}]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>) <span class="ruby-comment"># SELECT * FROM table WHERE (id = 2) LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;2}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">lit</span>(<span class="ruby-string">&quot;id = 3&quot;</span>)) <span class="ruby-comment"># SELECT * FROM table WHERE (id = 3) LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;3}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">lit</span>(<span class="ruby-string">&quot;id = ?&quot;</span>, <span class="ruby-value">4</span>)) <span class="ruby-comment"># SELECT * FROM table WHERE (id = 4) LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;4}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>{<span class="ruby-identifier">id</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>} <span class="ruby-comment"># SELECT * FROM table WHERE (id &gt; 2) LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;5}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">lit</span>(<span class="ruby-string">&quot;id &gt; ?&quot;</span>, <span class="ruby-value">4</span>)){<span class="ruby-identifier">id</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">6</span>} <span class="ruby-comment"># SELECT * FROM table WHERE ((id &gt; 4) AND (id &lt; 6)) LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;5}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first</span>(<span class="ruby-value">2</span>){<span class="ruby-identifier">id</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>} <span class="ruby-comment"># SELECT * FROM table WHERE (id &lt; 2) LIMIT 2</span>&#x000A;<span class="ruby-comment"># =&gt; [{:id=&gt;1}]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-first-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-first-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 202</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">0</span>&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-identifier">single_record</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-identifier">arg</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)&#x000A;      <span class="ruby-identifier">res</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">cached_placeholder_literalizer</span>(<span class="ruby-value">:_first_integer_cond_loader</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pl</span><span class="ruby-operator">|</span>&#x000A;            <span class="ruby-identifier">where</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>)&#x000A;          <span class="ruby-keyword">end</span>&#x000A;&#x000A;          <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">all</span>(<span class="ruby-identifier">filter_expr</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>), <span class="ruby-identifier">arg</span>)&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-identifier">where</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">arg</span>).<span class="ruby-identifier">all</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">cached_placeholder_literalizer</span>(<span class="ruby-value">:_first_integer_loader</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pl</span><span class="ruby-operator">|</span>&#x000A;           <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>)&#x000A;          <span class="ruby-keyword">end</span>&#x000A;&#x000A;          <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">all</span>(<span class="ruby-identifier">arg</span>)&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">arg</span>).<span class="ruby-identifier">all</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-identifier">res</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">args</span> = <span class="ruby-identifier">arg</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">cached_placeholder_literalizer</span>(<span class="ruby-value">:_first_cond_loader</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pl</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">_single_record_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>))&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">_single_record_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">single_record!</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-first-21'>
                <a name='method-i-first-21'></a>
                <div class='synopsis'>
                  <span class='name'>first!</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Calls first.  If first returns nil (signaling that no row matches), raise a
                  <a href="NoMatchingRow.html">Sequel::NoMatchingRow</a> exception.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-first-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-first-21-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 248</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">first!</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">NoMatchingRow</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-get'>
                <a name='method-i-get'></a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(column=(no_arg=true; nil), &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Return the column value for the first matching record in the dataset.
                  Raises an error if both an argument and block is given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">get</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT id FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 3</span>&#x000A;&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>{<span class="ruby-identifier">sum</span>(<span class="ruby-identifier">id</span>)} <span class="ruby-comment"># SELECT sum(id) AS v FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 6</span></pre>
                  
                  <p>You can pass an array of arguments to return multiple arguments, but you
                  must make sure each element in the array has an alias that <a
                  href="../Sequel.html">Sequel</a> can determine:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">get</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>]) <span class="ruby-comment"># SELECT id, name FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; [3, &#39;foo&#39;]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">get</span>{[<span class="ruby-identifier">sum</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">as</span>(<span class="ruby-identifier">sum</span>), <span class="ruby-identifier">name</span>]} <span class="ruby-comment"># SELECT sum(id) AS sum, name FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; [6, &#39;foo&#39;]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-get-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-get-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 270</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>=(<span class="ruby-identifier">no_arg</span>=<span class="ruby-keyword">true</span>; <span class="ruby-keyword">nil</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">naked</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;Must call Dataset#get with an argument or a block, not both&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">no_arg</span>&#x000A;    <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-identifier">column</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:select</span>]&#x000A;    <span class="ruby-identifier">column</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">column</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>&#x000A;      <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">column</span>)&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">LiteralString</span>, <span class="ruby-constant">Symbol</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">cached_placeholder_literalizer</span>(<span class="ruby-value">:_get_loader</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pl</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_value_ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;&#x000A;        <span class="ruby-keyword">return</span> <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;&#x000A;      <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-identifier">column</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">cached_placeholder_literalizer</span>(<span class="ruby-value">:_get_alias_loader</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pl</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_value_ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">as</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>, <span class="ruby-value">:v</span>))&#x000A;        <span class="ruby-keyword">end</span>&#x000A;&#x000A;        <span class="ruby-keyword">return</span> <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;&#x000A;      <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">as</span>(<span class="ruby-identifier">column</span>, <span class="ruby-value">:v</span>))&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;   <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_record</span>&#x000A;     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">hash_key_symbols</span>(<span class="ruby-identifier">column</span>))&#x000A;   <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_value</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-import'>
                <a name='method-i-import'></a>
                <div class='synopsis'>
                  <span class='name'>import</span>
                  <span class='arguments'>(columns, values, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Inserts multiple records into the associated table. This method can be used
                  to efficiently insert a large number of records into a table in a single
                  query if the database supports it. Inserts are automatically wrapped in a
                  transaction.</p>
                  
                  <p>This method is called with a columns array and an array of value arrays:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">import</span>([:<span class="ruby-identifier">x</span>, :<span class="ruby-identifier">y</span>], [[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>], [<span class="ruby-value">3</span>, <span class="ruby-value">4</span>]])&#x000A;<span class="ruby-comment"># INSERT INTO table (x, y) VALUES (1, 2) </span>&#x000A;<span class="ruby-comment"># INSERT INTO table (x, y) VALUES (3, 4)</span></pre>
                  
                  <p>This method also accepts a dataset instead of an array of value arrays:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">import</span>([:<span class="ruby-identifier">x</span>, :<span class="ruby-identifier">y</span>], <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table2</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>))&#x000A;<span class="ruby-comment"># INSERT INTO table (x, y) SELECT a, b FROM table2</span></pre>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:commit_every </td><td>
                  <p>Open a new transaction for every given number of records. For example, if
                  you provide a value of 50, will commit after every 50 records.</p>
                  </td></tr><tr><td class='label'>:return </td><td>
                  <p>When this is set to :primary_key, returns an array of autoincremented
                  primary key values for the rows inserted.</p>
                  </td></tr><tr><td class='label'>:server </td><td>
                  <p>Set the server/shard to use for the transaction and insert queries.</p>
                  </td></tr><tr><td class='label'>:slice </td><td>
                  <p>Same as :commit_every, :commit_every takes precedence.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-import-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-import-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 336</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>{<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)} <span class="ruby-keyword">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;Using Sequel::Dataset#import with an empty column array is not allowed&#39;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">server</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]) <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>&#x000A;  &#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">slice_size</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:commit_every</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:slice</span>, <span class="ruby-identifier">default_import_slice</span>))&#x000A;    <span class="ruby-identifier">offset</span> = <span class="ruby-value">0</span>&#x000A;    <span class="ruby-identifier">rows</span> = []&#x000A;    <span class="ruby-keyword">while</span> <span class="ruby-identifier">offset</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">length</span>&#x000A;      <span class="ruby-identifier">rows</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">_import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>[<span class="ruby-identifier">offset</span>, <span class="ruby-identifier">slice_size</span>], <span class="ruby-identifier">opts</span>)&#x000A;      <span class="ruby-identifier">offset</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">slice_size</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">rows</span>.<span class="ruby-identifier">flatten</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">_import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-insert'>
                <a name='method-i-insert'></a>
                <div class='synopsis'>
                  <span class='name'>insert</span>
                  <span class='arguments'>(*values, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Inserts values into the associated table.  The returned value is generally
                  the value of the autoincremented primary key for the inserted row, assuming
                  that the a single row is inserted and the table has an autoincrementing
                  primary key.</p>
                  
                  <p><code>insert</code> handles a number of different argument formats:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>no arguments or single empty hash </td><td>
                  <p>Uses <a href="Dataset.html#DEFAULT">DEFAULT</a> VALUES</p>
                  </td></tr><tr><td class='label'>single hash </td><td>
                  <p>Most common format, treats keys as columns and values as values</p>
                  </td></tr><tr><td class='label'>single array </td><td>
                  <p>Treats entries as values, with no columns</p>
                  </td></tr><tr><td class='label'>two arrays </td><td>
                  <p>Treats first array as columns, second array as values</p>
                  </td></tr><tr><td class='label'>single <a href="Dataset.html">Dataset</a> </td><td>
                  <p>Treats as an insert based on a selection from the dataset given, with no
                  columns</p>
                  </td></tr><tr><td class='label'>array and dataset </td><td>
                  <p>Treats as an insert based on a selection from the dataset given, with the
                  columns given by the array.</p>
                  </td></tr></tbody></table>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>&#x000A;<span class="ruby-comment"># INSERT INTO items DEFAULT VALUES</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>({})&#x000A;<span class="ruby-comment"># INSERT INTO items DEFAULT VALUES</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>([<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>])&#x000A;<span class="ruby-comment"># INSERT INTO items VALUES (1, 2, 3)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>([:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>], [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>])&#x000A;<span class="ruby-comment"># INSERT INTO items (a, b) VALUES (1, 2)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)&#x000A;<span class="ruby-comment"># INSERT INTO items (a, b) VALUES (1, 2)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">old_items</span>])&#x000A;<span class="ruby-comment"># INSERT INTO items SELECT * FROM old_items</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert</span>([:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">b</span>], <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">old_items</span>])&#x000A;<span class="ruby-comment"># INSERT INTO items (a, b) SELECT * FROM old_items</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-insert-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-insert-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 392</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uses_returning?</span>(<span class="ruby-value">:insert</span>)&#x000A;    <span class="ruby-identifier">returning_fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">execute_insert</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-last'>
                <a name='method-i-last'></a>
                <div class='synopsis'>
                  <span class='name'>last</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Reverses the order and then runs <a
                  href="Dataset.html#method-i-first">first</a> with the given arguments and
                  block.  Note that this will not necessarily give you the last record in the
                  dataset, unless you have an unambiguous order.  If there is not currently
                  an order for this dataset, raises an <code>Error</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">last</span> <span class="ruby-comment"># SELECT * FROM table ORDER BY id DESC LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;10}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">order</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">desc</span>(:<span class="ruby-identifier">id</span>)).<span class="ruby-identifier">last</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># SELECT * FROM table ORDER BY id ASC LIMIT 2</span>&#x000A;<span class="ruby-comment"># =&gt; [{:id=&gt;1}, {:id=&gt;2}]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-last-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-last-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 411</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">last</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;No order specified&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>]&#x000A;  <span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-map'>
                <a name='method-i-map'></a>
                <div class='synopsis'>
                  <span class='name'>map</span>
                  <span class='arguments'>(column=nil, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Maps column values for each record in the dataset (if an argument is given)
                  or performs the stock mapping functionality of <code>Enumerable</code>
                  otherwise.  Raises an <code>Error</code> if both an argument and block are
                  given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">map</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [1, 2, 3, ...]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[:<span class="ruby-identifier">id</span>] <span class="ruby-operator">*</span> <span class="ruby-value">2</span>} <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [2, 4, 6, ...]</span></pre>
                  
                  <p>You can also provide an array of column names:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">map</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [[1, &#39;A&#39;], [2, &#39;B&#39;], [3, &#39;C&#39;], ...]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-map-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-map-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 430</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">map</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;Must call Dataset#map with either an argument or a block, not both&#39;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">naked</span>.<span class="ruby-identifier">map</span>(<span class="ruby-identifier">column</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">row_proc</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;      <span class="ruby-keyword">super</span>(){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">column</span>)}&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">super</span>(){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">column</span>]}&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">super</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-max'>
                <a name='method-i-max'></a>
                <div class='synopsis'>
                  <span class='name'>max</span>
                  <span class='arguments'>(arg=Sequel.virtual_row(&Proc.new))</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the maximum value for the given column/expression. Uses a virtual
                  row block if no argument is given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">max</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT max(id) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 10</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">max</span>{<span class="ruby-identifier">function</span>(<span class="ruby-identifier">column</span>)} <span class="ruby-comment"># SELECT max(function(column)) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 7</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-max-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-max-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 451</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">max</span>(<span class="ruby-identifier">arg</span>=<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>(<span class="ruby-operator">&amp;</span><span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>))&#x000A;  <span class="ruby-identifier">_aggregate</span>(<span class="ruby-value">:max</span>, <span class="ruby-identifier">arg</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-min'>
                <a name='method-i-min'></a>
                <div class='synopsis'>
                  <span class='name'>min</span>
                  <span class='arguments'>(arg=Sequel.virtual_row(&Proc.new))</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the minimum value for the given column/expression. Uses a virtual
                  row block if no argument is given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">min</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT min(id) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">min</span>{<span class="ruby-identifier">function</span>(<span class="ruby-identifier">column</span>)} <span class="ruby-comment"># SELECT min(function(column)) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 0</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-min-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-min-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 462</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">min</span>(<span class="ruby-identifier">arg</span>=<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>(<span class="ruby-operator">&amp;</span><span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>))&#x000A;  <span class="ruby-identifier">_aggregate</span>(<span class="ruby-value">:min</span>, <span class="ruby-identifier">arg</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-multi_insert'>
                <a name='method-i-multi_insert'></a>
                <div class='synopsis'>
                  <span class='name'>multi_insert</span>
                  <span class='arguments'>(hashes, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>This is a front end for import that allows you to submit an array of hashes
                  instead of arrays of columns and values:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">multi_insert</span>([{<span class="ruby-identifier">x</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}, {<span class="ruby-identifier">x</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}])&#x000A;<span class="ruby-comment"># INSERT INTO table (x) VALUES (1)</span>&#x000A;<span class="ruby-comment"># INSERT INTO table (x) VALUES (2)</span></pre>
                  
                  <p>Be aware that all hashes should have the same keys if you use this calling
                  method, otherwise some columns could be missed or set to null instead of to
                  default values.</p>
                  
                  <p>This respects the same options as <a
                  href="Dataset.html#method-i-import">import</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-multi_insert-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-multi_insert-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 478</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">multi_insert</span>(<span class="ruby-identifier">hashes</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">columns</span> = <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">keys</span>&#x000A;  <span class="ruby-identifier">import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">c</span>]}}, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-paged_each'>
                <a name='method-i-paged_each'></a>
                <div class='synopsis'>
                  <span class='name'>paged_each</span>
                  <span class='arguments'>(opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Yields each row in the dataset, but interally uses multiple queries as
                  needed to process the entire result set without keeping all rows in the
                  dataset in memory, even if the underlying driver buffers all query results
                  in memory.</p>
                  
                  <p>Because this uses multiple queries internally, in order to remain
                  consistent, it also uses a transaction internally.  Additionally, to work
                  correctly, the dataset must have unambiguous order.  Using an ambiguous
                  order can result in an infinite loop, as well as subtler bugs such as
                  yielding duplicate rows or rows being skipped.</p>
                  
                  <p><a href="../Sequel.html">Sequel</a> checks that the datasets using this
                  method have an order, but it cannot ensure that the order is unambiguous.</p>
                  
                  <p>Note that this method is not safe to use on many adapters if you are
                  running additional queries inside the provided block.  If you are running
                  queries inside the block, use a separate thread or shard inside
                  <code>paged_each</code>.</p>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:rows_per_fetch </td><td>
                  <p>The number of rows to fetch per query.  Defaults to 1000.</p>
                  </td></tr><tr><td class='label'>:strategy </td><td>
                  <p>The strategy to use for paging of results.  By default this is :offset, for
                  using an approach with a limit and offset for every page.  This can be set
                  to :filter, which uses a limit and a filter that excludes rows from
                  previous pages.  In order for this strategy to work, you must be selecting
                  the columns you are ordering by, and none of the columns can contain NULLs.
                  Note that some <a href="../Sequel.html">Sequel</a> adapters have optimized
                  implementations that will use cursors or streaming regardless of the
                  :strategy option used.</p>
                  </td></tr><tr><td class='label'>:filter_values </td><td>
                  <p>If the strategy: :filter option is used, this option should be a proc that
                  accepts the last retreived row for the previous page and an array of ORDER
                  BY expressions, and returns an array of values relating to those
                  expressions for the last retrieved row.  You will need to use this option
                  if your ORDER BY expressions are not simple columns, if they contain
                  qualified identifiers that would be ambiguous unqualified, if they contain
                  any identifiers that are aliased in SELECT, and potentially other cases.</p>
                  </td></tr></tbody></table>
                  
                  <p>Examples:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">paged_each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> }&#x000A;<span class="ruby-comment"># SELECT * FROM table ORDER BY id LIMIT 1000</span>&#x000A;<span class="ruby-comment"># SELECT * FROM table ORDER BY id LIMIT 1000 OFFSET 1000</span>&#x000A;<span class="ruby-comment"># ...</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">paged_each</span>(:<span class="ruby-identifier">rows_per_fetch=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">100</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> }&#x000A;<span class="ruby-comment"># SELECT * FROM table ORDER BY id LIMIT 100</span>&#x000A;<span class="ruby-comment"># SELECT * FROM table ORDER BY id LIMIT 100 OFFSET 100</span>&#x000A;<span class="ruby-comment"># ...</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">paged_each</span>(<span class="ruby-identifier">strategy</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">filter</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> }&#x000A;<span class="ruby-comment"># SELECT * FROM table ORDER BY id LIMIT 1000</span>&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE id &gt; 1001 ORDER BY id LIMIT 1000</span>&#x000A;<span class="ruby-comment"># ...</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">id</span>).<span class="ruby-identifier">paged_each</span>(<span class="ruby-identifier">strategy</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">filter</span>,&#x000A;  <span class="ruby-identifier">filter_values</span><span class="ruby-operator">:</span> <span class="ruby-identifier">lambda</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">row</span>, <span class="ruby-identifier">exprs</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">row</span>[:<span class="ruby-identifier">id</span>]]}){<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> }&#x000A;<span class="ruby-comment"># SELECT * FROM table ORDER BY id LIMIT 1000</span>&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE id &gt; 1001 ORDER BY id LIMIT 1000</span>&#x000A;<span class="ruby-comment"># ...</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-paged_each-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-paged_each-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 539</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">paged_each</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>]&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Dataset#paged_each requires the dataset be ordered&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">enum_for</span>(<span class="ruby-value">:paged_each</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">total_limit</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:limit</span>]&#x000A;  <span class="ruby-identifier">offset</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:offset</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">server</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:server</span>]&#x000A;    <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>]&#x000A;    <span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>] = <span class="ruby-identifier">server</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">rows_per_fetch</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:rows_per_fetch</span>] <span class="ruby-operator">||</span> <span class="ruby-value">1000</span>&#x000A;  <span class="ruby-identifier">strategy</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">offset</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">total_limit</span>&#x000A;    <span class="ruby-value">:offset</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">opts</span>[<span class="ruby-value">:strategy</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:offset</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">strategy</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:filter</span>&#x000A;      <span class="ruby-identifier">filter_values</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:filter_values</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">row</span>, <span class="ruby-identifier">exprs</span><span class="ruby-operator">|</span> <span class="ruby-identifier">exprs</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">hash_key_symbol</span>(<span class="ruby-identifier">e</span>)]}}&#x000A;      <span class="ruby-identifier">base_ds</span> = <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">rows_per_fetch</span>)&#x000A;      <span class="ruby-keyword">while</span> <span class="ruby-identifier">ds</span>&#x000A;        <span class="ruby-identifier">last_row</span> = <span class="ruby-keyword">nil</span>&#x000A;        <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">last_row</span> = <span class="ruby-identifier">row</span>&#x000A;          <span class="ruby-keyword">yield</span> <span class="ruby-identifier">row</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-identifier">ds</span> = (<span class="ruby-identifier">base_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">ignore_values_preceding</span>(<span class="ruby-identifier">last_row</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">filter_values</span>)) <span class="ruby-keyword">if</span> <span class="ruby-identifier">last_row</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">offset</span> <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>&#x000A;      <span class="ruby-identifier">num_rows_yielded</span> = <span class="ruby-identifier">rows_per_fetch</span>&#x000A;      <span class="ruby-identifier">total_rows</span> = <span class="ruby-value">0</span>&#x000A;&#x000A;      <span class="ruby-keyword">while</span> <span class="ruby-identifier">num_rows_yielded</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">rows_per_fetch</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">total_limit</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">total_rows</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">total_limit</span>)&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">total_limit</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">total_rows</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rows_per_fetch</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">total_limit</span>&#x000A;          <span class="ruby-identifier">rows_per_fetch</span> = <span class="ruby-identifier">total_limit</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">total_rows</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;&#x000A;        <span class="ruby-identifier">num_rows_yielded</span> = <span class="ruby-value">0</span>&#x000A;        <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">rows_per_fetch</span>, <span class="ruby-identifier">offset</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">num_rows_yielded</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;          <span class="ruby-identifier">total_rows</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">total_limit</span>&#x000A;          <span class="ruby-keyword">yield</span> <span class="ruby-identifier">row</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;&#x000A;        <span class="ruby-identifier">offset</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rows_per_fetch</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_hash'>
                <a name='method-i-select_hash'></a>
                <div class='synopsis'>
                  <span class='name'>select_hash</span>
                  <span class='arguments'>(key_column, value_column, opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a hash with key_column values as keys and value_column values as
                  values.  Similar to <a href="Dataset.html#method-i-as_hash">#as_hash</a>,
                  but only selects the columns given.  Like <a
                  href="Dataset.html#method-i-as_hash">#as_hash</a>, it accepts an optional
                  :hash parameter, into which entries will be merged.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_hash</span>(:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>) <span class="ruby-comment"># SELECT id, name FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; {1=&gt;&#39;a&#39;, 2=&gt;&#39;b&#39;, ...}</span></pre>
                  
                  <p>You can also provide an array of column names for either the key_column,
                  the value column, or both:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_hash</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">foo</span>], [:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">bar</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {[1, 3]=&gt;[&#39;a&#39;, &#39;c&#39;], [2, 4]=&gt;[&#39;b&#39;, &#39;d&#39;], ...}</span></pre>
                  
                  <p>When using this method, you must be sure that each expression has an alias
                  that <a href="../Sequel.html">Sequel</a> can determine.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_hash-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_hash-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 615</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_hash</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">_select_hash</span>(<span class="ruby-value">:as_hash</span>, <span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span>, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_hash_groups'>
                <a name='method-i-select_hash_groups'></a>
                <div class='synopsis'>
                  <span class='name'>select_hash_groups</span>
                  <span class='arguments'>(key_column, value_column, opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a hash with key_column values as keys and an array of value_column
                  values. Similar to <a
                  href="Dataset.html#method-i-to_hash_groups">#to_hash_groups</a>, but only
                  selects the columns given.  Like <a
                  href="Dataset.html#method-i-to_hash_groups">#to_hash_groups</a>, it accepts
                  an optional :hash parameter, into which entries will be merged.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_hash_groups</span>(:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT id, name FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; {&#39;a&#39;=&gt;[1, 4, ...], &#39;b&#39;=&gt;[2, ...], ...}</span></pre>
                  
                  <p>You can also provide an array of column names for either the key_column,
                  the value column, or both:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_hash_groups</span>([:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">middle</span>], [:<span class="ruby-identifier">last</span>, :<span class="ruby-identifier">id</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {[&#39;a&#39;, &#39;b&#39;]=&gt;[[&#39;c&#39;, 1], [&#39;d&#39;, 2], ...], ...}</span></pre>
                  
                  <p>When using this method, you must be sure that each expression has an alias
                  that <a href="../Sequel.html">Sequel</a> can determine.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_hash_groups-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_hash_groups-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 634</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_hash_groups</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">_select_hash</span>(<span class="ruby-value">:to_hash_groups</span>, <span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span>, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_map'>
                <a name='method-i-select_map'></a>
                <div class='synopsis'>
                  <span class='name'>select_map</span>
                  <span class='arguments'>(column=nil, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Selects the column given (either as an argument or as a block), and returns
                  an array of all values of that column in the dataset.  If you give a block
                  argument that returns an array with multiple entries, the contents of the
                  resulting array are undefined.  Raises an <a href="Error.html">Error</a> if
                  called with both an argument and a block.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_map</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT id FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [3, 5, 8, 1, ...]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_map</span>{<span class="ruby-identifier">id</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>} <span class="ruby-comment"># SELECT (id * 2) FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [6, 10, 16, 2, ...]</span></pre>
                  
                  <p>You can also provide an array of column names:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_map</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>]) <span class="ruby-comment"># SELECT id, name FROM table</span>&#x000A;<span class="ruby-comment"># =&gt; [[1, &#39;A&#39;], [2, &#39;B&#39;], [3, &#39;C&#39;], ...]</span></pre>
                  
                  <p>If you provide an array of expressions, you must be sure that each entry in
                  the array has an alias that <a href="../Sequel.html">Sequel</a> can
                  determine.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_map-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_map-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 657</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_map</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">_select_map</span>(<span class="ruby-identifier">column</span>, <span class="ruby-keyword">false</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-select_order_map'>
                <a name='method-i-select_order_map'></a>
                <div class='synopsis'>
                  <span class='name'>select_order_map</span>
                  <span class='arguments'>(column=nil, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>The same as <a href="Dataset.html#method-i-select_map">#select_map</a>, but
                  in addition orders the array by the column.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_order_map</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT id FROM table ORDER BY id</span>&#x000A;<span class="ruby-comment"># =&gt; [1, 2, 3, 4, ...]</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_order_map</span>{<span class="ruby-identifier">id</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>} <span class="ruby-comment"># SELECT (id * 2) FROM table ORDER BY (id * 2)</span>&#x000A;<span class="ruby-comment"># =&gt; [2, 4, 6, 8, ...]</span></pre>
                  
                  <p>You can also provide an array of column names:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select_order_map</span>([:<span class="ruby-identifier">id</span>, :<span class="ruby-identifier">name</span>]) <span class="ruby-comment"># SELECT id, name FROM table ORDER BY id, name</span>&#x000A;<span class="ruby-comment"># =&gt; [[1, &#39;A&#39;], [2, &#39;B&#39;], [3, &#39;C&#39;], ...]</span></pre>
                  
                  <p>If you provide an array of expressions, you must be sure that each entry in
                  the array has an alias that <a href="../Sequel.html">Sequel</a> can
                  determine.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-select_order_map-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-select_order_map-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 676</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">select_order_map</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">_select_map</span>(<span class="ruby-identifier">column</span>, <span class="ruby-keyword">true</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-single_record'>
                <a name='method-i-single_record'></a>
                <div class='synopsis'>
                  <span class='name'>single_record</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Limits the dataset to one record, and returns the first record in the
                  dataset, or nil if the dataset has no records. Users should probably use
                  <code>first</code> instead of this method. Example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">test</span>].<span class="ruby-identifier">single_record</span> <span class="ruby-comment"># SELECT * FROM test LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; {:column_name=&gt;&#39;value&#39;}</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-single_record-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-single_record-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 686</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">single_record</span>&#x000A;  <span class="ruby-identifier">_single_record_ds</span>.<span class="ruby-identifier">single_record!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-single_record-21'>
                <a name='method-i-single_record-21'></a>
                <div class='synopsis'>
                  <span class='name'>single_record!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the first record in dataset, without limiting the dataset. Returns
                  nil if the dataset has no records. Users should probably use
                  <code>first</code> instead of this method. This should only be used if you
                  know the dataset is already limited to a single record. This method may be
                  desirable to use for performance reasons, as it does not clone the
                  receiver. Example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">test</span>].<span class="ruby-identifier">single_record!</span> <span class="ruby-comment"># SELECT * FROM test</span>&#x000A;<span class="ruby-comment"># =&gt; {:column_name=&gt;&#39;value&#39;}</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-single_record-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-single_record-21-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 698</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">single_record!</span>&#x000A;  <span class="ruby-identifier">with_sql_first</span>(<span class="ruby-identifier">select_sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-single_value'>
                <a name='method-i-single_value'></a>
                <div class='synopsis'>
                  <span class='name'>single_value</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the first value of the first record in the dataset. Returns nil if
                  dataset is empty.  Users should generally use <code>get</code> instead of
                  this method. Example:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">test</span>].<span class="ruby-identifier">single_value</span> <span class="ruby-comment"># SELECT * FROM test LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; &#39;value&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-single_value-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-single_value-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 708</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">single_value</span>&#x000A;  <span class="ruby-identifier">single_value_ds</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">r</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-keyword">return</span> <span class="ruby-identifier">v</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-single_value-21'>
                <a name='method-i-single_value-21'></a>
                <div class='synopsis'>
                  <span class='name'>single_value!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the first value of the first record in the dataset, without
                  limiting the dataset. Returns nil if the dataset is empty. Users should
                  generally use <code>get</code> instead of this method.  Should not be used
                  on graphed datasets or datasets that have row_procs that don&#39;t return
                  hashes.  This method may be desirable to use for performance reasons, as it
                  does not clone the receiver.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">test</span>].<span class="ruby-identifier">single_value!</span> <span class="ruby-comment"># SELECT * FROM test</span>&#x000A;<span class="ruby-comment"># =&gt; &#39;value&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-single_value-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-single_value-21-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 723</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">single_value!</span>&#x000A;  <span class="ruby-identifier">with_sql_single_value</span>(<span class="ruby-identifier">select_sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-sum'>
                <a name='method-i-sum'></a>
                <div class='synopsis'>
                  <span class='name'>sum</span>
                  <span class='arguments'>(arg=Sequel.virtual_row(&Proc.new))</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the sum for the given column/expression. Uses a virtual row block
                  if no column is given.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">sum</span>(:<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT sum(id) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 55</span>&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">sum</span>{<span class="ruby-identifier">function</span>(<span class="ruby-identifier">column</span>)} <span class="ruby-comment"># SELECT sum(function(column)) FROM table LIMIT 1</span>&#x000A;<span class="ruby-comment"># =&gt; 10</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-sum-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-sum-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 734</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">sum</span>(<span class="ruby-identifier">arg</span>=<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>(<span class="ruby-operator">&amp;</span><span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>))&#x000A;  <span class="ruby-identifier">_aggregate</span>(<span class="ruby-value">:sum</span>, <span class="ruby-identifier">arg</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-to_hash'>
                <a name='method-i-to_hash'></a>
                <div class='synopsis'>
                  <span class='name'>to_hash</span>
                  <span class='arguments'>(*a)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of <a href="Dataset.html#method-i-as_hash">#as_hash</a> for backwards
                  compatibility.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-to_hash-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-to_hash-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 790</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_hash</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">a</span>)&#x000A;  <span class="ruby-identifier">as_hash</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">a</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-to_hash_groups'>
                <a name='method-i-to_hash_groups'></a>
                <div class='synopsis'>
                  <span class='name'>to_hash_groups</span>
                  <span class='arguments'>(key_column, value_column = nil, opts = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a hash with one column used as key and the values being an array of
                  column values. If the value_column is not given or nil, uses the entire
                  hash as the value.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">to_hash_groups</span>(:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">id</span>) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {&#39;Jim&#39;=&gt;[1, 4, 16, ...], &#39;Bob&#39;=&gt;[2], ...}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">to_hash_groups</span>(:<span class="ruby-identifier">name</span>) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {&#39;Jim&#39;=&gt;[{:id=&gt;1, :name=&gt;&#39;Jim&#39;}, {:id=&gt;4, :name=&gt;&#39;Jim&#39;}, ...], &#39;Bob&#39;=&gt;[{:id=&gt;2, :name=&gt;&#39;Bob&#39;}], ...}</span></pre>
                  
                  <p>You can also provide an array of column names for either the key_column,
                  the value column, or both:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">to_hash_groups</span>([:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">middle</span>], [:<span class="ruby-identifier">last</span>, :<span class="ruby-identifier">id</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {[&#39;Jim&#39;, &#39;Bob&#39;]=&gt;[[&#39;Smith&#39;, 1], [&#39;Jackson&#39;, 4], ...], ...}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">to_hash_groups</span>([:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">middle</span>]) <span class="ruby-comment"># SELECT * FROM table</span>&#x000A;<span class="ruby-comment"># {[&#39;Jim&#39;, &#39;Bob&#39;]=&gt;[{:id=&gt;1, :first=&gt;&#39;Jim&#39;, :middle=&gt;&#39;Bob&#39;, :last=&gt;&#39;Smith&#39;}, ...], ...}</span></pre>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:all </td><td>
                  <p>Use all instead of each to retrieve the objects</p>
                  </td></tr><tr><td class='label'>:hash </td><td>
                  <p>The object into which the values will be placed.  If this is not given, an
                  empty hash is used.  This can be used to use a hash with a default value or
                  default proc.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-to_hash_groups-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-to_hash_groups-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 818</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_hash_groups</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">h</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:hash</span>] <span class="ruby-operator">||</span> {}&#x000A;  <span class="ruby-identifier">meth</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:all</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:all</span> <span class="ruby-operator">:</span> <span class="ruby-value">:each</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">value_column</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">naked</span>.<span class="ruby-identifier">to_hash_groups</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">row_proc</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">key_column</span>)] <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">value_column</span>)}&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">value_column</span>)}&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">key_column</span>)] <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">value_column</span>]}&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">value_column</span>]}&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;    <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">h</span>[<span class="ruby-identifier">key_column</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">k</span>]}] <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">h</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">h</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-truncate'>
                <a name='method-i-truncate'></a>
                <div class='synopsis'>
                  <span class='name'>truncate</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Truncates the dataset.  Returns nil.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">truncate</span> <span class="ruby-comment"># TRUNCATE table</span>&#x000A;<span class="ruby-comment"># =&gt; nil</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-truncate-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-truncate-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 848</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">truncate</span>&#x000A;  <span class="ruby-identifier">execute_ddl</span>(<span class="ruby-identifier">truncate_sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-update'>
                <a name='method-i-update'></a>
                <div class='synopsis'>
                  <span class='name'>update</span>
                  <span class='arguments'>(values=OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Updates values for the dataset.  The returned value is the number of rows
                  updated. <code>values</code> should be a hash where the keys are columns to
                  set and values are the values to which to set the columns.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">update</span>(<span class="ruby-identifier">x</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>) <span class="ruby-comment"># UPDATE table SET x = NULL</span>&#x000A;<span class="ruby-comment"># =&gt; 10</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">update</span>(<span class="ruby-identifier">x</span><span class="ruby-operator">:</span> <span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">x</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-identifier">y</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>) <span class="ruby-comment"># UPDATE table SET x = (x + 1), y = 0</span>&#x000A;<span class="ruby-comment"># =&gt; 10</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-update-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-update-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 861</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uses_returning?</span>(<span class="ruby-value">:update</span>)&#x000A;    <span class="ruby-identifier">returning_fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-where_all'>
                <a name='method-i-where_all'></a>
                <div class='synopsis'>
                  <span class='name'>where_all</span>
                  <span class='arguments'>(cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Return an array of all rows matching the given filter condition, also
                  yielding each row to the given block.  Basically the same as
                  where(cond).all(&amp;block), except it can be optimized to not create an
                  intermediate dataset.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">where_all</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>])&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE (id IN (1, 2, 3))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-where_all-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-where_all-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 876</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">where_all</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">_where_loader</span>&#x000A;    <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">all</span>(<span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">cond</span>).<span class="ruby-identifier">all</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-where_each'>
                <a name='method-i-where_each'></a>
                <div class='synopsis'>
                  <span class='name'>where_each</span>
                  <span class='arguments'>(cond, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Iterate over all rows matching the given filter condition,  yielding each
                  row to the given block.  Basically the same as
                  where(cond).each(&amp;block), except it can be optimized to not create an
                  intermediate dataset.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">where_each</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>]){<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">row</span>}&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE (id IN (1, 2, 3))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-where_each-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-where_each-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 890</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">where_each</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">_where_loader</span>&#x000A;    <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">cond</span>).<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-where_single_value'>
                <a name='method-i-where_single_value'></a>
                <div class='synopsis'>
                  <span class='name'>where_single_value</span>
                  <span class='arguments'>(cond)</span>
                </div>
                <div class='description'>
                  
                  <p>Filter the datasets using the given filter condition, then return a single
                  value. This assumes that the dataset has already been setup to limit the
                  selection to a single column.  Basically the same as
                  where(cond).single_value, except it can be optimized to not create an
                  intermediate dataset.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">select</span>(:<span class="ruby-identifier">name</span>).<span class="ruby-identifier">where_single_value</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)&#x000A;<span class="ruby-comment"># SELECT name FROM table WHERE (id = 1) LIMIT 1</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-where_single_value-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-where_single_value-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 905</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">where_single_value</span>(<span class="ruby-identifier">cond</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loader</span> = <span class="ruby-identifier">cached_placeholder_literalizer</span>(<span class="ruby-value">:_where_single_value_loader</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pl</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">single_value_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">pl</span>.<span class="ruby-identifier">arg</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">loader</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>))&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">cond</span>).<span class="ruby-identifier">single_value</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql_all'>
                <a name='method-i-with_sql_all'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql_all</span>
                  <span class='arguments'>(sql, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Run the given <a href="SQL.html">SQL</a> and return an array of all rows. 
                  If a block is given, each row is yielded to the block after all rows are
                  loaded. See with_sql_each.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql_all-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql_all-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 918</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql_all</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">_all</span>(<span class="ruby-identifier">block</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">with_sql_each</span>(<span class="ruby-identifier">sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>}}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql_delete'>
                <a name='method-i-with_sql_delete'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql_delete</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='description'>
                  
                  <p>Execute the given <a href="SQL.html">SQL</a> and return the number of rows
                  deleted.  This exists solely as an optimization, replacing <a
                  href="Dataset.html#method-i-with_sql">#with_sql</a>(sql).delete.  It&#39;s
                  significantly faster as it does not require cloning the current dataset.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql_delete-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql_delete-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 925</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql_delete</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql_each'>
                <a name='method-i-with_sql_each'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql_each</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='description'>
                  
                  <p>Run the given <a href="SQL.html">SQL</a> and yield each returned row to the
                  block.</p>
                  
                  <p>This method should not be called on a shared dataset if the columns
                  selected in the given <a href="SQL.html">SQL</a> do not match the columns
                  in the receiver.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql_each-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql_each-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 934</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql_each</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rp</span> = <span class="ruby-identifier">row_proc</span>&#x000A;    <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rp</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>)}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql_first'>
                <a name='method-i-with_sql_first'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql_first</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='description'>
                  
                  <p>Run the given <a href="SQL.html">SQL</a> and return the first row, or nil
                  if no rows were returned. See with_sql_each.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql_first-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql_first-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 945</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql_first</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-identifier">with_sql_each</span>(<span class="ruby-identifier">sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword">return</span> <span class="ruby-identifier">r</span>}&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql_insert'>
                <a name='method-i-with_sql_insert'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql_insert</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='description'>
                  
                  <p>Execute the given <a href="SQL.html">SQL</a> and (on most databases) return
                  the primary key of the inserted row.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql_insert-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql_insert-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 961</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql_insert</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-identifier">execute_insert</span>(<span class="ruby-identifier">sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_sql_single_value'>
                <a name='method-i-with_sql_single_value'></a>
                <div class='synopsis'>
                  <span class='name'>with_sql_single_value</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='description'>
                  
                  <p>Run the given <a href="SQL.html">SQL</a> and return the first value in the
                  first row, or nil if no rows were returned.  For this to make sense, the <a
                  href="SQL.html">SQL</a> given should select only a single value.  See
                  with_sql_each.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_sql_single_value-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_sql_single_value-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 953</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_sql_single_value</span>(<span class="ruby-identifier">sql</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">with_sql_first</span>(<span class="ruby-identifier">sql</span>)&#x000A;    <span class="ruby-identifier">r</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-keyword">return</span> <span class="ruby-identifier">v</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Protected Instance methods</h2>
              <div class='method protected-instance' id='method-method-i-_import'>
                <a name='method-i-_import'></a>
                <div class='synopsis'>
                  <span class='name'>_import</span>
                  <span class='arguments'>(columns, values, opts)</span>
                </div>
                <div class='description'>
                  
                  <p>Internals of <a href="Dataset.html#method-i-import">import</a>.  If primary
                  key values are requested, use separate insert commands for each row. 
                  Otherwise, call <a
                  href="Dataset.html#method-i-multi_insert_sql">multi_insert_sql</a> and
                  execute each statement it gives separately.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-_import-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-_import-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 970</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">_import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-identifier">trans_opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:server=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@opts</span>[<span class="ruby-value">:server</span>])&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:return</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:primary_key</span>&#x000A;    <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">trans_opts</span>){<span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">v</span>)}}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">stmts</span> = <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)&#x000A;    <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">trans_opts</span>){<span class="ruby-identifier">stmts</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">st</span><span class="ruby-operator">|</span> <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">st</span>)}}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-_select_map_multiple'>
                <a name='method-i-_select_map_multiple'></a>
                <div class='synopsis'>
                  <span class='name'>_select_map_multiple</span>
                  <span class='arguments'>(ret_cols)</span>
                </div>
                <div class='description'>
                  
                  <p>Return an array of arrays of values given by the symbols in ret_cols.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-_select_map_multiple-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-_select_map_multiple-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 981</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">_select_map_multiple</span>(<span class="ruby-identifier">ret_cols</span>)&#x000A;  <span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">ret_cols</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-_select_map_single'>
                <a name='method-i-_select_map_single'></a>
                <div class='synopsis'>
                  <span class='name'>_select_map_single</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns an array of the first value in each row.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-_select_map_single-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-_select_map_single-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 986</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">_select_map_single</span>&#x000A;  <span class="ruby-identifier">k</span> = <span class="ruby-keyword">nil</span>&#x000A;  <span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">k</span><span class="ruby-operator">||=</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>]}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-single_value_ds'>
                <a name='method-i-single_value_ds'></a>
                <div class='synopsis'>
                  <span class='name'>single_value_ds</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>A dataset for returning single values from the current dataset.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-single_value_ds-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-single_value_ds-source'><span class="ruby-comment"># File lib/sequel/dataset/actions.rb, line 992</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">single_value_ds</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>).<span class="ruby-identifier">ungraphed</span>.<span class="ruby-identifier">naked</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='3+-+User+Methods+relating+to+SQL+Creation'>3 - User Methods relating to SQL Creation</a>
            </h2>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-exists'>
                <a name='method-i-exists'></a>
                <div class='synopsis'>
                  <span class='name'>exists</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns an <a href="Dataset.html#EXISTS">EXISTS</a> clause for the dataset
                  as an <a
                  href="SQL/PlaceholderLiteralString.html">SQL::PlaceholderLiteralString</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">select</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">where</span>(<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">exists</span>)&#x000A;<span class="ruby-comment"># SELECT 1 WHERE (EXISTS (SELECT * FROM items))</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-exists-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-exists-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 13</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">exists</span>&#x000A;  <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">PlaceholderLiteralString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">EXISTS</span>, [<span class="ruby-keyword">self</span>], <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-insert_sql'>
                <a name='method-i-insert_sql'></a>
                <div class='synopsis'>
                  <span class='name'>insert_sql</span>
                  <span class='arguments'>(*values)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns an INSERT <a href="SQL.html">SQL</a> query string.  See
                  <code>insert</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">insert_sql</span>(<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)&#x000A;<span class="ruby-comment"># =&gt; &quot;INSERT INTO items (a) VALUES (1)&quot;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-insert_sql-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-insert_sql-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 21</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:sql</span>]) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:sql</span>]&#x000A;&#x000A;  <span class="ruby-identifier">check_modification_allowed!</span>&#x000A;&#x000A;  <span class="ruby-identifier">columns</span> = []&#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">size</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">0</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">insert_sql</span>({})&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">values</span>[<span class="ruby-value">0</span>]&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>&#x000A;      <span class="ruby-identifier">values</span> = []&#x000A;      <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> &#x000A;        <span class="ruby-identifier">columns</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">k</span>&#x000A;        <span class="ruby-identifier">values</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">v</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">Dataset</span>, <span class="ruby-constant">Array</span>, <span class="ruby-constant">LiteralString</span>&#x000A;      <span class="ruby-identifier">values</span> = <span class="ruby-identifier">vals</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">2</span>&#x000A;    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v0</span> = <span class="ruby-identifier">values</span>[<span class="ruby-value">0</span>]).<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> ((<span class="ruby-identifier">v1</span> = <span class="ruby-identifier">values</span>[<span class="ruby-value">1</span>]).<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">v1</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">v1</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">LiteralString</span>))&#x000A;      <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span> = <span class="ruby-identifier">v0</span>, <span class="ruby-identifier">v1</span>&#x000A;      <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;Different number of values and columns given to insert_sql&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-keyword">and</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">length</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">insert_supports_empty_values?</span> &#x000A;    <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span> = <span class="ruby-identifier">insert_empty_columns_values</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:columns=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">columns</span>, <span class="ruby-value">:values=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">values</span>).<span class="ruby-identifier">send</span>(<span class="ruby-value">:_insert_sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-literal_append'>
                <a name='method-i-literal_append'></a>
                <div class='synopsis'>
                  <span class='name'>literal_append</span>
                  <span class='arguments'>(sql, v)</span>
                </div>
                <div class='description'>
                  
                  <p>Append a literal representation of a value to the given <a
                  href="SQL.html">SQL</a> string.</p>
                  
                  <p>If an unsupported object is given, an <code>Error</code> is raised.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-literal_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-literal_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 58</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">v</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">skip_symbol_cache?</span>&#x000A;      <span class="ruby-identifier">literal_symbol_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;    <span class="ruby-keyword">else</span> &#x000A;      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">l</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">literal_symbol</span>(<span class="ruby-identifier">v</span>)&#x000A;        <span class="ruby-identifier">l</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;        <span class="ruby-identifier">literal_symbol_append</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">v</span>)&#x000A;        <span class="ruby-identifier">db</span>.<span class="ruby-identifier">literal_symbol_set</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">l</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">l</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">v</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">LiteralString</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">v</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Blob</span>&#x000A;      <span class="ruby-identifier">literal_blob_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">literal_string_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Integer</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_integer</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>&#x000A;    <span class="ruby-identifier">literal_hash_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Expression</span>&#x000A;    <span class="ruby-identifier">literal_expression_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Float</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_float</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">BigDecimal</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_big_decimal</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">NilClass</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_nil</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">TrueClass</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_true</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">FalseClass</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_false</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>&#x000A;    <span class="ruby-identifier">literal_array_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Time</span>&#x000A;    <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQLTime</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">literal_sqltime_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">literal_time_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">DateTime</span>&#x000A;    <span class="ruby-identifier">literal_datetime_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Date</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal_date</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Dataset</span>&#x000A;    <span class="ruby-identifier">literal_dataset_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">literal_other_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-multi_insert_sql'>
                <a name='method-i-multi_insert_sql'></a>
                <div class='synopsis'>
                  <span class='name'>multi_insert_sql</span>
                  <span class='arguments'>(columns, values)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns an array of insert statements for inserting multiple records. This
                  method is used by <code>multi_insert</code> to format insert statements and
                  expects a keys array and and an array of value arrays.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-multi_insert_sql-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-multi_insert_sql-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 114</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">multi_insert_sql_strategy</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:values</span>&#x000A;    <span class="ruby-identifier">sql</span> = <span class="ruby-constant">LiteralString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;VALUES &#39;</span>)&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">r</span>)})&#x000A;    [<span class="ruby-identifier">insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">sql</span>)]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:union</span>&#x000A;    <span class="ruby-identifier">c</span> = <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-identifier">sql</span> = <span class="ruby-constant">LiteralString</span>.<span class="ruby-identifier">new</span>&#x000A;    <span class="ruby-identifier">u</span> = <span class="ruby-string">&#39; UNION ALL SELECT &#39;</span>&#x000A;    <span class="ruby-identifier">f</span> = <span class="ruby-identifier">empty_from_sql</span>&#x000A;    <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>&#x000A;        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">u</span>&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;SELECT &#39;</span>&#x000A;        <span class="ruby-identifier">c</span> = <span class="ruby-keyword">true</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">v</span>)&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">f</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">f</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    [<span class="ruby-identifier">insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">sql</span>)]&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">r</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-sql'>
                <a name='method-i-sql'></a>
                <div class='synopsis'>
                  <span class='name'>sql</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Same as <code>select_sql</code>, not aliased directly to make subclassing
                  simpler.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-sql-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-sql-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 142</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">sql</span>&#x000A;  <span class="ruby-identifier">select_sql</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-truncate_sql'>
                <a name='method-i-truncate_sql'></a>
                <div class='synopsis'>
                  <span class='name'>truncate_sql</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a TRUNCATE <a href="SQL.html">SQL</a> query string.  See
                  <code>truncate</code></p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">truncate_sql</span> <span class="ruby-comment"># =&gt; &#39;TRUNCATE items&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-truncate_sql-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-truncate_sql-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 149</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">truncate_sql</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:sql</span>]&#x000A;    <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:sql</span>])&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">check_truncation_allowed!</span>&#x000A;    <span class="ruby-identifier">check_not_limited!</span>(<span class="ruby-value">:truncate</span>)&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&quot;Can&#39;t truncate filtered datasets&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:where</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:having</span>]&#x000A;    <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;    <span class="ruby-identifier">source_list_append</span>(<span class="ruby-identifier">t</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>])&#x000A;    <span class="ruby-identifier">_truncate_sql</span>(<span class="ruby-identifier">t</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-update_sql'>
                <a name='method-i-update_sql'></a>
                <div class='synopsis'>
                  <span class='name'>update_sql</span>
                  <span class='arguments'>(values = OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Formats an UPDATE statement using the given values.  See
                  <code>update</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">price</span><span class="ruby-operator">:</span> <span class="ruby-value">100</span>, <span class="ruby-identifier">category</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;software&#39;</span>)&#x000A;<span class="ruby-comment"># =&gt; &quot;UPDATE items SET price = 100, category = &#39;software&#39;</span></pre>
                  
                  <p>Raises an <code>Error</code> if the dataset is grouped or includes more
                  than one table.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-update_sql-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-update_sql-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 169</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">values</span> = <span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:sql</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:sql</span>]&#x000A;  <span class="ruby-identifier">check_modification_allowed!</span>&#x000A;  <span class="ruby-identifier">check_not_limited!</span>(<span class="ruby-value">:update</span>)&#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">values</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">LiteralString</span>&#x000A;    <span class="ruby-comment"># nothing</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;plain string passed to Dataset#update is not supported, use Sequel.lit to use a literal string&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:values=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">values</span>).<span class="ruby-identifier">send</span>(<span class="ruby-value">:_update_sql</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='4+-+Methods+that+describe+what+the+dataset+supports'>4 - Methods that describe what the dataset supports</a>
            </h2>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-provides_accurate_rows_matched-3F'>
                <a name='method-i-provides_accurate_rows_matched-3F'></a>
                <div class='synopsis'>
                  <span class='name'>provides_accurate_rows_matched?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether this dataset will provide accurate number of rows matched for
                  delete and update statements, true by default.  Accurate in this case is
                  the number of rows matched by the dataset&#39;s filter.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-provides_accurate_rows_matched-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-provides_accurate_rows_matched-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 18</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">provides_accurate_rows_matched?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-quote_identifiers-3F'>
                <a name='method-i-quote_identifiers-3F'></a>
                <div class='synopsis'>
                  <span class='name'>quote_identifiers?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether this dataset quotes identifiers.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-quote_identifiers-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-quote_identifiers-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 11</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">quote_identifiers?</span>&#x000A;  <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:quote_identifiers</span>, <span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-recursive_cte_requires_column_aliases-3F'>
                <a name='method-i-recursive_cte_requires_column_aliases-3F'></a>
                <div class='synopsis'>
                  <span class='name'>recursive_cte_requires_column_aliases?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether you must use a column alias list for recursive CTEs, false by
                  default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-recursive_cte_requires_column_aliases-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-recursive_cte_requires_column_aliases-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 23</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">recursive_cte_requires_column_aliases?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-requires_placeholder_type_specifiers-3F'>
                <a name='method-i-requires_placeholder_type_specifiers-3F'></a>
                <div class='synopsis'>
                  <span class='name'>requires_placeholder_type_specifiers?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether type specifiers are required for prepared statement/bound variable
                  argument placeholders (i.e. :bv__integer), false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-requires_placeholder_type_specifiers-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-requires_placeholder_type_specifiers-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 35</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">requires_placeholder_type_specifiers?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-requires_sql_standard_datetimes-3F'>
                <a name='method-i-requires_sql_standard_datetimes-3F'></a>
                <div class='synopsis'>
                  <span class='name'>requires_sql_standard_datetimes?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset requires <a href="SQL.html">SQL</a> standard datetimes.
                  False by default, as most allow strings with ISO 8601 format.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-requires_sql_standard_datetimes-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-requires_sql_standard_datetimes-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 29</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">requires_sql_standard_datetimes?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_cte-3F'>
                <a name='method-i-supports_cte-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_cte?</span>
                  <span class='arguments'>(type=:select)</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports common table expressions, false by default. If
                  given, <code>type</code> can be :select, :insert, :update, or :delete, in
                  which case it determines whether WITH is supported for the respective
                  statement type.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_cte-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_cte-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 42</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_cte?</span>(<span class="ruby-identifier">type</span>=<span class="ruby-value">:select</span>)&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_cte_in_subqueries-3F'>
                <a name='method-i-supports_cte_in_subqueries-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_cte_in_subqueries?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports common table expressions in subqueries, false
                  by default. If false, applies the WITH clause to the main query, which can
                  cause issues if multiple WITH clauses use the same name.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_cte_in_subqueries-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_cte_in_subqueries-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 49</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_cte_in_subqueries?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_derived_column_lists-3F'>
                <a name='method-i-supports_derived_column_lists-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_derived_column_lists?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports derived column lists (e.g. “table_expr AS
                  table_alias(column_alias1, column_alias2, …)”), true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_derived_column_lists-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_derived_column_lists-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 56</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_derived_column_lists?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_distinct_on-3F'>
                <a name='method-i-supports_distinct_on-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_distinct_on?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports or can emulate the DISTINCT ON clause, false
                  by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_distinct_on-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_distinct_on-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 61</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_distinct_on?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_group_cube-3F'>
                <a name='method-i-supports_group_cube-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_group_cube?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports CUBE with GROUP BY, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_group_cube-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_group_cube-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 66</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_group_cube?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_group_rollup-3F'>
                <a name='method-i-supports_group_rollup-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_group_rollup?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports ROLLUP with GROUP BY, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_group_rollup-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_group_rollup-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 71</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_group_rollup?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_grouping_sets-3F'>
                <a name='method-i-supports_grouping_sets-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_grouping_sets?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports GROUPING SETS with GROUP BY, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_grouping_sets-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_grouping_sets-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 76</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_grouping_sets?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_insert_select-3F'>
                <a name='method-i-supports_insert_select-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_insert_select?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether this dataset supports the <code>insert_select</code> method for
                  returning all columns values directly from an insert query, false by
                  default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_insert_select-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_insert_select-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 82</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_insert_select?</span>&#x000A;  <span class="ruby-identifier">supports_returning?</span>(<span class="ruby-value">:insert</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_intersect_except-3F'>
                <a name='method-i-supports_intersect_except-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_intersect_except?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports the INTERSECT and EXCEPT compound operations,
                  true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_intersect_except-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_intersect_except-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 87</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_intersect_except?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_intersect_except_all-3F'>
                <a name='method-i-supports_intersect_except_all-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_intersect_except_all?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports the INTERSECT ALL and EXCEPT ALL compound
                  operations, true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_intersect_except_all-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_intersect_except_all-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 92</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_intersect_except_all?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_is_true-3F'>
                <a name='method-i-supports_is_true-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_is_true?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports the IS TRUE syntax, true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_is_true-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_is_true-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 97</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_is_true?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_join_using-3F'>
                <a name='method-i-supports_join_using-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_join_using?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports the JOIN table USING (column1, …) syntax, true
                  by default. If false, support is emulated using JOIN table ON
                  (table.column1 = other_table.column1).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_join_using-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_join_using-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 103</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_join_using?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_lateral_subqueries-3F'>
                <a name='method-i-supports_lateral_subqueries-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_lateral_subqueries?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports LATERAL for subqueries in the FROM or JOIN
                  clauses, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_lateral_subqueries-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_lateral_subqueries-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 108</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_lateral_subqueries?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_limits_in_correlated_subqueries-3F'>
                <a name='method-i-supports_limits_in_correlated_subqueries-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_limits_in_correlated_subqueries?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether limits are supported in correlated subqueries, true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_limits_in_correlated_subqueries-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_limits_in_correlated_subqueries-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 113</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_limits_in_correlated_subqueries?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_modifying_joins-3F'>
                <a name='method-i-supports_modifying_joins-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_modifying_joins?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether modifying joined datasets is supported, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_modifying_joins-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_modifying_joins-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 118</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_modifying_joins?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_multiple_column_in-3F'>
                <a name='method-i-supports_multiple_column_in-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_multiple_column_in?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the IN/NOT IN operators support multiple columns when an array of
                  values is given, true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_multiple_column_in-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_multiple_column_in-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 124</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_multiple_column_in?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_offsets_in_correlated_subqueries-3F'>
                <a name='method-i-supports_offsets_in_correlated_subqueries-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_offsets_in_correlated_subqueries?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether offsets are supported in correlated subqueries, true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_offsets_in_correlated_subqueries-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_offsets_in_correlated_subqueries-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 129</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_offsets_in_correlated_subqueries?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_ordered_distinct_on-3F'>
                <a name='method-i-supports_ordered_distinct_on-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_ordered_distinct_on?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports or can fully emulate the DISTINCT ON clause,
                  including respecting the ORDER BY clause, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_ordered_distinct_on-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_ordered_distinct_on-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 135</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_ordered_distinct_on?</span>&#x000A;  <span class="ruby-identifier">supports_distinct_on?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_regexp-3F'>
                <a name='method-i-supports_regexp-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_regexp?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports pattern matching by regular expressions, false
                  by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_regexp-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_regexp-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 140</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_regexp?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_replace-3F'>
                <a name='method-i-supports_replace-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_replace?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports REPLACE syntax, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_replace-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_replace-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 145</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_replace?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_returning-3F'>
                <a name='method-i-supports_returning-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_returning?</span>
                  <span class='arguments'>(type)</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the RETURNING clause is supported for the given type of query,
                  false by default. <code>type</code> can be :insert, :update, or :delete.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_returning-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_returning-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 151</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_returning?</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_select_all_and_column-3F'>
                <a name='method-i-supports_select_all_and_column-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_select_all_and_column?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the database supports <code>SELECT *, column FROM table</code>,
                  true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_select_all_and_column-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_select_all_and_column-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 161</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_select_all_and_column?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_skip_locked-3F'>
                <a name='method-i-supports_skip_locked-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_skip_locked?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports skipping locked rows when returning data,
                  false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_skip_locked-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_skip_locked-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 156</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_skip_locked?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_timestamp_timezones-3F'>
                <a name='method-i-supports_timestamp_timezones-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_timestamp_timezones?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports timezones in literal timestamps, false by
                  default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_timestamp_timezones-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_timestamp_timezones-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 166</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_timestamp_timezones?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_timestamp_usecs-3F'>
                <a name='method-i-supports_timestamp_usecs-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_timestamp_usecs?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports fractional seconds in literal timestamps, true
                  by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_timestamp_usecs-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_timestamp_usecs-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 171</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_timestamp_usecs?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_where_true-3F'>
                <a name='method-i-supports_where_true-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_where_true?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports WHERE TRUE (or WHERE 1 for databases that that
                  use 1 for true), true by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_where_true-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_where_true-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 182</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_where_true?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-supports_window_functions-3F'>
                <a name='method-i-supports_window_functions-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supports_window_functions?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether the dataset supports window functions, false by default.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-supports_window_functions-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-supports_window_functions-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/features.rb, line 176</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">supports_window_functions?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='5+-+Methods+related+to+dataset+graphing'>5 - Methods related to dataset graphing</a>
            </h2>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-add_graph_aliases'>
                <a name='method-i-add_graph_aliases'></a>
                <div class='synopsis'>
                  <span class='name'>add_graph_aliases</span>
                  <span class='arguments'>(graph_aliases)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds the given graph aliases to the list of graph aliases to use, unlike
                  <code>set_graph_aliases</code>, which replaces the list (the equivalent of
                  <code>select_append</code> when graphing).  See
                  <code>set_graph_aliases</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">add_graph_aliases</span>(<span class="ruby-identifier">some_alias</span><span class="ruby-operator">:</span> [:<span class="ruby-identifier">table</span>, :<span class="ruby-identifier">column</span>])&#x000A;<span class="ruby-comment"># SELECT ..., table.column AS some_alias</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-add_graph_aliases-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-add_graph_aliases-source'><span class="ruby-comment"># File lib/sequel/dataset/graph.rb, line 17</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_graph_aliases</span>(<span class="ruby-identifier">graph_aliases</span>)&#x000A;  <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:graph</span>]&#x000A;  <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">graph</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">ga</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:column_aliases</span>]))&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;cannot call add_graph_aliases on a dataset that has not been called with graph or set_graph_aliases&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">graph_aliases</span> = <span class="ruby-identifier">graph_alias_columns</span>(<span class="ruby-identifier">graph_aliases</span>)&#x000A;  <span class="ruby-identifier">select_append</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>).<span class="ruby-identifier">clone</span>(<span class="ruby-value">:graph</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">graph</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:column_aliases=</span><span class="ruby-operator">&gt;</span><span class="ruby-constant">Hash</span>[<span class="ruby-identifier">ga</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">graph_aliases</span>).<span class="ruby-identifier">freeze</span>).<span class="ruby-identifier">freeze</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-graph'>
                <a name='method-i-graph'></a>
                <div class='synopsis'>
                  <span class='name'>graph</span>
                  <span class='arguments'>(dataset, join_conditions = nil, options = OPTS, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Similar to <a href="Dataset.html#method-i-join_table">#join_table</a>, but
                  uses unambiguous aliases for selected columns and keeps metadata about the
                  aliases for use in other methods.</p>
                  
                  <p>Arguments:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>dataset </td><td>
                  <p>Can be a symbol (specifying a table), another dataset, or an <a
                  href="SQL/Identifier.html">SQL::Identifier</a>, <a
                  href="SQL/QualifiedIdentifier.html">SQL::QualifiedIdentifier</a>, or <a
                  href="SQL/AliasedExpression.html">SQL::AliasedExpression</a>.</p>
                  </td></tr><tr><td class='label'>join_conditions </td><td>
                  <p>Any condition(s) allowed by <code>join_table</code>.</p>
                  </td></tr><tr><td class='label'>block </td><td>
                  <p>A block that is passed to <code>join_table</code>.</p>
                  </td></tr></tbody></table>
                  
                  <p>Options:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>:from_self_alias </td><td>
                  <p>The alias to use when the receiver is not a graphed dataset but it contains
                  multiple FROM tables or a JOIN.  In this case, the receiver is wrapped in a
                  <a href="Dataset.html#method-i-from_self">#from_self</a> before graphing,
                  and this option determines the alias to use.</p>
                  </td></tr><tr><td class='label'>:implicit_qualifier </td><td>
                  <p>The qualifier of implicit conditions, see <a
                  href="Dataset.html#method-i-join_table">join_table</a>.</p>
                  </td></tr><tr><td class='label'>:join_only </td><td>
                  <p>Only join the tables, do not change the selected columns.</p>
                  </td></tr><tr><td class='label'>:join_type </td><td>
                  <p>The type of join to use (passed to <code>join_table</code>).  Defaults to
                  :left_outer.</p>
                  </td></tr><tr><td class='label'>:qualify</td><td>
                  <p>The type of qualification to do, see <a
                  href="Dataset.html#method-i-join_table">join_table</a>.</p>
                  </td></tr><tr><td class='label'>:select </td><td>
                  <p>An array of columns to select.  When not used, selects all columns in the
                  given dataset.  When set to false, selects no columns and is like simply
                  joining the tables, though graph keeps some metadata about the join that
                  makes it important to use <code>graph</code> instead of
                  <code>join_table</code>.</p>
                  </td></tr><tr><td class='label'>:table_alias </td><td>
                  <p>The alias to use for the table.  If not specified, doesn&#39;t alias the
                  table.  You will get an error if the alias (or table) name is used more
                  than once.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-graph-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-graph-source'><span class="ruby-comment"># File lib/sequel/dataset/graph.rb, line 52</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">graph</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">join_conditions</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-comment"># Allow the use of a dataset or symbol as the first argument</span>&#x000A;  <span class="ruby-comment"># Find the table name/dataset based on the argument</span>&#x000A;  <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:table_alias</span>]&#x000A;  <span class="ruby-identifier">table</span> = <span class="ruby-identifier">dataset</span>&#x000A;  <span class="ruby-identifier">create_dataset</span> = <span class="ruby-keyword">true</span>&#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">dataset</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-comment"># let alias be the same as the table name (sans any optional schema)</span>&#x000A;    <span class="ruby-comment"># unless alias explicitly given in the symbol using ___ notation and symbol splitting is enabled</span>&#x000A;    <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">table</span>).<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">last</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Dataset</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">simple_select_all?</span>&#x000A;      <span class="ruby-identifier">table</span> = <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>].<span class="ruby-identifier">first</span>&#x000A;      <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">table</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">dataset_alias</span>((<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:num_dataset_sources</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span>)<span class="ruby-operator">+</span><span class="ruby-value">1</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">create_dataset</span> = <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>&#x000A;    <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">value</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>&#x000A;    <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-identifier">table</span>).<span class="ruby-identifier">last</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">graph</span>(<span class="ruby-identifier">table</span>.<span class="ruby-identifier">expression</span>, <span class="ruby-identifier">join_conditions</span>, {<span class="ruby-value">:table_alias=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">table</span>.<span class="ruby-identifier">alias</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">options</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;The dataset argument should be a symbol or dataset&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">table_alias</span>.<span class="ruby-identifier">to_sym</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">create_dataset</span>&#x000A;    <span class="ruby-identifier">dataset</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-comment"># Raise Sequel::Error with explanation that the table alias has been used</span>&#x000A;  <span class="ruby-identifier">raise_alias_error</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;this #{options[:table_alias] ? &#39;alias&#39; : &#39;table&#39;} has already been been used, please specify &quot;</span>            <span class="ruby-node">&quot;#{options[:table_alias] ? &#39;a different alias&#39; : &#39;an alias via the :table_alias option&#39;}&quot;</span>) &#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-comment"># Only allow table aliases that haven&#39;t been used</span>&#x000A;  <span class="ruby-identifier">raise_alias_error</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:graph</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:graph</span>][<span class="ruby-value">:table_aliases</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:graph</span>][<span class="ruby-value">:table_aliases</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">table_alias</span>)&#x000A;  &#x000A;  <span class="ruby-identifier">table_alias_qualifier</span> = <span class="ruby-identifier">qualifier_from_alias_symbol</span>(<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-identifier">implicit_qualifier</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:implicit_qualifier</span>]&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-keyword">self</span>&#x000A;&#x000A;  <span class="ruby-comment"># Use a from_self if this is already a joined table (or from_self specifically disabled for graphs)</span>&#x000A;  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:graph_from_self</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@opts</span>[<span class="ruby-value">:graph</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">joined_dataset?</span>)&#x000A;    <span class="ruby-identifier">from_selfed</span> = <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-identifier">implicit_qualifier</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:from_self_alias</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">first_source</span>&#x000A;    <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">from_self</span>(<span class="ruby-value">:alias</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">implicit_qualifier</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  &#x000A;  <span class="ruby-comment"># Join the table early in order to avoid cloning the dataset twice</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:join_type</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:left_outer</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">join_conditions</span>, <span class="ruby-value">:table_alias=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">table_alias_qualifier</span>, <span class="ruby-value">:implicit_qualifier=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">implicit_qualifier</span>, <span class="ruby-value">:qualify=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">options</span>[<span class="ruby-value">:qualify</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ds</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:join_only</span>]&#x000A;&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>&#x000A;&#x000A;  <span class="ruby-comment"># Whether to include the table in the result set</span>&#x000A;  <span class="ruby-identifier">add_table</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:select</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:graph</span>]&#x000A;    <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">graph</span>.<span class="ruby-identifier">dup</span>&#x000A;    <span class="ruby-identifier">select</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:select</span>].<span class="ruby-identifier">dup</span>&#x000A;    [<span class="ruby-value">:column_aliases</span>, <span class="ruby-value">:table_aliases</span>, <span class="ruby-value">:column_alias_num</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">dup</span>}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-comment"># Setup the initial graph data structure if it doesn&#39;t exist</span>&#x000A;    <span class="ruby-identifier">qualifier</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first_source_alias</span>&#x000A;    <span class="ruby-identifier">master</span> = <span class="ruby-identifier">alias_symbol</span>(<span class="ruby-identifier">qualifier</span>)&#x000A;    <span class="ruby-identifier">raise_alias_error</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">master</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_alias</span>&#x000A;&#x000A;    <span class="ruby-comment"># Master hash storing all .graph related information</span>&#x000A;    <span class="ruby-identifier">graph</span> = {}&#x000A;&#x000A;    <span class="ruby-comment"># Associates column aliases back to tables and columns</span>&#x000A;    <span class="ruby-identifier">column_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:column_aliases</span>] = {}&#x000A;&#x000A;    <span class="ruby-comment"># Associates table alias (the master is never aliased)</span>&#x000A;    <span class="ruby-identifier">table_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:table_aliases</span>] = {<span class="ruby-identifier">master</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword">self</span>}&#x000A;&#x000A;    <span class="ruby-comment"># Keep track of the alias numbers used</span>&#x000A;    <span class="ruby-identifier">ca_num</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:column_alias_num</span>] = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)&#x000A;&#x000A;    <span class="ruby-comment"># All columns in the master table are never</span>&#x000A;    <span class="ruby-comment"># aliased, but are not included if set_graph_aliases</span>&#x000A;    <span class="ruby-comment"># has been used.</span>&#x000A;    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">select</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:select</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">select</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">select</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">select</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnAll</span>)))&#x000A;      <span class="ruby-identifier">select</span> = <span class="ruby-identifier">select</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sel</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;can&#39;t figure out alias to use for graphing for #{sel.inspect}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">_hash_key_symbol</span>(<span class="ruby-identifier">sel</span>)&#x000A;        <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>] = [<span class="ruby-identifier">master</span>, <span class="ruby-identifier">column</span>]&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">from_selfed</span>&#x000A;          <span class="ruby-comment"># Initial dataset was wrapped in subselect, selected all</span>&#x000A;          <span class="ruby-comment"># columns in the subselect, qualified by the subselect alias.</span>&#x000A;          <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">qualifier</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">identifier</span>(<span class="ruby-identifier">column</span>))&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-comment"># Initial dataset not wrapped in subslect, just make</span>&#x000A;          <span class="ruby-comment"># sure columns are qualified in some way.</span>&#x000A;          <span class="ruby-identifier">qualified_expression</span>(<span class="ruby-identifier">sel</span>, <span class="ruby-identifier">qualifier</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">select</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>] = [<span class="ruby-identifier">master</span>, <span class="ruby-identifier">column</span>]&#x000A;        <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">qualifier</span>, <span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-comment"># Add the table alias to the list of aliases</span>&#x000A;  <span class="ruby-comment"># Even if it isn&#39;t been used in the result set,</span>&#x000A;  <span class="ruby-comment"># we add a key for it with a nil value so we can check if it</span>&#x000A;  <span class="ruby-comment"># is used more than once</span>&#x000A;  <span class="ruby-identifier">table_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:table_aliases</span>]&#x000A;  <span class="ruby-identifier">table_aliases</span>[<span class="ruby-identifier">table_alias</span>] = <span class="ruby-identifier">add_table</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">dataset</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>&#x000A;&#x000A;  <span class="ruby-comment"># Add the columns to the selection unless we are ignoring them</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">add_table</span>&#x000A;    <span class="ruby-identifier">column_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:column_aliases</span>]&#x000A;    <span class="ruby-identifier">ca_num</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-value">:column_alias_num</span>]&#x000A;    <span class="ruby-comment"># Which columns to add to the result set</span>&#x000A;    <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:select</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">columns</span>&#x000A;    <span class="ruby-comment"># If the column hasn&#39;t been used yet, don&#39;t alias it.</span>&#x000A;    <span class="ruby-comment"># If it has been used, try table_column.</span>&#x000A;    <span class="ruby-comment"># If that has been used, try table_column_N </span>&#x000A;    <span class="ruby-comment"># using the next value of N that we know hasn&#39;t been</span>&#x000A;    <span class="ruby-comment"># used</span>&#x000A;    <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">col_alias</span>, <span class="ruby-identifier">identifier</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>]&#x000A;        <span class="ruby-identifier">column_alias</span> = <span class="ruby-value">:&quot;#{table_alias}_#{column}&quot;</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column_alias</span>]&#x000A;          <span class="ruby-identifier">column_alias_num</span> = <span class="ruby-identifier">ca_num</span>[<span class="ruby-identifier">column_alias</span>]&#x000A;          <span class="ruby-identifier">column_alias</span> = <span class="ruby-value">:&quot;#{column_alias}_#{column_alias_num}&quot;</span> &#x000A;          <span class="ruby-identifier">ca_num</span>[<span class="ruby-identifier">column_alias</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        [<span class="ruby-identifier">column_alias</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table_alias_qualifier</span>, <span class="ruby-identifier">column</span>), <span class="ruby-identifier">column_alias</span>)]&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">ident</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table_alias_qualifier</span>, <span class="ruby-identifier">column</span>)&#x000A;        [<span class="ruby-identifier">column</span>, <span class="ruby-identifier">ident</span>]&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">col_alias</span>] = [<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">column</span>].<span class="ruby-identifier">freeze</span>&#x000A;      <span class="ruby-identifier">select</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">identifier</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  [<span class="ruby-value">:column_aliases</span>, <span class="ruby-value">:table_aliases</span>, <span class="ruby-value">:column_alias_num</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">freeze</span>}&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-value">:graph=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">graph</span>.<span class="ruby-identifier">freeze</span>)&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">select</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-set_graph_aliases'>
                <a name='method-i-set_graph_aliases'></a>
                <div class='synopsis'>
                  <span class='name'>set_graph_aliases</span>
                  <span class='arguments'>(graph_aliases)</span>
                </div>
                <div class='description'>
                  
                  <p>This allows you to manually specify the graph aliases to use when using
                  graph.  You can use it to only select certain columns, and have those
                  columns mapped to specific aliases in the result set.  This is the
                  equivalent of <code>select</code> for a graphed dataset, and must be used
                  instead of <code>select</code> whenever graphing is used.</p>
                  
                  <p>graph_aliases should be a hash with keys being symbols of column aliases,
                  and values being either symbols or arrays with one to three elements. If
                  the value is a symbol, it is assumed to be the same as a one element array
                  containing that symbol. The first element of the array should be the table
                  alias symbol. The second should be the actual column name symbol.  If the
                  array only has a single element the column name symbol will be assumed to
                  be the same as the corresponding hash key. If the array has a third
                  element, it is used as the value returned, instead of
                  table_alias.column_name.</p>
                  
                  <pre>DB[:artists].graph(:albums, :artist_id: :id).&#x000A;  set_graph_aliases(name: :artists,&#x000A;                    album_name: [:albums, :name],&#x000A;                    forty_two: [:albums, :fourtwo, 42]).first&#x000A;# SELECT artists.name, albums.name AS album_name, 42 AS forty_two ...</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-set_graph_aliases-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-set_graph_aliases-source'><span class="ruby-comment"># File lib/sequel/dataset/graph.rb, line 227</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_graph_aliases</span>(<span class="ruby-identifier">graph_aliases</span>)&#x000A;  <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">graph_aliases</span> = <span class="ruby-identifier">graph_alias_columns</span>(<span class="ruby-identifier">graph_aliases</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:graph</span>]&#x000A;    <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>).<span class="ruby-identifier">clone</span>(<span class="ruby-value">:graph</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">graph</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:column_aliases=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">graph_aliases</span>.<span class="ruby-identifier">freeze</span>).<span class="ruby-identifier">freeze</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;cannot call #set_graph_aliases on an ungraphed dataset&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-ungraphed'>
                <a name='method-i-ungraphed'></a>
                <div class='synopsis'>
                  <span class='name'>ungraphed</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Remove the splitting of results into subhashes, and all metadata related to
                  the current graph (if any).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-ungraphed-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-ungraphed-source'><span class="ruby-comment"># File lib/sequel/dataset/graph.rb, line 238</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">ungraphed</span>&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:graph=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='6+-+Miscellaneous+methods'>6 - Miscellaneous methods</a>
            </h2>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-cache'>cache</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>Access the cache for the current dataset.  Should be used with caution, as
                      access to the cache is not thread safe without a mutex if other threads can
                      reference the dataset.  Symbol keys prefixed with an underscore are
                      reserved for internal use.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-db'>db</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The database related to this dataset.  This is the <a
                      href="Database.html">Database</a> instance that will execute all of this
                      dataset&#39;s queries.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-opts'>opts</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The hash of options for this dataset, keys are symbols.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(db)</span>
                </div>
                <div class='description'>
                  
                  <p>Constructs a new <a href="Dataset.html">Dataset</a> instance with an
                  associated database and  options. Datasets are usually constructed by
                  invoking the <a href="Database.html#method-i-5B-5D">Sequel::Database#[]</a>
                  method:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">posts</span>]</pre>
                  
                  <p><a href="Dataset.html">Sequel::Dataset</a> is an abstract class that is not
                  useful by itself. Each database adapter provides a subclass of <a
                  href="Dataset.html">Sequel::Dataset</a>, and has the <a
                  href="Database.html#method-i-dataset">Sequel::Database#dataset</a> method
                  return an instance of that subclass.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 24</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">db</span>)&#x000A;  <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>&#x000A;  <span class="ruby-ivar">@opts</span> = <span class="ruby-constant">OPTS</span>&#x000A;  <span class="ruby-ivar">@cache</span> = {}&#x000A;  <span class="ruby-identifier">freeze</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-3D-3D'>
                <a name='method-i-3D-3D'></a>
                <div class='synopsis'>
                  <span class='name'>==</span>
                  <span class='arguments'>(o)</span>
                </div>
                <div class='description'>
                  
                  <p>Define a hash value such that datasets with the same class, DB, and opts
                  will be considered equal.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-3D-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-3D-3D-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 33</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">o</span>)&#x000A;  <span class="ruby-identifier">o</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">db</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">db</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">opts</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-current_datetime'>
                <a name='method-i-current_datetime'></a>
                <div class='synopsis'>
                  <span class='name'>current_datetime</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>An object representing the current date or time, should be an instance of
                  <a
                  href="../Sequel.html#attribute-c-datetime_class">Sequel.datetime_class</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-current_datetime-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-current_datetime-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 39</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_datetime</span>&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">datetime_class</span>.<span class="ruby-identifier">now</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-dup'>
                <a name='method-i-dup'></a>
                <div class='synopsis'>
                  <span class='name'>dup</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Return self, as datasets are always frozen.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-dup-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-dup-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 49</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">dup</span>&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-each_server'>
                <a name='method-i-each_server'></a>
                <div class='synopsis'>
                  <span class='name'>each_server</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Yield a dataset for each server in the connection pool that is tied to that
                  server. Intended for use in sharded environments where all servers need to
                  be modified with the same data:</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">configs</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">key</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;setting&#39;</span>).<span class="ruby-identifier">each_server</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">ds</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">value</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;new_value&#39;</span>)}</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-each_server-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-each_server-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 58</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_server</span>&#x000A;  <span class="ruby-identifier">db</span>.<span class="ruby-identifier">servers</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">server</span>(<span class="ruby-identifier">s</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-eql-3F'>
                <a name='method-i-eql-3F'></a>
                <div class='synopsis'>
                  <span class='name'>eql?</span>
                  <span class='arguments'>(o)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias for ==</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-eql-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-eql-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 44</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">eql?</span>(<span class="ruby-identifier">o</span>)&#x000A;  <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">o</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-escape_like'>
                <a name='method-i-escape_like'></a>
                <div class='synopsis'>
                  <span class='name'>escape_like</span>
                  <span class='arguments'>(string)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the string with the LIKE metacharacters (% and _) escaped. Useful
                  for when the LIKE term is a user-provided string where metacharacters
                  should not be recognized. Example:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">ds</span>.<span class="ruby-identifier">escape_like</span>(<span class="ruby-string">&quot;foo\\%_&quot;</span>) <span class="ruby-comment"># &#39;foo\\\%\_&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-escape_like-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-escape_like-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 67</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">escape_like</span>(<span class="ruby-identifier">string</span>)&#x000A;  <span class="ruby-identifier">string</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/[\%_]/</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\\#{m}&quot;</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-first_source'>
                <a name='method-i-first_source'></a>
                <div class='synopsis'>
                  <span class='name'>first_source</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Alias of <code>first_source_alias</code></p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-first_source-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-first_source-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 90</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">first_source</span>&#x000A;  <span class="ruby-identifier">first_source_alias</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-first_source_alias'>
                <a name='method-i-first_source_alias'></a>
                <div class='synopsis'>
                  <span class='name'>first_source_alias</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The first source (primary table) for this dataset.  If the dataset
                  doesn&#39;t have a table, raises an <code>Error</code>.  If the table is
                  aliased, returns the aliased name.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first_source_alias</span>&#x000A;<span class="ruby-comment"># =&gt; :table</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">as</span>(:<span class="ruby-identifier">t</span>)].<span class="ruby-identifier">first_source_alias</span>&#x000A;<span class="ruby-comment"># =&gt; :t</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-first_source_alias-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-first_source_alias-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 102</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">first_source_alias</span>&#x000A;  <span class="ruby-identifier">source</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:from</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;No source specified for query&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">s</span> = <span class="ruby-identifier">source</span>.<span class="ruby-identifier">first</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>&#x000A;    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">alias</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-identifier">_</span>, <span class="ruby-identifier">_</span>, <span class="ruby-identifier">aliaz</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">s</span>)&#x000A;    <span class="ruby-identifier">aliaz</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">aliaz</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">s</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-first_source_table'>
                <a name='method-i-first_source_table'></a>
                <div class='synopsis'>
                  <span class='name'>first_source_table</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The first source (primary table) for this dataset.  If the dataset
                  doesn&#39;t have a table, raises an error.  If the table is aliased,
                  returns the original table, not the alias</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">first_source_table</span>&#x000A;<span class="ruby-comment"># =&gt; :table</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">as</span>(:<span class="ruby-identifier">t</span>)].<span class="ruby-identifier">first_source_table</span>&#x000A;<span class="ruby-comment"># =&gt; :table</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-first_source_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-first_source_table-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 127</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">first_source_table</span>&#x000A;  <span class="ruby-identifier">source</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:from</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;No source specified for query&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">s</span> = <span class="ruby-identifier">source</span>.<span class="ruby-identifier">first</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>&#x000A;    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">expression</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">aliaz</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">s</span>)&#x000A;    <span class="ruby-identifier">aliaz</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">sch</span> <span class="ruby-operator">?</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">to_sym</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">s</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-freeze'>
                <a name='method-i-freeze'></a>
                <div class='synopsis'>
                  <span class='name'>freeze</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Freeze the opts when freezing the dataset.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-freeze-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-freeze-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 73</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-hash'>
                <a name='method-i-hash'></a>
                <div class='synopsis'>
                  <span class='name'>hash</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Define a hash value such that datasets with the same class, DB, and opts,
                  will have the same hash value.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-hash-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-hash-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 145</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">hash</span>&#x000A;  [<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>, <span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>].<span class="ruby-identifier">hash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-inspect'>
                <a name='method-i-inspect'></a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a string representation of the dataset including the class name 
                  and the corresponding <a href="SQL.html">SQL</a> select statement.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-inspect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-inspect-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 151</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>&#x000A;  <span class="ruby-node">&quot;#&lt;#{visible_class_name}: #{sql.inspect}&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-joined_dataset-3F'>
                <a name='method-i-joined_dataset-3F'></a>
                <div class='synopsis'>
                  <span class='name'>joined_dataset?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Whether this dataset is a joined dataset (multiple FROM tables or any
                  JOINs).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-joined_dataset-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-joined_dataset-3F-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 156</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">joined_dataset?</span>&#x000A; <span class="ruby-operator">!</span><span class="ruby-operator">!</span>((<span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:join</span>])&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-row_number_column'>
                <a name='method-i-row_number_column'></a>
                <div class='synopsis'>
                  <span class='name'>row_number_column</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The alias to use for the row_number column, used when emulating OFFSET
                  support and for eager limit strategies</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-row_number_column-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-row_number_column-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 162</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">row_number_column</span>&#x000A;  <span class="ruby-value">:x_sequel_row_number_x</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-row_proc'>
                <a name='method-i-row_proc'></a>
                <div class='synopsis'>
                  <span class='name'>row_proc</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The <a href="Dataset.html#method-i-row_proc">#row_proc</a> for this
                  database, should be any object that responds to <code>call</code> with a
                  single hash argument and returns the object you want <a
                  href="Dataset.html#method-i-each">each</a> to return.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-row_proc-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-row_proc-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 168</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">row_proc</span>&#x000A;  <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:row_proc</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-split_alias'>
                <a name='method-i-split_alias'></a>
                <div class='synopsis'>
                  <span class='name'>split_alias</span>
                  <span class='arguments'>(c)</span>
                </div>
                <div class='description'>
                  
                  <p>Splits a possible implicit alias in <code>c</code>, handling both
                  SQL::AliasedExpressions and Symbols.  Returns an array of two elements,
                  with the first being the main expression, and the second being the alias.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-split_alias-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-split_alias-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 175</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">split_alias</span>(<span class="ruby-identifier">c</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">c</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-identifier">c_table</span>, <span class="ruby-identifier">column</span>, <span class="ruby-identifier">aliaz</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">c</span>)&#x000A;    [<span class="ruby-identifier">c_table</span> <span class="ruby-operator">?</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">c_table</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">to_sym</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">to_sym</span>, <span class="ruby-identifier">aliaz</span>]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>&#x000A;    [<span class="ruby-identifier">c</span>.<span class="ruby-identifier">expression</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">alias</span>]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinClause</span>&#x000A;    [<span class="ruby-identifier">c</span>.<span class="ruby-identifier">table</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">table_alias</span>]&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    [<span class="ruby-identifier">c</span>, <span class="ruby-keyword">nil</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-unqualified_column_for'>
                <a name='method-i-unqualified_column_for'></a>
                <div class='synopsis'>
                  <span class='name'>unqualified_column_for</span>
                  <span class='arguments'>(v)</span>
                </div>
                <div class='description'>
                  
                  <p>This returns an <a href="SQL/Identifier.html">SQL::Identifier</a> or <a
                  href="SQL/AliasedExpression.html">SQL::AliasedExpression</a> containing an
                  <a href="SQL.html">SQL</a> identifier that represents the unqualified
                  column for the given value. The given value should be a Symbol, <a
                  href="SQL/Identifier.html">SQL::Identifier</a>, <a
                  href="SQL/QualifiedIdentifier.html">SQL::QualifiedIdentifier</a>, or <a
                  href="SQL/AliasedExpression.html">SQL::AliasedExpression</a> containing one
                  of those.  In other cases, this returns nil.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-unqualified_column_for-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-unqualified_column_for-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 194</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">unqualified_column_for</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)&#x000A;    <span class="ruby-identifier">_unqualified_column_for</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-unused_table_alias'>
                <a name='method-i-unused_table_alias'></a>
                <div class='synopsis'>
                  <span class='name'>unused_table_alias</span>
                  <span class='arguments'>(table_alias, used_aliases = [])</span>
                </div>
                <div class='description'>
                  
                  <p>Creates a unique table alias that hasn&#39;t already been used in the
                  dataset. table_alias can be any type of object accepted by alias_symbol.
                  The symbol returned will be the implicit alias in the argument, possibly
                  appended with “_N” if the implicit alias has already been used, where N is
                  an integer starting at 0 and increasing until an unused one is found.</p>
                  
                  <p>You can provide a second addition array argument containing symbols that
                  should not be considered valid table aliases.  The current aliases for the
                  FROM and JOIN tables are automatically included in this array.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">unused_table_alias</span>(:<span class="ruby-identifier">t</span>)&#x000A;<span class="ruby-comment"># =&gt; :t</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">unused_table_alias</span>(:<span class="ruby-identifier">table</span>)&#x000A;<span class="ruby-comment"># =&gt; :table_0</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>, :<span class="ruby-identifier">table_0</span>].<span class="ruby-identifier">unused_table_alias</span>(:<span class="ruby-identifier">table</span>)&#x000A;<span class="ruby-comment"># =&gt; :table_1</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>, :<span class="ruby-identifier">table_0</span>].<span class="ruby-identifier">unused_table_alias</span>(:<span class="ruby-identifier">table</span>, [:<span class="ruby-identifier">table_1</span>, :<span class="ruby-identifier">table_2</span>])&#x000A;<span class="ruby-comment"># =&gt; :table_3</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-unused_table_alias-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-unused_table_alias-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 222</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">unused_table_alias</span>(<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">used_aliases</span> = [])&#x000A;  <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">alias_symbol</span>(<span class="ruby-identifier">table_alias</span>)&#x000A;  <span class="ruby-identifier">used_aliases</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>].<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">alias_symbol</span>(<span class="ruby-identifier">t</span>)} <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>]&#x000A;  <span class="ruby-identifier">used_aliases</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:join</span>].<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span> <span class="ruby-identifier">j</span>.<span class="ruby-identifier">table_alias</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">alias_alias_symbol</span>(<span class="ruby-identifier">j</span>.<span class="ruby-identifier">table_alias</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">alias_symbol</span>(<span class="ruby-identifier">j</span>.<span class="ruby-identifier">table</span>)} <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:join</span>]&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">used_aliases</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">table_alias</span>)&#x000A;    <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>&#x000A;    <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-identifier">ta</span> = <span class="ruby-value">:&quot;#{table_alias}_#{i}&quot;</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-identifier">ta</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">used_aliases</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">ta</span>)&#x000A;      <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> &#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">table_alias</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with_quote_identifiers'>
                <a name='method-i-with_quote_identifiers'></a>
                <div class='synopsis'>
                  <span class='name'>with_quote_identifiers</span>
                  <span class='arguments'>(v)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a modified dataset with quote_identifiers set.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with_quote_identifiers-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with_quote_identifiers-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 239</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_quote_identifiers</span>(<span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:quote_identifiers=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">v</span>, <span class="ruby-value">:skip_symbol_cache=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Protected Instance methods</h2>
              <div class='method protected-instance' id='method-method-i-_columns'>
                <a name='method-i-_columns'></a>
                <div class='synopsis'>
                  <span class='name'>_columns</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The cached columns for the current dataset.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-_columns-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-_columns-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 270</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">_columns</span>&#x000A;  <span class="ruby-identifier">cache_get</span>(<span class="ruby-value">:_columns</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-cache_get'>
                <a name='method-i-cache_get'></a>
                <div class='synopsis'>
                  <span class='name'>cache_get</span>
                  <span class='arguments'>(k)</span>
                </div>
                <div class='description'>
                  
                  <p>Retreive a value from the dataset&#39;s cache in a thread safe manner.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-cache_get-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-cache_get-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 252</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_get</span>(<span class="ruby-identifier">k</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@cache</span>[<span class="ruby-identifier">k</span>]}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-cache_set'>
                <a name='method-i-cache_set'></a>
                <div class='synopsis'>
                  <span class='name'>cache_set</span>
                  <span class='arguments'>(k, v)</span>
                </div>
                <div class='description'>
                  
                  <p>Set a value in the dataset&#39;s cache in a thread safe manner.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-cache_set-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-cache_set-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 257</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_set</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-ivar">@cache</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-method-i-clear_columns_cache'>
                <a name='method-i-clear_columns_cache'></a>
                <div class='synopsis'>
                  <span class='name'>clear_columns_cache</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Clear the columns hash for the current dataset.  This is not a thread safe
                  operation, so it should only be used if the dataset could not be used by
                  another thread (such as one that was just created via clone).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-clear_columns_cache-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-clear_columns_cache-source'><span class="ruby-comment"># File lib/sequel/dataset/misc.rb, line 265</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">clear_columns_cache</span>&#x000A;  <span class="ruby-ivar">@cache</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:_columns</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='8+-+Methods+related+to+prepared+statements+or+bound+variables'>8 - Methods related to prepared statements or bound variables</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>DEFAULT_PREPARED_STATEMENT_MODULE_METHODS</td>
                    <td>=</td>
                    <td class='context-item-value'>%w'execute execute_dui execute_insert'.freeze.each(&:freeze)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>PREPARED_ARG_PLACEHOLDER</td>
                    <td>=</td>
                    <td class='context-item-value'>LiteralString.new('?').freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>PREPARED_STATEMENT_MODULE_CODE</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      {
                      :bind => "opts = Hash[opts]; opts[:arguments] = bind_arguments".freeze,
                      :prepare => "sql = prepared_statement_name".freeze,
                      :prepare_bind => "sql = prepared_statement_name; opts = Hash[opts]; opts[:arguments] = bind_arguments".freeze
                      }.freeze
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-bind'>
                <a name='method-i-bind'></a>
                <div class='synopsis'>
                  <span class='name'>bind</span>
                  <span class='arguments'>(bind_vars={})</span>
                </div>
                <div class='description'>
                  
                  <p>Set the bind variables to use for the call.  If bind variables have already
                  been set for this dataset, they are updated with the contents of bind_vars.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">$id</span>).<span class="ruby-identifier">bind</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">call</span>(:<span class="ruby-identifier">first</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE id = ? LIMIT 1 -- (1)</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;1}</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-bind-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-bind-source'><span class="ruby-comment"># File lib/sequel/dataset/prepared_statements.rb, line 274</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">bind</span>(<span class="ruby-identifier">bind_vars</span>={})&#x000A;  <span class="ruby-identifier">bind_vars</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">bv</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:bind_vars</span>]&#x000A;    <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">bv</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">bind_vars</span>).<span class="ruby-identifier">freeze</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">bind_vars</span>.<span class="ruby-identifier">frozen?</span>&#x000A;      <span class="ruby-identifier">bind_vars</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">bind_vars</span>]&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">clone</span>(<span class="ruby-value">:bind_vars=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">bind_vars</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-call'>
                <a name='method-i-call'></a>
                <div class='synopsis'>
                  <span class='name'>call</span>
                  <span class='arguments'>(type, bind_variables={}, *values, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>For the given type (:select, :first, :insert, :insert_select, :update, or
                  :delete), run the sql with the bind variables specified in the hash. 
                  <code>values</code> is a hash passed to insert or update (if one of those
                  types is used), which may contain placeholders.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">$id</span>).<span class="ruby-identifier">call</span>(:<span class="ruby-identifier">first</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE id = ? LIMIT 1 -- (1)</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;1}</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-call-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-call-source'><span class="ruby-comment"># File lib/sequel/dataset/prepared_statements.rb, line 295</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">bind_variables</span>={}, <span class="ruby-operator">*</span><span class="ruby-identifier">values</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>, <span class="ruby-value">:extend=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">bound_variable_modules</span>).<span class="ruby-identifier">call</span>(<span class="ruby-identifier">bind_variables</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-prepare'>
                <a name='method-i-prepare'></a>
                <div class='synopsis'>
                  <span class='name'>prepare</span>
                  <span class='arguments'>(type, name, *values)</span>
                </div>
                <div class='description'>
                  
                  <p>Prepare an <a href="SQL.html">SQL</a> statement for later execution.  Takes
                  a type similar to <a href="Dataset.html#method-i-call">call</a>, and the
                  <code>name</code> symbol of the prepared statement.</p>
                  
                  <p>This returns a clone of the dataset extended with <a
                  href="Dataset/PreparedStatementMethods.html">PreparedStatementMethods</a>,
                  which you can <code>call</code> with the hash of bind variables to use. The
                  prepared statement is also stored in the associated <a
                  href="Database.html">Database</a>, where it can be called by name. The
                  following usage is identical:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">ps</span> = <span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">$name</span>).<span class="ruby-identifier">prepare</span>(:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">select_by_name</span>)&#x000A;&#x000A;<span class="ruby-identifier">ps</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Blah&#39;</span>)&#x000A;<span class="ruby-comment"># SELECT * FROM table WHERE name = ? -- (&#39;Blah&#39;)</span>&#x000A;<span class="ruby-comment"># =&gt; {:id=&gt;1, :name=&gt;&#39;Blah&#39;}</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>.<span class="ruby-identifier">call</span>(:<span class="ruby-identifier">select_by_name</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Blah&#39;</span>) <span class="ruby-comment"># Same thing</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-prepare-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-prepare-source'><span class="ruby-comment"># File lib/sequel/dataset/prepared_statements.rb, line 315</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>, <span class="ruby-value">:name=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">name</span>, <span class="ruby-value">:extend=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">prepared_statement_modules</span>, <span class="ruby-value">:no_delayed_evaluations=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_sql</span>&#x000A;  <span class="ruby-identifier">db</span>.<span class="ruby-identifier">set_prepared_statement</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">ps</span>)&#x000A;  <span class="ruby-identifier">ps</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Protected Instance methods</h2>
              <div class='method protected-instance' id='method-method-i-to_prepared_statement'>
                <a name='method-i-to_prepared_statement'></a>
                <div class='synopsis'>
                  <span class='name'>to_prepared_statement</span>
                  <span class='arguments'>(type, values=nil, opts=OPTS)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a cloned copy of the current dataset extended with <a
                  href="Dataset/PreparedStatementMethods.html">PreparedStatementMethods</a>,
                  setting the type and modify values.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-to_prepared_statement-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-to_prepared_statement-source'><span class="ruby-comment"># File lib/sequel/dataset/prepared_statements.rb, line 326</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)&#x000A;  <span class="ruby-identifier">mods</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:extend</span>] <span class="ruby-operator">||</span> []&#x000A;  <span class="ruby-identifier">mods</span> <span class="ruby-operator">+=</span> [<span class="ruby-constant">PreparedStatementMethods</span>]&#x000A;&#x000A;  <span class="ruby-identifier">bind</span>.&#x000A;    <span class="ruby-identifier">clone</span>(<span class="ruby-value">:prepared_statement_name=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>], <span class="ruby-value">:prepared_type=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">type</span>, <span class="ruby-value">:prepared_modify_values=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">values</span>, <span class="ruby-value">:orig_dataset=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">self</span>, <span class="ruby-value">:no_cache_sql=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword">true</span>, <span class="ruby-value">:prepared_args=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@opts</span>[<span class="ruby-value">:prepared_args</span>]<span class="ruby-operator">||</span>[], <span class="ruby-value">:no_delayed_evaluations=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-value">:no_delayed_evaluations</span>]).&#x000A;    <span class="ruby-identifier">with_extend</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">mods</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
          <div id='section'>
            <h2>
              <a name='9+-+Internal+Methods+relating+to+SQL+Creation'>9 - Internal Methods relating to SQL Creation</a>
            </h2>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>BITWISE_METHOD_MAP</td>
                    <td>=</td>
                    <td class='context-item-value'>{:& =>:BITAND, :| => :BITOR, :^ => :BITXOR}.freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COUNT_FROM_SELF_OPTS</td>
                    <td>=</td>
                    <td class='context-item-value'>[:distinct, :group, :sql, :limit, :offset, :compounds].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COUNT_OF_ALL_AS_COUNT</td>
                    <td>=</td>
                    <td class='context-item-value'>SQL::Function.new(:count, WILDCARD).as(:count)</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>DEFAULT</td>
                    <td>=</td>
                    <td class='context-item-value'>LiteralString.new('DEFAULT').freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>EXISTS</td>
                    <td>=</td>
                    <td class='context-item-value'>['EXISTS '.freeze].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>IS_LITERALS</td>
                    <td>=</td>
                    <td class='context-item-value'>{nil=>'NULL'.freeze, true=>'TRUE'.freeze, false=>'FALSE'.freeze}.freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>IS_OPERATORS</td>
                    <td>=</td>
                    <td class='context-item-value'>::Sequel::SQL::ComplexExpression::IS_OPERATORS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>LIKE_OPERATORS</td>
                    <td>=</td>
                    <td class='context-item-value'>::Sequel::SQL::ComplexExpression::LIKE_OPERATORS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>N_ARITY_OPERATORS</td>
                    <td>=</td>
                    <td class='context-item-value'>::Sequel::SQL::ComplexExpression::N_ARITY_OPERATORS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>QUALIFY_KEYS</td>
                    <td>=</td>
                    <td class='context-item-value'>[:select, :where, :having, :order, :group].freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>REGEXP_OPERATORS</td>
                    <td>=</td>
                    <td class='context-item-value'>::Sequel::SQL::ComplexExpression::REGEXP_OPERATORS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>TWO_ARITY_OPERATORS</td>
                    <td>=</td>
                    <td class='context-item-value'>::Sequel::SQL::ComplexExpression::TWO_ARITY_OPERATORS</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>WILDCARD</td>
                    <td>=</td>
                    <td class='context-item-value'>LiteralString.new('*').freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-clause_methods'>
                <a name='method-c-clause_methods'></a>
                <div class='synopsis'>
                  <span class='name'>clause_methods</span>
                  <span class='arguments'>(type, clauses)</span>
                </div>
                <div class='description'>
                  
                  <p>Given a type (e.g. select) and an array of clauses, return an array of
                  methods to call to build the <a href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-clause_methods-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-clause_methods-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 191</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">clause_methods</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">clauses</span>)&#x000A;  <span class="ruby-identifier">clauses</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">clause</span><span class="ruby-operator">|</span> <span class="ruby-value">:&quot;#{type}_#{clause}_sql&quot;</span>}.<span class="ruby-identifier">freeze</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-def_sql_method'>
                <a name='method-c-def_sql_method'></a>
                <div class='synopsis'>
                  <span class='name'>def_sql_method</span>
                  <span class='arguments'>(mod, type, clauses)</span>
                </div>
                <div class='description'>
                  
                  <p>Define a dataset literalization method for the given type in the given
                  module, using the given clauses.</p>
                  
                  <p>Arguments:</p>
                  <table class="rdoc-list note-list"><tbody><tr><td class='label'>mod </td><td>
                  <p>Module in which to define method</p>
                  </td></tr><tr><td class='label'>type </td><td>
                  <p>Type of <a href="SQL.html">SQL</a> literalization method to create, either
                  :select, :insert, :update, or :delete</p>
                  </td></tr><tr><td class='label'>clauses </td><td>
                  <p>array of clauses that make up the <a href="SQL.html">SQL</a> query for the
                  type.  This can either be a single array of symbols/strings, or it can be
                  an array of pairs, with the first element in each pair being an
                  if/elsif/else code fragment, and the second element in each pair being an
                  array of symbol/strings for the appropriate branch.</p>
                  </td></tr></tbody></table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-def_sql_method-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-def_sql_method-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 205</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">def_sql_method</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">clauses</span>)&#x000A;  <span class="ruby-identifier">priv</span> = <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:update</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:insert</span>&#x000A;  <span class="ruby-identifier">cacheable</span> = <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:select</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:delete</span>&#x000A;&#x000A;  <span class="ruby-identifier">lines</span> = []&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;private&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">priv</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;def #{&#39;_&#39; if priv}#{type}_sql&quot;</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;if sql = opts[:sql]; return static_sql(sql) end&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">priv</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;if sql = cache_get(:_#{type}_sql); return sql end&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cacheable</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;check_modification_allowed!&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;check_not_limited!(:delete)&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:delete</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;sql = @opts[:append_sql] || sql_string_origin&#39;</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">clauses</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)}&#x000A;    <span class="ruby-identifier">clauses</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">cs</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">i</span>&#x000A;      <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">clause_methods</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">cs</span>).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{x}(sql)&quot;</span>}) &#x000A;    <span class="ruby-keyword">end</span> &#x000A;    <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;end&#39;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">clause_methods</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">clauses</span>).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{x}(sql)&quot;</span>})&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;cache_set(:_#{type}_sql, sql) if cache_sql?&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cacheable</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;sql&#39;</span>&#x000A;  <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;end&#39;</span>&#x000A;&#x000A;  <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>), <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-aliased_expression_sql_append'>
                <a name='method-i-aliased_expression_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>aliased_expression_sql_append</span>
                  <span class='arguments'>(sql, ae)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of aliased expression to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-aliased_expression_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-aliased_expression_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 266</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">aliased_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ae</span>)&#x000A;  <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ae</span>.<span class="ruby-identifier">expression</span>)&#x000A;  <span class="ruby-identifier">as_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ae</span>.<span class="ruby-identifier">alias</span>, <span class="ruby-identifier">ae</span>.<span class="ruby-identifier">columns</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-array_sql_append'>
                <a name='method-i-array_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>array_sql_append</span>
                  <span class='arguments'>(sql, a)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of array to <a href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-array_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-array_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 272</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">array_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">a</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(NULL)&#39;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">a</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-boolean_constant_sql_append'>
                <a name='method-i-boolean_constant_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>boolean_constant_sql_append</span>
                  <span class='arguments'>(sql, constant)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of boolean constant to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-boolean_constant_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-boolean_constant_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 283</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">boolean_constant_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">constant</span>)&#x000A;  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">constant</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">constant</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_where_true?</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">constant</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39;(1 = 1)&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39;(1 = 0)&#39;</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">constant</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-case_expression_sql_append'>
                <a name='method-i-case_expression_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>case_expression_sql_append</span>
                  <span class='arguments'>(sql, ce)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of case expression to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-case_expression_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-case_expression_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 292</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">case_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ce</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(CASE&#39;</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">expression?</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">expression</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">w</span> = <span class="ruby-string">&quot; WHEN &quot;</span>&#x000A;  <span class="ruby-identifier">t</span> = <span class="ruby-string">&quot; THEN &quot;</span>&#x000A;  <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span>,<span class="ruby-identifier">r</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">w</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">c</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">t</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">r</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; ELSE &quot;</span>&#x000A;  <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">default</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; END)&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-cast_sql_append'>
                <a name='method-i-cast_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>cast_sql_append</span>
                  <span class='arguments'>(sql, expr, type)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of cast expression to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-cast_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-cast_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 312</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">cast_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;CAST(&#39;</span>&#x000A;  <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">expr</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; AS &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">cast_type_literal</span>(<span class="ruby-identifier">type</span>).<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-column_all_sql_append'>
                <a name='method-i-column_all_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>column_all_sql_append</span>
                  <span class='arguments'>(sql, ca)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of column all selection to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-column_all_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-column_all_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 320</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_all_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ca</span>)&#x000A;  <span class="ruby-identifier">qualified_identifier_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">ca</span>.<span class="ruby-identifier">table</span>, <span class="ruby-constant">WILDCARD</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-complex_expression_sql_append'>
                <a name='method-i-complex_expression_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>complex_expression_sql_append</span>
                  <span class='arguments'>(sql, op, args)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of complex expression to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-complex_expression_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-complex_expression_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 325</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">complex_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">op</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">IS_OPERATORS</span>&#x000A;    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>]&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">supports_is_true?</span>&#x000A;      <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-string">&#39;Invalid argument used for IS operator&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">val</span> = <span class="ruby-constant">IS_LITERALS</span>[<span class="ruby-identifier">r</span>]&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>])&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">op</span> <span class="ruby-operator">==</span> <span class="ruby-value">:IS</span>&#x000A;      <span class="ruby-identifier">complex_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-value">:&quot;=&quot;</span>, <span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">complex_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-value">:OR</span>, [<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:&quot;!=&quot;</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>), <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:IS</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>], <span class="ruby-keyword">nil</span>)])&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:IN</span>, <span class="ruby-value">:&quot;NOT IN&quot;</span>&#x000A;    <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]&#x000A;    <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>]&#x000A;    <span class="ruby-identifier">col_array</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;      <span class="ruby-identifier">val_array</span> = <span class="ruby-keyword">true</span>&#x000A;      <span class="ruby-identifier">empty_val_array</span> = <span class="ruby-identifier">vals</span> <span class="ruby-operator">==</span> []&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">empty_val_array</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">empty_array_value</span>(<span class="ruby-identifier">op</span>, <span class="ruby-identifier">cols</span>))&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">col_array</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_multiple_column_in?</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">val_array</span>&#x000A;          <span class="ruby-identifier">expr</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">vals</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">vs</span><span class="ruby-operator">|</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">from_value_pairs</span>(<span class="ruby-identifier">cols</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">vs</span>).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">c</span>, <span class="ruby-identifier">v</span>]})})&#x000A;          <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">op</span> <span class="ruby-operator">==</span> <span class="ruby-value">:IN</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">expr</span> <span class="ruby-operator">:</span> <span class="ruby-operator">~</span><span class="ruby-identifier">expr</span>)&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-identifier">old_vals</span> = <span class="ruby-identifier">vals</span>&#x000A;          <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">naked</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Dataset</span>)&#x000A;          <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">to_a</span>&#x000A;          <span class="ruby-identifier">val_cols</span> = <span class="ruby-identifier">old_vals</span>.<span class="ruby-identifier">columns</span>&#x000A;          <span class="ruby-identifier">complex_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">op</span>, [<span class="ruby-identifier">cols</span>, <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">map!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">val_cols</span>)}])&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-comment"># If the columns and values are both arrays, use array_sql instead of</span>&#x000A;        <span class="ruby-comment"># literal so that if values is an array of two element arrays, it</span>&#x000A;        <span class="ruby-comment"># will be treated as a value list instead of a condition specifier.</span>&#x000A;        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;        <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">cols</span>)&#x000A;        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">val_array</span>&#x000A;          <span class="ruby-identifier">array_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">vals</span>)&#x000A;        <span class="ruby-keyword">else</span>&#x000A;          <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">vals</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">cols</span>)&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">vals</span>)&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:LIKE</span>, <span class="ruby-value">:&#39;NOT LIKE&#39;</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>])&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>])&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; ESCAPE &quot;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-string">&quot;\\&quot;</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:ILIKE</span>, <span class="ruby-value">:&#39;NOT ILIKE&#39;</span>&#x000A;    <span class="ruby-identifier">complex_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, (<span class="ruby-identifier">op</span> <span class="ruby-operator">==</span> <span class="ruby-value">:ILIKE</span> <span class="ruby-operator">?</span> <span class="ruby-value">:LIKE</span> <span class="ruby-operator">:</span> <span class="ruby-value">:&quot;NOT LIKE&quot;</span>), <span class="ruby-identifier">args</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-value">:UPPER</span>, <span class="ruby-identifier">v</span>)})&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:**</span>&#x000A;    <span class="ruby-identifier">function_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-value">:power</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>))&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">TWO_ARITY_OPERATORS</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-constant">REGEXP_OPERATORS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">op</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_regexp?</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidOperation</span>, <span class="ruby-node">&quot;Pattern matching via regular expressions is not supported on #{db.database_type}&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>])&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>])&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">N_ARITY_OPERATORS</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;    <span class="ruby-identifier">c</span> = <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-identifier">op_str</span> = <span class="ruby-node">&quot; #{op} &quot;</span>&#x000A;    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op_str</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">a</span>)&#x000A;      <span class="ruby-identifier">c</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:NOT</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;NOT &#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>])&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:NOOP</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>])&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:&#39;B~&#39;</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;~&#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>])&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:extract</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;extract(&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; FROM &#39;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>])&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-node">&quot;invalid operator #{op}&quot;</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-constant_sql_append'>
                <a name='method-i-constant_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>constant_sql_append</span>
                  <span class='arguments'>(sql, constant)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of constant to <a href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-constant_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-constant_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 432</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">constant_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">constant</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">constant</span>.<span class="ruby-identifier">to_s</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-delayed_evaluation_sql_append'>
                <a name='method-i-delayed_evaluation_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>delayed_evaluation_sql_append</span>
                  <span class='arguments'>(sql, delay)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of delayed evaluation to <a href="SQL.html">SQL</a>
                  string, causing the delayed evaluation proc to be evaluated.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-delayed_evaluation_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-delayed_evaluation_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 438</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">delayed_evaluation_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">delay</span>)&#x000A;  <span class="ruby-comment"># Delayed evaluations are used specifically so the SQL</span>&#x000A;  <span class="ruby-comment"># can differ in subsequent calls, so we definitely don&#39;t</span>&#x000A;  <span class="ruby-comment"># want to cache the sql in this case.</span>&#x000A;  <span class="ruby-identifier">disable_sql_caching!</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">recorder</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:placeholder_literalizer</span>]&#x000A;    <span class="ruby-identifier">recorder</span>.<span class="ruby-identifier">use</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">lambda</span>{<span class="ruby-identifier">delay</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>)}, <span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">delay</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-function_sql_append'>
                <a name='method-i-function_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>function_sql_append</span>
                  <span class='arguments'>(sql, f)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of function call to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-function_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-function_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 452</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">function_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">f</span>)&#x000A;  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">name</span>&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">opts</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:emulate</span>]&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">emulate_function?</span>(<span class="ruby-identifier">name</span>)&#x000A;      <span class="ruby-identifier">emulate_function_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">f</span>)&#x000A;      <span class="ruby-keyword">return</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">name</span> = <span class="ruby-identifier">native_function_name</span>(<span class="ruby-identifier">name</span>) &#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;LATERAL &#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:lateral</span>]&#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">name</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_quoted_function_names?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:quoted</span>]&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_quoted_function_names?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:quoted</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;.&#39;</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_quoted_function_names?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:quoted</span>]&#x000A;      <span class="ruby-identifier">quote_identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:*</span>]&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;*&#39;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;DISTINCT &quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:distinct</span>]&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">f</span>.<span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">order</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:order</span>]&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; ORDER BY &quot;</span>&#x000A;      <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">order</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">group</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:within_group</span>]&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; WITHIN GROUP (ORDER BY &quot;</span>&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">group</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">filter</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:filter</span>]&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; FILTER (WHERE &quot;</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">filter</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">opts</span>[<span class="ruby-value">:filter_block</span>]))&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">window</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:over</span>]&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; OVER &#39;</span>&#x000A;    <span class="ruby-identifier">window_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">window</span>.<span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:with_ordinality</span>]&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; WITH ORDINALITY&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-join_clause_sql_append'>
                <a name='method-i-join_clause_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>join_clause_sql_append</span>
                  <span class='arguments'>(sql, jc)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of JOIN clause without ON or USING to <a
                  href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-join_clause_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-join_clause_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 524</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">join_clause_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">jc</span>)&#x000A;  <span class="ruby-identifier">table</span> = <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">table</span>&#x000A;  <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">table_alias</span>&#x000A;  <span class="ruby-identifier">table_alias</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">table</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">jc</span>.<span class="ruby-identifier">column_aliases</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">join_type_sql</span>(<span class="ruby-identifier">jc</span>.<span class="ruby-identifier">join_type</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; &#39;</span>&#x000A;  <span class="ruby-identifier">identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-identifier">as_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">column_aliases</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_alias</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-join_on_clause_sql_append'>
                <a name='method-i-join_on_clause_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>join_on_clause_sql_append</span>
                  <span class='arguments'>(sql, jc)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of JOIN ON clause to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-join_on_clause_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-join_on_clause_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 534</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">join_on_clause_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">jc</span>)&#x000A;  <span class="ruby-identifier">join_clause_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">jc</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; ON &#39;</span>&#x000A;  <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">jc</span>.<span class="ruby-identifier">on</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-join_using_clause_sql_append'>
                <a name='method-i-join_using_clause_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>join_using_clause_sql_append</span>
                  <span class='arguments'>(sql, jc)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of JOIN USING clause to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-join_using_clause_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-join_using_clause_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 541</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">join_using_clause_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">jc</span>)&#x000A;  <span class="ruby-identifier">join_clause_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">jc</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; USING (&#39;</span>&#x000A;  <span class="ruby-identifier">column_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">using</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-negative_boolean_constant_sql_append'>
                <a name='method-i-negative_boolean_constant_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>negative_boolean_constant_sql_append</span>
                  <span class='arguments'>(sql, constant)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of negative boolean constant to <a
                  href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-negative_boolean_constant_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-negative_boolean_constant_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 549</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">negative_boolean_constant_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">constant</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;NOT &#39;</span>&#x000A;  <span class="ruby-identifier">boolean_constant_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">constant</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-ordered_expression_sql_append'>
                <a name='method-i-ordered_expression_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>ordered_expression_sql_append</span>
                  <span class='arguments'>(sql, oe)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of ordered expression to <a href="SQL.html">SQL</a>
                  string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-ordered_expression_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-ordered_expression_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 555</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">ordered_expression_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">oe</span>)&#x000A;  <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">expression</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">oe</span>.<span class="ruby-identifier">descending</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39; DESC&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39; ASC&#39;</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">nulls</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:first</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; NULLS FIRST&quot;</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:last</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; NULLS LAST&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-placeholder_literal_string_sql_append'>
                <a name='method-i-placeholder_literal_string_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>placeholder_literal_string_sql_append</span>
                  <span class='arguments'>(sql, pls)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of placeholder literal string to <a
                  href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-placeholder_literal_string_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-placeholder_literal_string_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 567</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">placeholder_literal_string_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">pls</span>)&#x000A;  <span class="ruby-identifier">args</span> = <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">args</span>&#x000A;  <span class="ruby-identifier">str</span> = <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">str</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">parens</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">str</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">re</span> = <span class="ruby-node">/:(#{args.keys.map{|k| Regexp.escape(k.to_s)}.join(&#39;|&#39;)})\b/</span>&#x000A;      <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>&#x000A;        <span class="ruby-identifier">previous</span>, <span class="ruby-identifier">q</span>, <span class="ruby-identifier">str</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">partition</span>(<span class="ruby-identifier">re</span>)&#x000A;        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">previous</span>&#x000A;        <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[(<span class="ruby-node">$1</span><span class="ruby-operator">||</span><span class="ruby-identifier">q</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_s</span>).<span class="ruby-identifier">to_sym</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">empty?</span>&#x000A;        <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span>&#x000A;    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">s</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>[<span class="ruby-identifier">i</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">len</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Mismatched number of placeholders (#{str.length}) and placeholder arguments (#{args.length}) when using placeholder array&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">i</span> = <span class="ruby-value">-1</span>&#x000A;    <span class="ruby-identifier">match_len</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-identifier">previous</span>, <span class="ruby-identifier">q</span>, <span class="ruby-identifier">str</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">partition</span>(<span class="ruby-string">&#39;?&#39;</span>)&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">previous</span>&#x000A;      <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>)) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">empty?</span>&#x000A;        <span class="ruby-keyword">unless</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">match_len</span>&#x000A;          <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Mismatched number of placeholders (#{i+1}) and placeholder arguments (#{args.length}) when using placeholder array&quot;</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-keyword">break</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">parens</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-qualified_identifier_sql_append'>
                <a name='method-i-qualified_identifier_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>qualified_identifier_sql_append</span>
                  <span class='arguments'>(sql, table, column=(c = table.column; table = table.table; c))</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of qualified identifier to <a href="SQL.html">SQL</a>
                  string. If 3 arguments are given, the 2nd should be the table/qualifier and
                  the third should be column/qualified.  If 2 arguments are given, the 2nd
                  should be an <a
                  href="SQL/QualifiedIdentifier.html">SQL::QualifiedIdentifier</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-qualified_identifier_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-qualified_identifier_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 613</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">qualified_identifier_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">column</span>=(<span class="ruby-identifier">c</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">column</span>; <span class="ruby-identifier">table</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">table</span>; <span class="ruby-identifier">c</span>))&#x000A;  <span class="ruby-identifier">identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;.&#39;</span>&#x000A;  <span class="ruby-identifier">identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-quote_identifier_append'>
                <a name='method-i-quote_identifier_append'></a>
                <div class='synopsis'>
                  <span class='name'>quote_identifier_append</span>
                  <span class='arguments'>(sql, name)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of unqualified identifier to <a
                  href="SQL.html">SQL</a> string. Adds quoting to identifiers (columns and
                  tables). If identifiers are not being quoted, returns name as a string.  If
                  identifiers are being quoted quote the name with quoted_identifier.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-quote_identifier_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-quote_identifier_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 623</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">quote_identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">LiteralString</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">name</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>)&#x000A;    <span class="ruby-identifier">name</span> = <span class="ruby-identifier">input_identifier</span>(<span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">quote_identifiers?</span>&#x000A;      <span class="ruby-identifier">quoted_identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">name</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-quote_schema_table_append'>
                <a name='method-i-quote_schema_table_append'></a>
                <div class='synopsis'>
                  <span class='name'>quote_schema_table_append</span>
                  <span class='arguments'>(sql, table)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of identifier or unqualified identifier to <a
                  href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-quote_schema_table_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-quote_schema_table_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 638</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">quote_schema_table_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-identifier">schema</span>, <span class="ruby-identifier">table</span> = <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">schema</span>&#x000A;    <span class="ruby-identifier">quote_identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">schema</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;.&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">quote_identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">table</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-quoted_identifier_append'>
                <a name='method-i-quoted_identifier_append'></a>
                <div class='synopsis'>
                  <span class='name'>quoted_identifier_append</span>
                  <span class='arguments'>(sql, name)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of quoted identifier to <a href="SQL.html">SQL</a>
                  string. This method quotes the given name with the <a
                  href="SQL.html">SQL</a> standard double quote.  should be overridden by
                  subclasses to provide quoting not matching the <a href="SQL.html">SQL</a>
                  standard, such as backtick (used by MySQL and SQLite).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-quoted_identifier_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-quoted_identifier_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 651</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">quoted_identifier_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&quot;&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&#39;&quot;&#39;</span>, <span class="ruby-string">&#39;&quot;&quot;&#39;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&quot;&#39;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-schema_and_table'>
                <a name='method-i-schema_and_table'></a>
                <div class='synopsis'>
                  <span class='name'>schema_and_table</span>
                  <span class='arguments'>(table_name, sch=nil)</span>
                </div>
                <div class='description'>
                  
                  <p>Split the schema information from the table, returning two strings, one for
                  the schema and one for the table.  The returned schema may be nil, but the
                  table will always have a string value.</p>
                  
                  <p>Note that this function does not handle tables with more than one level of
                  qualification (e.g. database.schema.table on Microsoft <a
                  href="SQL.html">SQL</a> Server).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-schema_and_table-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-schema_and_table-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 662</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">sch</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-identifier">sch</span> = <span class="ruby-identifier">sch</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">sch</span>&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">table_name</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>&#x000A;    <span class="ruby-identifier">s</span>, <span class="ruby-identifier">t</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">table_name</span>)&#x000A;    [<span class="ruby-identifier">s</span><span class="ruby-operator">||</span><span class="ruby-identifier">sch</span>, <span class="ruby-identifier">t</span>]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>&#x000A;    [<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">table</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">column</span>.<span class="ruby-identifier">to_s</span>]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>&#x000A;    [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>]&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>&#x000A;    [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>]&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;table_name should be a Symbol, SQL::QualifiedIdentifier, SQL::Identifier, or String&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-split_qualifiers'>
                <a name='method-i-split_qualifiers'></a>
                <div class='synopsis'>
                  <span class='name'>split_qualifiers</span>
                  <span class='arguments'>(table_name, *args)</span>
                </div>
                <div class='description'>
                  
                  <p>Splits table_name into an array of strings.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">ds</span>.<span class="ruby-identifier">split_qualifiers</span>(:<span class="ruby-identifier">s</span>) <span class="ruby-comment"># [&#39;s&#39;]</span>&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">t</span>][:<span class="ruby-identifier">s</span>]) <span class="ruby-comment"># [&#39;t&#39;, &#39;s&#39;]</span>&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">d</span>][:<span class="ruby-identifier">t</span>][:<span class="ruby-identifier">s</span>]) <span class="ruby-comment"># [&#39;d&#39;, &#39;t&#39;, &#39;s&#39;]</span>&#x000A;<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">h</span>][:<span class="ruby-identifier">d</span>], <span class="ruby-constant">Sequel</span>[:<span class="ruby-identifier">t</span>][:<span class="ruby-identifier">s</span>])) <span class="ruby-comment"># [&#39;h&#39;, &#39;d&#39;, &#39;t&#39;, &#39;s&#39;]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-split_qualifiers-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-split_qualifiers-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 685</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">table_name</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>&#x000A;    <span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">table</span>, <span class="ruby-keyword">nil</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">split_qualifiers</span>(<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">column</span>, <span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span> = <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-identifier">sch</span> <span class="ruby-operator">?</span> [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>] <span class="ruby-operator">:</span> [<span class="ruby-identifier">table</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-subscript_sql_append'>
                <a name='method-i-subscript_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>subscript_sql_append</span>
                  <span class='arguments'>(sql, s)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of subscripts (SQL array accesses) to <a
                  href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-subscript_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-subscript_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 696</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">subscript_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">s</span>)&#x000A;  <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">s</span>.<span class="ruby-identifier">expression</span>)&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;[&#39;</span>&#x000A;  <span class="ruby-identifier">sub</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">sub</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">range</span> = <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">first</span>).<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Range</span>)&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">range</span>.<span class="ruby-identifier">begin</span>)&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;:&#39;</span>&#x000A;    <span class="ruby-identifier">e</span> = <span class="ruby-identifier">range</span>.<span class="ruby-identifier">end</span>&#x000A;    <span class="ruby-identifier">e</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">range</span>.<span class="ruby-identifier">exclude_end?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">e</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">s</span>.<span class="ruby-identifier">sub</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;]&#39;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-window_sql_append'>
                <a name='method-i-window_sql_append'></a>
                <div class='synopsis'>
                  <span class='name'>window_sql_append</span>
                  <span class='arguments'>(sql, opts)</span>
                </div>
                <div class='description'>
                  
                  <p>Append literalization of windows (for window functions) to <a
                  href="SQL.html">SQL</a> string.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-window_sql_append-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-window_sql_append-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 713</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">window_sql_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&#39;This dataset does not support window functions&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_window_functions?</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(&#39;</span>&#x000A;  <span class="ruby-identifier">window</span>, <span class="ruby-identifier">part</span>, <span class="ruby-identifier">order</span>, <span class="ruby-identifier">frame</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-value">:window</span>, <span class="ruby-value">:partition</span>, <span class="ruby-value">:order</span>, <span class="ruby-value">:frame</span>)&#x000A;  <span class="ruby-identifier">space</span> = <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-identifier">space_s</span> = <span class="ruby-string">&#39; &#39;</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">window</span>&#x000A;    <span class="ruby-identifier">literal_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">window</span>)&#x000A;    <span class="ruby-identifier">space</span> = <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">part</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">space_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">space</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;PARTITION BY &quot;</span>&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-constant">Array</span>(<span class="ruby-identifier">part</span>))&#x000A;    <span class="ruby-identifier">space</span> = <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">order</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">space_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">space</span>&#x000A;    <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;ORDER BY &quot;</span>&#x000A;    <span class="ruby-identifier">expression_list_append</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-constant">Array</span>(<span class="ruby-identifier">order</span>))&#x000A;    <span class="ruby-identifier">space</span> = <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">frame</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>&#x000A;      <span class="ruby-comment"># nothing</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:all</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">space_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">space</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING&quot;</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:rows</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">space_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">space</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW&quot;</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">space_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">space</span>&#x000A;      <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">frame</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;invalid window frame clause, should be :all, :rows, a string, or nil&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;)&#39;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Protected Instance methods</h2>
              <div class='method protected-instance' id='method-method-i-compound_from_self'>
                <a name='method-i-compound_from_self'></a>
                <div class='synopsis'>
                  <span class='name'>compound_from_self</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Return a <a href="Dataset.html#method-i-from_self">#from_self</a> dataset
                  if an order or limit is specified, so it works as expected with UNION,
                  EXCEPT, and INTERSECT clauses.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-compound_from_self-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-compound_from_self-source'><span class="ruby-comment"># File lib/sequel/dataset/sql.rb, line 757</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">compound_from_self</span>&#x000A;  (<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:sql</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:limit</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:order</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-value">:offset</span>]) <span class="ruby-operator">?</span> <span class="ruby-identifier">from_self</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="https://github.com/rdoc/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
    </div>
  </body>
</html>
