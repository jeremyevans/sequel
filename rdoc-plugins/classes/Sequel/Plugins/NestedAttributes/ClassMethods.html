<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Sequel::Plugins::NestedAttributes::ClassMethods</title>
    <meta content='text/html; charset=US-ASCII' http-equiv='Content-Type'>
    <link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>module</span>
          Sequel::Plugins::NestedAttributes::ClassMethods
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../../files/lib/sequel/plugins/nested_attributes_rb.html">lib/sequel/plugins/nested_attributes.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../NestedAttributes.html">NestedAttributes</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'></div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-nested_attributes">nested_attributes</a></li>
              <li><a target="docwin" href="#attribute-i-nested_attributes_module">nested_attributes_module</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-nested_attributes_module'>nested_attributes_module</a>
                    </td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <p>Module to store the <a
                      href="ClassMethods.html#method-i-nested_attributes">#nested_attributes</a>
                      setter methods, so they can call be overridden and call super to get the
                      default behavior</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-nested_attributes'>
                <a name='method-i-nested_attributes'></a>
                <div class='synopsis'>
                  <span class='name'>nested_attributes</span>
                  <span class='arguments'>(*associations, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Allow nested attributes to be set for the given associations.  Options:</p>
                  <ul><li>
                  <p>:destroy - Allow destruction of nested records.</p>
                  </li><li>
                  <p>:fields - If provided, should be an <a href="../../../Array.html">Array</a>
                  or proc. If it is an array, restricts the fields allowed to be modified
                  through the association_attributes= method to the specific fields given. If
                  it is a proc, it will be called with the associated object and should
                  return an array of the allowable fields.</p>
                  </li><li>
                  <p>:limit - For *_to_many associations, a limit on the number of records that
                  will be processed, to prevent denial of service attacks.</p>
                  </li><li>
                  <p>:reject_if - A proc that is given each attribute hash before it is passed
                  to its associated object. If the proc returns a truthy value, the attribute
                  hash is ignored.</p>
                  </li><li>
                  <p>:remove - Allow disassociation of nested records (can remove the associated
                  object from the parent object, but not destroy the associated object).</p>
                  </li><li>
                  <p>:strict - Kept for backward compatibility. Setting it to false is
                  equivalent to setting :unmatched_pk to :ignore.</p>
                  </li><li>
                  <p>:transform - A proc to transform attribute hashes before they are passed to
                  associated object. Takes two arguments, the parent object and the attribute
                  hash. Uses the return value as the new attribute hash.</p>
                  </li><li>
                  <p>:unmatched_pk - Specify the action to be taken if a primary key is provided
                  in a record, but it doesn&#39;t match an existing associated object. Set to
                  :create to create a new object with that primary key, :ignore to ignore the
                  record, or :raise to raise an error. The default is :raise.</p>
                  </li></ul>
                  
                  <p>If a block is provided, it is used to set the :reject_if option.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-nested_attributes-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-nested_attributes-source'><span class="ruby-comment"># File lib/sequel/plugins/nested_attributes.rb, line 110</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">nested_attributes</span>(*<span class="ruby-identifier">associations</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">include</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">nested_attributes_module</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Module</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">nested_attributes_module</span>&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">associations</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">associations</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}&#x000A;  <span class="ruby-identifier">reflections</span> = <span class="ruby-identifier">associations</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">association_reflection</span>(<span class="ruby-identifier">a</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;no association named #{a} for #{self}&quot;</span>)}&#x000A;  <span class="ruby-identifier">reflections</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">r</span>[<span class="ruby-value">:nested_attributes</span>] = <span class="ruby-identifier">opts</span>&#x000A;    <span class="ruby-identifier">r</span>[<span class="ruby-value">:nested_attributes</span>][<span class="ruby-value">:unmatched_pk</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:strict</span>) <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">?</span> <span class="ruby-value">:ignore</span> <span class="ruby-operator">:</span> <span class="ruby-value">:raise</span>&#x000A;    <span class="ruby-identifier">r</span>[<span class="ruby-value">:nested_attributes</span>][<span class="ruby-value">:reject_if</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-identifier">def_nested_attribute_method</span>(<span class="ruby-identifier">r</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
