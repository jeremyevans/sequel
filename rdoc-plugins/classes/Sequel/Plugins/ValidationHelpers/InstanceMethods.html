<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Sequel::Plugins::ValidationHelpers::InstanceMethods</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Sequel::Plugins::ValidationHelpers::InstanceMethods
</h1>
<ol class='paths'>
<li>
<a href="../../../../files/lib/sequel/plugins/validation_helpers_rb.html">lib/sequel/plugins/validation_helpers.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'></div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-validates_exact_length">validates_exact_length</a></li>
<li><a href="#method-i-validates_format">validates_format</a></li>
<li><a href="#method-i-validates_includes">validates_includes</a></li>
<li><a href="#method-i-validates_integer">validates_integer</a></li>
<li><a href="#method-i-validates_length_range">validates_length_range</a></li>
<li><a href="#method-i-validates_max_length">validates_max_length</a></li>
<li><a href="#method-i-validates_max_value">validates_max_value</a></li>
<li><a href="#method-i-validates_min_length">validates_min_length</a></li>
<li><a href="#method-i-validates_min_value">validates_min_value</a></li>
<li><a href="#method-i-validates_no_null_byte">validates_no_null_byte</a></li>
<li><a href="#method-i-validates_not_null">validates_not_null</a></li>
<li><a href="#method-i-validates_numeric">validates_numeric</a></li>
<li><a href="#method-i-validates_operator">validates_operator</a></li>
<li><a href="#method-i-validates_presence">validates_presence</a></li>
<li><a href="#method-i-validates_schema_types">validates_schema_types</a></li>
<li><a href="#method-i-validates_type">validates_type</a></li>
<li><a href="#method-i-validates_unique">validates_unique</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='methods'>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-validates_exact_length'>
<a name='method-i-validates_exact_length'></a>
<div class='synopsis'>
<span class='name'>validates_exact_length</span><span class='arguments'>(exact, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check that the attribute values are the given exact length.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_exact_length-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_exact_length-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">105</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_exact_length</span>(<span class="ruby-identifier">exact</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">106</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:exact_length</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">exact</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">exact</span>}
<span class="line-num">107</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_format'>
<a name='method-i-validates_format'></a>
<div class='synopsis'>
<span class='name'>validates_format</span><span class='arguments'>(with, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check the string representation of the attribute value(s) against the regular expression with.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_format-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_format-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">110</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_format</span>(<span class="ruby-identifier">with</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">111</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:format</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">with</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">with</span>}
<span class="line-num">112</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_includes'>
<a name='method-i-validates_includes'></a>
<div class='synopsis'>
<span class='name'>validates_includes</span><span class='arguments'>(set, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) is included in the given set.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_includes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_includes-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">115</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_includes</span>(<span class="ruby-identifier">set</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">116</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:includes</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">set</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">set</span>.<span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">set</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:cover?</span>) <span class="ruby-operator">?</span> <span class="ruby-value">:cover?</span> <span class="ruby-operator">:</span> <span class="ruby-value">:include?</span>, <span class="ruby-identifier">v</span>)}
<span class="line-num">117</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_integer'>
<a name='method-i-validates_integer'></a>
<div class='synopsis'>
<span class='name'>validates_integer</span><span class='arguments'>(atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) string representation is a valid integer.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_integer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_integer-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">120</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_integer</span>(<span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">121</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:integer</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
<span class="line-num">122</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">123</span>       <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
<span class="line-num">124</span>       <span class="ruby-keyword">nil</span>
<span class="line-num">125</span>     <span class="ruby-keyword">rescue</span>
<span class="line-num">126</span>       <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>)
<span class="line-num">127</span>     <span class="ruby-keyword">end</span>
<span class="line-num">128</span>   <span class="ruby-keyword">end</span>
<span class="line-num">129</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_length_range'>
<a name='method-i-validates_length_range'></a>
<div class='synopsis'>
<span class='name'>validates_length_range</span><span class='arguments'>(range, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check that the attribute values length is in the specified range.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_length_range-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_length_range-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">132</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_length_range</span>(<span class="ruby-identifier">range</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">133</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:length_range</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">range</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">range</span>.<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span>)}
<span class="line-num">134</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_max_length'>
<a name='method-i-validates_max_length'></a>
<div class='synopsis'>
<span class='name'>validates_max_length</span><span class='arguments'>(max, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check that the attribute values are not longer than the given max length.</p>

<p>Accepts a :nil_message option that is the error message to use when the value is nil instead of being too long.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_max_length-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_max_length-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">140</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_max_length</span>(<span class="ruby-identifier">max</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">141</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:max_length</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
<span class="line-num">142</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">143</span>       <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:nil_message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">default_validation_helpers_options</span>(<span class="ruby-value">:max_length</span>)[<span class="ruby-value">:nil_message</span>])
<span class="line-num">144</span>     <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max</span>
<span class="line-num">145</span>       <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">max</span>)
<span class="line-num">146</span>     <span class="ruby-keyword">end</span>
<span class="line-num">147</span>   <span class="ruby-keyword">end</span>
<span class="line-num">148</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_max_value'>
<a name='method-i-validates_max_value'></a>
<div class='synopsis'>
<span class='name'>validates_max_value</span><span class='arguments'>(max, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check that the attribute values are not greater that the given maximum value. Does not perform validation if attribute value is nil. You should only call this if you have checked the attribute value has the expected type.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_max_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_max_value-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">153</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_max_value</span>(<span class="ruby-identifier">max</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">154</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:max_value</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
<span class="line-num">155</span>     <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">max</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max</span>
<span class="line-num">156</span>   <span class="ruby-keyword">end</span>
<span class="line-num">157</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_min_length'>
<a name='method-i-validates_min_length'></a>
<div class='synopsis'>
<span class='name'>validates_min_length</span><span class='arguments'>(min, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check that the attribute values are not shorter than the given min length.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_min_length-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_min_length-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">160</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_min_length</span>(<span class="ruby-identifier">min</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">161</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:min_length</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">min</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">min</span>}
<span class="line-num">162</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_min_value'>
<a name='method-i-validates_min_value'></a>
<div class='synopsis'>
<span class='name'>validates_min_value</span><span class='arguments'>(min, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check that the attribute values are not less that the given minimum value. Does not perform validation if attribute value is nil. You should only call this if you have checked the attribute value has the expected type.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_min_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_min_value-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">167</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_min_value</span>(<span class="ruby-identifier">min</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">168</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:min_value</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
<span class="line-num">169</span>     <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">min</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">min</span>
<span class="line-num">170</span>   <span class="ruby-keyword">end</span>
<span class="line-num">171</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_no_null_byte'>
<a name='method-i-validates_no_null_byte'></a>
<div class='synopsis'>
<span class='name'>validates_no_null_byte</span><span class='arguments'>(atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) does not contain a null (“0”, ASCII NUL) byte.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_no_null_byte-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_no_null_byte-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">179</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_no_null_byte</span>(<span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">180</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:no_null_byte</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;\0&quot;</span>)}
<span class="line-num">181</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_not_null'>
<a name='method-i-validates_not_null'></a>
<div class='synopsis'>
<span class='name'>validates_not_null</span><span class='arguments'>(atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) are not NULL/nil.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_not_null-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_not_null-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">174</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_not_null</span>(<span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">175</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:not_null</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>}
<span class="line-num">176</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_numeric'>
<a name='method-i-validates_numeric'></a>
<div class='synopsis'>
<span class='name'>validates_numeric</span><span class='arguments'>(atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) string representation is a valid float.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_numeric-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_numeric-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">184</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_numeric</span>(<span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">185</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:numeric</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
<span class="line-num">186</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">187</span>       <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Float</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
<span class="line-num">188</span>       <span class="ruby-keyword">nil</span>
<span class="line-num">189</span>     <span class="ruby-keyword">rescue</span>
<span class="line-num">190</span>       <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>)
<span class="line-num">191</span>     <span class="ruby-keyword">end</span>
<span class="line-num">192</span>   <span class="ruby-keyword">end</span>
<span class="line-num">193</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_operator'>
<a name='method-i-validates_operator'></a>
<div class='synopsis'>
<span class='name'>validates_operator</span><span class='arguments'>(operator, rhs, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) against a specified value and operation, e.g. <a href="InstanceMethods.html#method-i-validates_operator"><code>validates_operator</code></a>(:&gt;, 3, :value) validates that value &gt; 3.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_operator-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_operator-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">197</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_operator</span>(<span class="ruby-identifier">operator</span>, <span class="ruby-identifier">rhs</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">198</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:operator</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">operator</span>, <span class="ruby-identifier">rhs</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">operator</span>, <span class="ruby-identifier">rhs</span>)}
<span class="line-num">199</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_presence'>
<a name='method-i-validates_presence'></a>
<div class='synopsis'>
<span class='name'>validates_presence</span><span class='arguments'>(atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check attribute value(s) is not considered blank by the database, but allow false values.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_presence-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_presence-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">224</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_presence</span>(<span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">225</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:presence</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">m</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">db</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:blank_object?</span>, <span class="ruby-identifier">v</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span>}
<span class="line-num">226</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_schema_types'>
<a name='method-i-validates_schema_types'></a>
<div class='synopsis'>
<span class='name'>validates_schema_types</span><span class='arguments'>(atts=keys, opts=OPTS)</span>

</div>
<div class='description'>

<p>Validates for all of the model columns (or just the given columns) that the column value is an instance of the expected class based on the column’s schema type.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_schema_types-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_schema_types-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">204</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_schema_types</span>(<span class="ruby-identifier">atts</span>=<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">205</span>   <span class="ruby-constant">Array</span>(<span class="ruby-identifier">atts</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
<span class="line-num">206</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">schema_type_class</span>(<span class="ruby-identifier">k</span>)
<span class="line-num">207</span>       <span class="ruby-identifier">validates_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">k</span>, {<span class="ruby-value">:allow_nil</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">208</span>     <span class="ruby-keyword">end</span>
<span class="line-num">209</span>   <span class="ruby-keyword">end</span>
<span class="line-num">210</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_type'>
<a name='method-i-validates_type'></a>
<div class='synopsis'>
<span class='name'>validates_type</span><span class='arguments'>(klass, atts, opts=OPTS)</span>

</div>
<div class='description'>

<p>Check if value is an instance of a class.  If <code>klass</code> is an array, the value must be an instance of one of the classes in the array.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_type-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_type-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">214</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_type</span>(<span class="ruby-identifier">klass</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">215</span>   <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
<span class="line-num">216</span>   <span class="ruby-identifier">validatable_attributes_for_type</span>(<span class="ruby-value">:type</span>, <span class="ruby-identifier">atts</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
<span class="line-num">217</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">?</span> <span class="ruby-operator">!</span><span class="ruby-identifier">klass</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">kls</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">kls</span>)} <span class="ruby-operator">:</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">klass</span>)
<span class="line-num">218</span>       <span class="ruby-identifier">validates_type_error_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">klass</span>)
<span class="line-num">219</span>     <span class="ruby-keyword">end</span>
<span class="line-num">220</span>   <span class="ruby-keyword">end</span>
<span class="line-num">221</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validates_unique'>
<a name='method-i-validates_unique'></a>
<div class='synopsis'>
<span class='name'>validates_unique</span><span class='arguments'>(*atts)</span>

</div>
<div class='description'>

<p>Checks that there are no duplicate values in the database for the given attributes.  Pass an array of fields instead of multiple fields to specify that the combination of fields must be unique, instead of that each field should have a unique value.</p>

<p>This means that the code:</p>

<pre class="ruby"><span class="ruby-identifier">validates_unique</span>([<span class="ruby-value">:column1</span>, <span class="ruby-value">:column2</span>])
</pre>

<p>validates the grouping of column1 and column2 while</p>

<pre class="ruby"><span class="ruby-identifier">validates_unique</span>(<span class="ruby-value">:column1</span>, <span class="ruby-value">:column2</span>)
</pre>

<p>validates them separately.</p>

<p>You can pass a block, which is yielded the dataset in which the columns must be unique. So if you are doing a soft delete of records, in which the name must be unique, but only for active records:</p>

<pre class="ruby"><span class="ruby-identifier">validates_unique</span>(<span class="ruby-value">:name</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">ds</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:active</span>)}
</pre>

<p>You should also add a unique index in the database, as this suffers from a fairly obvious race condition.</p>

<p>This validation does not respect the :allow_* options that the other validations accept, since it can deal with a grouping of multiple attributes.</p>

<p>Possible Options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:dataset </td><td>
<p>The base dataset to use for the unique query, defaults to the model’s dataset.</p>
</td></tr><tr><td class='label'>:message </td><td>
<p>The message to use (default: ‘is already taken’)</p>
</td></tr><tr><td class='label'>:only_if_modified </td><td>
<p>Only check the uniqueness if the object is new or one of the columns has been modified, true by default.</p>
</td></tr><tr><td class='label'>:where </td><td>
<p>A callable object where call takes three arguments, a dataset, the current object, and an array of columns, and should return a modified dataset that is filtered to include only rows with the same values as the current object for each column in the array.</p>
</td></tr></tbody></table>

<p>If you want to do a case insensitive uniqueness validation on a database that is case sensitive by default, you can use:</p>

<pre class="ruby"><span class="ruby-identifier">validates_unique</span> <span class="ruby-value">:column</span>, <span class="ruby-value">where:</span>(<span class="ruby-identifier">lambda</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ds</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">cols</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">cols</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">v</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">c</span>)
    <span class="ruby-identifier">v</span> = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>
    [<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-value">:lower</span>, <span class="ruby-identifier">c</span>), <span class="ruby-identifier">v</span>]
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span>)
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validates_unique-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validates_unique-source'>    <span class="ruby-comment"># File lib/sequel/plugins/validation_helpers.rb</span>
<span class="line-num">272</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validates_unique</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
<span class="line-num">273</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">default_validation_helpers_options</span>(<span class="ruby-value">:unique</span>)
<span class="line-num">274</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">atts</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
<span class="line-num">275</span>     <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">pop</span>)
<span class="line-num">276</span>   <span class="ruby-keyword">end</span>
<span class="line-num">277</span>   <span class="ruby-identifier">message</span> = <span class="ruby-identifier">validation_error_message</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>])
<span class="line-num">278</span>   <span class="ruby-identifier">from_values</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:from</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:values</span>
<span class="line-num">279</span>   <span class="ruby-identifier">where</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:where</span>]
<span class="line-num">280</span>   <span class="ruby-identifier">atts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
<span class="line-num">281</span>     <span class="ruby-identifier">arr</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">a</span>)
<span class="line-num">282</span>     <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">x</span>)}
<span class="line-num">283</span>     <span class="ruby-identifier">cc</span> = <span class="ruby-identifier">changed_columns</span>
<span class="line-num">284</span>     <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:only_if_modified</span>, <span class="ruby-keyword">true</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">arr</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">cc</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">x</span>)}
<span class="line-num">285</span>     <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:dataset</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">dataset</span>
<span class="line-num">286</span>     <span class="ruby-identifier">ds</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">where</span>
<span class="line-num">287</span>       <span class="ruby-identifier">where</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">ds</span>, <span class="ruby-keyword">self</span>, <span class="ruby-identifier">arr</span>)
<span class="line-num">288</span>     <span class="ruby-keyword">else</span>
<span class="line-num">289</span>       <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">from_values</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">values</span>[<span class="ruby-identifier">x</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">get_column_value</span>(<span class="ruby-identifier">x</span>)}
<span class="line-num">290</span>       <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">any?</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:nil?</span>)
<span class="line-num">291</span>       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">arr</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">vals</span>))
<span class="line-num">292</span>     <span class="ruby-keyword">end</span>
<span class="line-num">293</span>     <span class="ruby-identifier">ds</span> = <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">ds</span>) <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">yield</span>)
<span class="line-num">294</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">new?</span>
<span class="line-num">295</span>       <span class="ruby-identifier">h</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">joined_dataset?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">qualified_pk_hash</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">pk_hash</span>
<span class="line-num">296</span>       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">h</span>)
<span class="line-num">297</span>     <span class="ruby-keyword">end</span>
<span class="line-num">298</span>     <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">message</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">299</span>   <span class="ruby-keyword">end</span>
<span class="line-num">300</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
